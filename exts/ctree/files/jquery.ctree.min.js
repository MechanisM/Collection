/**
 * cTree
 * 
 * autor: kobezzza (kobezzza@gmail.com | http://kobezzza.com)
 * version: 1.5
 * date: 13.10.2011 12:24:15
 */
(function(e){e.fn.cTree=function(b,a){var f,d;if(this.data("CUI")&&this.data("CUI").cTree){d=this.data("CUI").cTree.obj;if(b&&b===true){d.existTemplate("cTree_standartTpl")||d.pushTemplate("cTree_standartTpl",e.fn.cTree.template);d.prop("activeTarget",this).setTemplate("cTree_standartTpl").print()}return d}b=b&&b!==true?b:{};b.def=b.def||"";d=a&&a.name&&a.name==="$.Collection"?a:a&&a!==false?new e.Collection(a,b.def):a&&a===false?new e.Collection("",b.def):this.collection(b.def);d.prop("activeTarget",
this).pushSetTemplate("cTree_standartTpl",e.fn.cTree.template);if(!a||a!==false)d.print();this.setCUI("cTree",d);for(f in b)if(b.hasOwnProperty(f)&&f!=="def")this.data("CUI").cTree.events[f]=b[f];for(f in e.fn.cTree.events)if(e.fn.cTree.events.hasOwnProperty(f))e.fn.cTree.events[f](this,d);return d};if(!e.fn.cTree.stat)e.fn.cTree.stat={val:"val",childNodes:"childNodes",doctype:"doctype",href:"href",html:"html",ico:"ico",alt:"alt",eopen:"eopen"};e.fn.cTree.template=function(b,a,f,d,i,g,h){var c=e.fn.cTree.stat,
j="";f-=1;var k,l=-1;if(a===0)j='<ul class="cTree_container">';if(!g&&b[a].context){g=b[a].context;h=a}k=b[a][c.childNodes]&&e.isArray(b[a][c.childNodes]);j+="\t\t<li"+(g?' data-context="'+g+'"':' data-context=""')+(g?' data-pos="'+h+'"':' data-pos="'+a+'"')+' class="cTree_node'+(!g?" cTree_isRoot":"")+(k?b[a][c.childNodes].length===0?" cTree_emptyChildNodes":"":" cTree_expandLeaf")+(a===f?" cTree_isLast":"")+(b[a][c.eopen]?" cTree_expandOpen":" cTree_expandClosed")+'">\t\t\t<div class="cTree_expand"></div>\t\t\t<div class="cTree_content">'+
(b[a][c.html]?b[a][c.html]:"")+(b[a][c.ico]?'<img src="'+b[a][c.ico]+'" alt="'+(b[a][c.alt]?b[a][c.alt]:"")+'"'+(!b[a][c.doctype]||b[a][c.doctype]=="xhtml"?" /":"")+">":"")+(b[a][c.href]&&b[a][c.val]?'<a href="'+b[a][c.href]+'">'+b[a][c.val]+"</a>":b[a][c.val]?"<span>"+b[a][c.val]+"</span>":"")+"</div>\t\t";if(k){h=b[a][c.childNodes].length;k=h-1;for(g=g?g+"~"+a+"~"+c.childNodes:a+"~"+c.childNodes;l++<k;)j+=e.fn.cTree.template(b[a][c.childNodes],l,h,d,i,g,l)}j+="</li>";if(a===f)j+="</ul>";return j};
e.fn.cTree.events={};e.fn.cTree.events.standart=function(b,a){b.delegate(".cTree_expand","click",function(f){var d=e(f.target).parent(),i=b.data("CUI").cTree.events,g,h=d.data("context"),c=d.data("pos");if(!d.hasClass("cTree_expandLeaf")){if(d.hasClass("cTree_expandOpen")){d.removeClass("cTree_expandOpen").addClass("cTree_expandClosed");i.close&&i.close.call(a,f,h,c,d);g="close"}else{d.removeClass("cTree_expandClosed").addClass("cTree_expandOpen");i.open&&i.open.call(a,f,h,c,d);g="open"}i.click&&
i.click.call(a,f,h,c,d,g)}});return this}})(jQuery);
