<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>$.Collection: mult test</title>
	<link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css">
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
	<script type="text/javascript" src="../../jquery.collection.min.js"></script>
	<script type="text/javascript">
		$(function () {
			module("core");
			test("length", function () {
				var db = new $.Collection({first: [[1, 2, {second: 3}], 2, 3], last: 2});
				db.push({table1: null, table2: "GO!"});
				
				equal(db.length([1, 2, 3]), 3, "Массив");
				equal(db.length(function ($this, i) {
					return $this[i] === 1;
				}, [1, 2, 3]), 1, "Массив c условием");
				//
				equal(db.length(false, "table1"), 0, "null");
				equal(db.length(false, "table2"), 3, "Строка");
				equal(db.length(), 2, "Объект");
				equal(db.length(function ($this, i) {
					return i === "first";
				}), 1, "Объект c условием");
				// Закидываем в стек фильтры
				db.pushFilter({
					a: function ($this, i) {
						return $this[i] === 1;
					},
					b: function ($this, i) {
						return $this[i] === 2;
					}
				});
				equal(db.length("a || b", [1, 2, 3]), 2, "Массив cо строчным условием: a || b");
				equal(db.length("a && b", [1, 2, 3]), 0, "Массив cо строчным условием: a && b");
				equal(db.length("(a && b) || a", [1, 2, 3]), 1, "Массив cо строчным условием: (a && b) || a");
				equal(db.length("a && !b", [1, 2, 3]), 2, "Массив cо строчным условием: a && !b");
				equal(db.length("!(a && b)", [1, 2, 3]), 3, "Массив cо строчным условием: !(a && b)");
				equal(db.length("! (a && b) && a", [1, 2, 3]), 1, "Массив cо строчным условием: ! (! a && b) && a");
			});
			module("each methods");
			test("search", function () {
				var db = new $.Collection([1, 2, 3, 4]);
				
				equal(db.searchElements(function ($this, i) {
					return $this[i] === 1;
				})[0], 0, "Простое поиск по массиву");
			});
			test("delete", function () {
				var db = new $.Collection([1, 2, 3, 4]);
				
				equal(db.deleteElements(function ($this, i) {
					return $this[i] === 1;
				}).getElement("0"), 2, "Простое удаление из массива");
			});
		});
	</script>
</head>

<body>
	<h1 id="qunit-header">$.Collection: mult test</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests">
	</ol>
</body>
</html>
