<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>$.Collection: core test</title>
	<link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css">
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
	<script type="text/javascript" src="../../jquery.collection.js"></script>
	<script type="text/javascript">
		$(function () {
			module("core");
			test("Создание пустого экземпляра", function () {
				console.log(new $.Collection());
				equal(new $.Collection(), 0, "Через new");
				equal($.Collection(), 0, "Фабрика");
				equal($.Collection(null, {context: "0~#-1"}).dObj.prop.context, "0~#-1", "Задание дополнительного параметра в конструкторе");
			});
			test("Создание экземпляра", function () {
				ok($.Collection("#result").dObj.prop.target !== null, "Первый параметр - строка");
				equal($.Collection([1,2,3]), 3, "Задание коллекции");
			});
			module("core.cache.obj");
			test("Операции с объектами", function () {
				var
					obj = $.Collection.stat.obj,
					objTest = [{next: {next: [1, 2, 3, 4]}}, 2, 3],
					objTest2 = {a: 1, b: 2};
				
				equal(obj.getByLink(objTest, "1"), 2, "Запрос на получение: 1");
				equal(obj.getByLink(objTest, "#-1"), 3, "Запрос на получение: #-1");
				equal(obj.getByLink(objTest, "0~next~#0~#-1"), 4, "Запрос на получение: 0~next~#0~#-1");
				//
				equal((function () {
					obj.setByLink(objTest, "1", 3);
					
					return obj.getByLink(objTest, "1");
				})(), 3, "Запрос на замену: 1");
				equal((function () {
					obj.setByLink(objTest, "#-1", 4)
					
					return obj.getByLink(objTest, "#-1");
				})(), 4, "Запрос на замену: #-1");
				equal((function () {
					obj.setByLink(objTest, "0~next~#0~#-1", 5)
					
					return obj.getByLink(objTest, "0~next~#0~#-1");
				})(), 5, "Запрос на замену: 0~next~#0~#-1");
				//
				equal((function () {
					obj.addElementToObject(objTest2, "c", 3);
					
					return objTest2.c;
				})(), 3, "Добавление нового свойства в конец объекта");
				equal(obj.addElementToObject(objTest2, "d::unshift", 4).d, 4, "Добавление нового свойства в начало объекта");
			});
		});
	</script>
</head>

<body>
	<h1 id="qunit-header">$.Collection: core test</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests">
	</ol>
</body>
</html>
