<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>$.Collection: single test</title>
	<link rel="stylesheet" href="../../qunit.css" type="text/css">
	<script src="../../jquery.js"></script>
	<script type="text/javascript" src="../../qunit.js"></script>
	<script type="text/javascript" src="../../nimble/nimble.js"></script>
	<script type="text/javascript" src="../../jquery.collection.js"></script>
	<script type="text/javascript">
		$(function () {
			test("core", function () {
				var db = new $.Collection({first: [[1, 2, {second: 3}], 2, 3]});
				
				equal(db.getElement("first > 0 > eq(-1) > eq(0)"), 3, "getElement");
				equal(db
					.setElement("first > 0 > eq(-1) > eq(0)", 99)
					.getElement("first > 0 > eq(-1) > eq(0)"), 99,
				"setElement");
				equal(db
					.setElement("", 99)
					.getElement(), 99,
				"setElement - without context");
			});
			//
			test("concat", function () {
				var db = new $.Collection({first: [[1, 2, {second: 3}], 2, 3]});
				equal(db
					.concat([1, 2, 3, 4, 5], "first > 0 >")
					.getElement("first > 0 >").length, 8,
				"simple test");
			});
			//
			test("delete", function () {
				var
					obj = {first: [[1, 2, {second: 3}], 2, 3], second: [1, 2, 3, 4]},
					db = new $.Collection(obj);
				//
				equal(db
					.deleteElementByLink("first > 0 > 1")
					.getElement("first > 0").length, 2,
				"deleteElementByLink -> array");
				//
				equal(db
					.deleteElementByLink("first > 0 > eq(-1) > second")
					.getElement("first > 0 > eq(-1)").second, undefined,
				"deleteElementByLink -> object");
				//
				equal(db
					.deleteElementsByLink(["first > eq(0)", "first > eq(-1)"])
					.getElement("first").length, 1,
				"deleteElementsByLink -> array");
				//
				equal(db
					.push("stack", obj)
					.deleteElementsByLink({stack: ["second > eq(0)", "second > eq(0)"], active: "second > eq(0)"})
					.getElement("second").length, 1,
				"deleteElementsByLink -> object");
			});
			//
			test("add", function () {
				var db = new $.Collection({first: [[1, 2, {second: 3}], 2, 3]});
				
				equal(db
					.addElement([1, 2], "second")
					.getElement("second").length, 2,
				"addElement - simple add");
				
				equal(db
					.addElement("first > 0", "second", "", "active", true)
					.getElement("second").length, 3,
				"addElement - copy");
				equal(db.getElement("first").length, 2,
				"addElement - move");
			});
		});
	</script>
</head>

<body>
	<h1 id="qunit-header">$.Collection: single test</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
</body>
</html>
