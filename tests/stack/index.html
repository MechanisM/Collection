<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>$.Collection: stack test</title>
	<link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css">
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
	<script type="text/javascript" src="../../jquery.collection.min.js"></script>
	<script type="text/javascript">
		$(function () {
			test("_$", function () {
				var db = new $.Collection([[1, 2, 3, 4, 5], 2, 3, 4], {activeContext: "0"});
				equal(+db._$("Context", ""), 4, "Простая проверка");
			});
			//
			test("_update", function () {
				var db = new $.Collection([1, 2])._push("Collection", "table1", [1, 2, 3]);
				
				equal(db
					._update("Collection", [1, 2, 3])
					._get("Collection").length, 3,
				"Простая проверка");
				
				equal(db
					._set("Collection", "table1")
					._update("Collection", [1, 2])
					._get("Collection", "table1").length, 2,
				"Проверка работы со стеком");
			});
			//
			test("_get", function () {
				var db = new $.Collection([1, 2])._push("Collection", "table1", [1, 2, 3]);
				
				equal(db._get("Collection").length, 2, "Простая проверка");
				equal(db._get("Collection", "table1").length, 3, "Проверка работы со стеком");
			});
			//
			test("_mod", function () {
				var db = new $.Collection([1, 2])._push("Collection", "table1", [1, 2, 3]);
				
				equal(db
					._mod("Context", "~0")
					._get("Context"), "~0",
				"Простая проверка: строковое дополнение");
				
				equal(db
					._mod("Collection", 3)
					._get("Collection").length, 3,
				"Простая проверка: дополнение массива");
				
				equal(db
					._$("Collection", true)
					._mod("Collection", true)
					._get("Collection"), false,
				"Простая проверка: дополнение логической переменной");
				
				equal(db
					._set("Collection", "table1")
					._mod("Collection", 4)
					._get("Collection").length, 4,
				"Проверка работы со стеком: дополнение массива");
				
				equal(db
					._mod("Collection", 5, "active")
					._get("Collection").length, 5,
				"Проверка работы со стеком: дополнение массива, обращение по константе");
			});
			//
			test("_push", function () {
				var db = new $.Collection();
				
				equal(db
					._push("Collection", "table1", [1, 2, 3])
					._get("Collection", "table1").length, 3,
				"Простая проверка: 2 входных параметра");
				
				equal(db
					._push("Collection", {table2: [1, 2]})
					._get("Collection", "table2").length, 2,
				"Простая проверка: 1 входной параметр");
				
				equal(db
					._set("Collection", "table1")
					._push("Collection", "table1", [1])
					._get("Collection").length, 1,
				"Перезапись активного свойства: 2 входных параметра");
				
				equal(db
					._set("Collection", "table2")
					._push("Collection", {table2: [1, 2, 3]})
					._get("Collection").length, 3,
				"Перезапись активного свойства: 1 входной параметр");
			});
			//
			test("_set", function () {
				var db = new $.Collection()._push("Collection", "table1", [1, 2]);
				
				equal(db
					._set("Collection", "table1")
					._get("Collection").length, 2,
				"Простая проверка");
			});
			//
			test("_back", function () {
				var db = new $.Collection()
					._push("Collection", {table1: [1, 2], table2: [1]});
				
				equal(db
					._set("Collection", "table1")
					._set("Collection", "table2")
					._back("Collection")
					._get("Collection").length, 2,
				"Простая проверка");
			});
			//
			test("_backIf", function () {
				var db = new $.Collection()
					._push("Collection", {table1: [1, 2], table2: [1]});
				
				equal(db
					._set("Collection", "table1")
					._set("Collection", "table2")
					._set("Collection", "table1")
					._back("Collection")
					._backIf("Collection")
					._get("Collection").length, 1,
				"Простая проверка");
			});
			//
			test("_drop", function () {
				var db = new $.Collection()
					._push("Collection", {table1: [1, 2], table2: [1]})
					._set("Collection", "table1");

				equal(db
					._drop("Collection", ["active", "table2"], null)
					._get("Collection"), null,
				"Простая проверка");
			});
			//
			test("_reset", function () {
				var db = new $.Collection()
					._push("Context", {table1: "0", table2: "1"})
					._set("Context", "table1");

				equal(db
					._reset("Context", ["active", "table2"], "")
					._get("Context"), "",
				"Простая проверка");
			});
			//
			test("_resetTo", function () {
				var db = new $.Collection()
					._push("Context", {table1: "0", table2: "1"})
					._set("Context", "table1");

				equal(db
					._resetTo("Context", "table1", "table2")
					._get("Context"), "1",
				"Простая проверка");
			});
			//
			test("_exist", function () {
				var db = new $.Collection()
					._push("Collection", {table1: [1, 2], table2: [1]})
					._set("Collection", "table1");

				equal(db._exist("Collection", "table3"), false, "Простая проверка");
				equal(db._exist("Collection"), true, "Простая проверка: по активному параметру");
			});
			//
			test("_is", function () {
				var db = new $.Collection()
					._push("Collection", {table1: [1, 2], table2: [1]})
					._set("Collection", "table1");

				equal(db._is("Collection", "table1"), true, "Простая проверка");
			});
		});
	</script>
</head>

<body>
	<h1 id="qunit-header">$.Collection: stack test</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests">
	</ol>
</body>
</html>
