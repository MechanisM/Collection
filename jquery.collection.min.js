/**
 * $.Collection
 * 
 * autor: kobezzza (kobezzza@gmail.com | http://kobezzza.com)
 * version: 3.2.5
 * date: 22.12.2011 20:08:43
 */
 (function(e){e.Collection=function(a,b){a=a||null;b=b||null;if(this.fn&&(!this.fn.name||this.fn.name!=="$.Collection"))return new e.Collection(a,b);e.extend(true,this,e.Collection.storage);var c=this.dObj.active;b&&e.extend(true,c,b);if(e.isString(a)){c.target=e(a);c.collection=null}else c.collection=a};e.Collection.fn=e.Collection.prototype={name:"$.Collection",version:"3.3",collection:function(){return this.name+" "+this.version},ACTIVE:"active",stack:["collection","filter","context","cache","index",
"map","variable","defer","page","parser","appendType","target","calculator","pager","template","numberBreak","pageBreak","resultNull"],getActiveParam:function(a){return this.dObj.sys.flags.use[a]===undefined||this.dObj.sys.flags.use[a]===true?this.dObj.active[a]:""},enable:function(a){this.dObj.sys.flags.use[a]=true;return this},disable:function(a){this.dObj.sys.flags.use[a]=false;return this},toggle:function(a){if(this.dObj.sys.flags.use[a]===true)return this.disable(a);return this.enable(a)}};e.Collection.templateModels=
{};e.Collection.sort={SHUFFLE:"shuffle",field:null,rev:false,shuffle:false,fn:null,sortBy:function(a,b,c){this.field=a||null;this.rev=b?b!==this.SHUFFLE?b:false:false;this.shuffle=b?b===this.SHUFFLE?b:false:false;this.fn=c||null;return this.sortHelper},sortHelper:function(a,b){var c=e.Collection.sort,d=c.shuffle?Math.round(Math.random()*2-1):c.rev?c.rev===true?-1:1:1;if(c.field){a=nimble.byLink(a,c.field);b=nimble.byLink(b,c.field)}if(c.fn){a=c.fn(a);b=c.fn(b)}if(c.shuffle)return d;else{if(a<b)return d*
-1;if(a>b)return d;return 0}}};e.fn.collection=function(a){var b=e.fn.collection.stat,c=function(g){var f=[];g.each(function(h){var j=e(this),k=j.data(),m=j.attr("class")?j.attr("class").split(" "):"",l=m?m.length:0,o;o=j[0];o=o.childNodes;for(var p=o.length,r=-1,q="";++r<p;)if(o[r].nodeType===3&&e.trim(o[r].textContent))q+=o[r].textContent;o=q?q:false;var n;f.push({});for(n in k)if(k.hasOwnProperty(n))f[h][n]=k[n];if(l){l--;f[h][b.classes]={};for(n=-1;++n<=l;)f[h][b.classes][m[n]]=m[n]}if(j.children().length!==
0)f[h][b.childNodes]=c(j.children());if(o!==false)f[h][b.val]=o.replace(/[\r\t\n]/g," ")});return f},d=c(this);if(a)return new e.Collection(d,a);return new e.Collection(d)};if(!e.fn.collection.stat)e.fn.collection.stat={val:"val",childNodes:"childNodes",classes:"classes"};e.fn.tplCompile=function(){if(this.length===0)throw Error("DOM element isn't exist!");for(var a=this.html().replace(/\/\*.*?\*\//g,"").split("?>").join("<?js").replace(/[\r\t\n]/g," ").split("<?js"),b=a.length,c="var key = i, result = ''; ",
d=-1;++d<b;)c+=d===0||d%2===0?"result +='"+a[d]+"';":a[d].split("echo").join("result +=");return new Function("data","i","cOLength","self","id",c+" return result;")};e.isString=function(a){return nimble.isString(a)};e.isBoolean=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"};e.isExist=function(a){return nimble.isExist(a)};e.unshiftArguments=function(a,b){for(var c=[b],d=-1,g=a.length;++d<g;)c.push(a[d]);return c};e.toUpperCase=function(a,b,c){c=c||0;if(!b)return a.toUpperCase();
return a.substring(c,b).toUpperCase()+a.substring(b)};e.toLowerCase=function(a,b,c){c=c||0;if(!b)return a.toLowerCase();return a.substring(c,b).toLowerCase()+a.substring(b)};e.Collection.templateModels.simple=function(a){var b=this.dObj,c=b.viewVal;b=b.css;a.finNumber===a.nmbOfEntries?e("."+b.next,a.pager).addClass(b.disabled):e("."+b.next+"."+b.disabled,a.pager).removeClass(b.disabled);a.page===1?e("."+b.prev,a.pager).addClass(b.disabled):e("."+b.prev+"."+b.disabled,a.pager).removeClass(b.disabled);
a.nmbOfEntriesInPage===0?e("."+b.info,a.pager).empty():e("."+b.info,a.pager).text((a.page-1)*a.numberBreak+1+"-"+a.finNumber+" "+c.from+" "+a.nmbOfEntries);return true};e.Collection.templateModels.control=function(a){var b=this.dObj,c=b.viewVal;b=b.css;var d=a.nmbOfEntries%a.numberBreak!==0?~~(a.nmbOfEntries/a.numberBreak)+1:a.nmbOfEntries/a.numberBreak,g="",f,h=0;if(d>a.pageBreak){g+=a.page!==1?'<a href="javascript:;" class="'+b.prev+'" data-page="1">'+c.prev+"</a>":'<a href="javascript:;" class="'+
b.prev+" "+b.disabled+'" data-page="1">'+c.prev+"</a>";for(f=a.page-1;f++<d;)h++;f=h<a.pageBreak?a.pageBreak-h+1:1;h=0;for(f=a.page-f;f++<d;h++){if(h===a.pageBreak-1&&f!==a.page)break;if(f===a.page){if(h===0&&a.page!==1)g+='<a href="javascript:;" data-page="'+(f-1)+'">'+(f-1)+"</a>";else h--;g+='<a href="javascript:;" class="'+b.active+'" data-page="'+f+'">'+f+"</a>"}else g+='<a href="javascript:;" data-page="'+f+'">'+f+"</a>"}g+=f!==d+1?'<a href="javascript:;" data-page="'+d+'">'+c.next+"</a>":'<a href="javascript:;" class="'+
b.next+" "+b.disabled+'" data-page="'+d+'">'+c.next+"</a>"}else for(f=0;f++<d;)g+=f===a.page?'<a href="javascript:;" class="'+b.active+'" data-page="'+f+'">'+f+"</a>":'<a href="javascript:;" data-page="'+f+'">'+f+"</a>";if(a.nmbOfEntries===0)e("."+b.nav+",."+b.info,a.pager).empty();else{e("."+b.nav,a.pager).html(g);e("."+b.info,a.pager).text(c.total+": "+a.nmbOfEntries+". "+c.show+": "+((a.page-1)*a.numberBreak+1)+"-"+a.finNumber)}return true};e.Collection.storage={dObj:{active:{collection:null,filter:false,
context:"",cache:{autoIteration:false,iteration:false,firstIteration:false,lastIteration:false},index:null,map:null,variable:null,defer:"",page:1,parser:false,appendType:"html",target:null,calculator:".line",pager:"#pageControl",template:null,numberBreak:10,pageBreak:10,resultNull:""}}};e.Collection.storage.dObj.sys={flags:{use:{context:true,filter:true,parser:true}}};(function(a){var b,c,d=e.Collection.storage.dObj.sys;for(b=a.length;b--;){c=e.toUpperCase(a[b],1);d["active"+c+"ID"]=null;d["tmp"+
c]={};d[a[b]+"ChangeControl"]=null;d[a[b]+"Back"]=[]}})(e.Collection.fn.stack);e.Collection.fn._$=function(a,b){var c=this.dObj,d=c.active,g=e.toUpperCase(a,1);d[a]=nimble.expr(b,d[a]||"");c.sys["active"+g+"ID"]=null;return this};e.Collection.fn._update=function(a,b){var c=this.dObj,d=c.active;c=c.sys;var g=e.toUpperCase(a,1),f=c["active"+g+"ID"];d[a]=nimble.expr(b,d[a]||"");if(f)c["tmp"+g][f]=d[a];return this};e.Collection.fn._get=function(a,b){var c=this.dObj;if(b&&b!==this.ACTIVE)return c.sys["tmp"+
e.toUpperCase(a,1)][b];return c.active[a]};e.Collection.fn._push=function(a,b,c){var d=this.dObj.sys,g=e.toUpperCase(a,1),f=d["tmp"+g];d=d["active"+g+"ID"];var h;if(e.isPlainObject(b))for(h in b){if(b.hasOwnProperty(h))if(h===this.ACTIVE)throw Error("invalid property name!");else if(f[h]&&d&&d===h)this._update(a,b[h]);else f[h]=b[h]}else if(b===this.ACTIVE)throw Error("invalid property name!");else if(f[b]&&d&&d===b)this._update(a,c);else f[b]=c;return this};e.Collection.fn._set=function(a,b){var c=
this.dObj,d=c.sys,g=e.toUpperCase(a,1),f=a+"ChangeControl",h="active"+g+"ID";if(d[h]!==b){d[f]=true;d[h]=b}else d[f]=false;d[a+"Back"].push(b);c.active[a]=d["tmp"+g][b];return this};e.Collection.fn._back=function(a,b){var c=this.dObj,d=c.sys,g=e.toUpperCase(a,1),f=d[a+"Back"],h;d[a+"ChangeControl"]=false;h=f.length-(b||1)-1;if(h>=0&&f[h])if(d["tmp"+g][f[h]]){d["active"+g+"ID"]=f[h];c.active[a]=d["tmp"+g][f[h]];f.splice(h+1,f.length)}return this};e.Collection.fn._backIf=function(a){if(this.dObj.sys[a+
"ChangeControl"]===true)return this._back.apply(this,arguments);return this};e.Collection.fn._drop=function(a,b,c){c=c===undefined?false:c;var d=this.dObj,g=d.active;d=d.sys;var f=e.toUpperCase(a,1),h="active"+f+"ID";f="tmp"+f;var j=d[h];b=!b?j?[j]:[]:e.isArray(b)||e.isPlainObject(b)?b:[b];var k;if(b[0]&&b[0]!==this.ACTIVE)for(k in b){if(b.hasOwnProperty(k))if(!b[k]||b[k]===this.ACTIVE){j&&delete d[f][j];d[h]=null;g[a]=c}else{delete d[f][b[k]];if(j&&b[k]===j){d[h]=null;g[a]=c}}}else{j&&delete d[f][j];
d[h]=null;g[a]=c}return this};e.Collection.fn._reset=function(a,b,c){c=c===undefined?false:c;var d=this.dObj,g=d.active;d=d.sys;var f=e.toUpperCase(a,1),h="tmp"+f;f=d["active"+f+"ID"];b=!b?f?[f]:[]:e.isArray(b)||e.isPlainObject(b)?b:[b];var j;if(b[0]&&b[0]!==this.ACTIVE)for(j in b){if(b.hasOwnProperty(j))if(!b[j]||b[j]===this.ACTIVE){if(f)d[h][f]=c;g[a]=c}else{d[h][b[j]]=c;if(f&&b[j]===f)g[a]=c}}else{if(f)d[h][f]=c;g[a]=c}return this};e.Collection.fn._resetTo=function(a,b,c){var d=this.dObj;c=!c||
c===this.ACTIVE?d.active[a]:d.sys["tmp"+e.toUpperCase(a,1)][c];return this._reset(a,b||"",c)};e.Collection.fn._exist=function(a,b){var c=this.dObj,d=e.toUpperCase(a,1);if((!b||b===this.ACTIVE)&&c.sys["active"+d+"ID"])return true;if(c.sys["tmp"+d][b]!==undefined)return true;return false};e.Collection.fn._is=function(a,b){if(b===this.dObj.sys["active"+e.toUpperCase(a,1)+"ID"])return true;return false};e.Collection.fn.use=function(a){for(var b=this.stack.length;b--;)this._exist(this.stack[b],a)&&this._set(this.stack[b],
a);return this};e.Collection.fn._prop=function(a,b,c){var d=this.dObj[a];if(arguments.length!==3)if(e.isPlainObject(b))e.extend(d,b);else return d[b];else d[b]=c;return this};e.Collection.fn.active=function(){return this._prop.apply(this,e.unshiftArguments(arguments,"active"))};(function(a){var b,c=e.Collection.fn,d;for(b=a.length;b--;){d=e.toUpperCase(a[b],1);c["$"+d]=function(g){return function(f){return this._$(g,f)}}(a[b]);c["update"+d]=function(g){return function(f){return this._update(g,f)}}(a[b]);
c["reset"+d+"To"]=function(g){return function(f,h){return this._resetTo(g,f,h)}}(a[b]);c["push"+d]=function(g){return function(){return this._push.apply(this,e.unshiftArguments(arguments,g))}}(a[b]);c["set"+d]=function(g){return function(f){return this._set(g,f)}}(a[b]);c["pushSet"+d]=function(g){return function(f,h){return this._push(g,f,h)._set(g,f)}}(a[b]);c["back"+d]=function(g){return function(f){return this._back(g,f||"")}}(a[b]);c["back"+d+"If"]=function(g){return function(f){return this._backIf(g,
f||"")}}(a[b]);c["drop"+d]=a[b]==="filter"||a[b]==="parser"?function(g){return function(){return this._drop(g,arguments)}}(a[b]):function(g){return function(){return this._drop(g,arguments,null)}}(a[b]);if(a[b]==="filter"||a[b]==="parser")c["reset"+d]=function(g){return function(){return this._reset(g,arguments)}}(a[b]);else if(a[b]==="page")c["reset"+d]=function(g){return function(){return this._reset(g,arguments,1)}}(a[b]);else if(a[b]==="context")c["reset"+d]=function(g){return function(){return this._reset(g,
arguments,"")}}(a[b]);c["is"+d]=function(g){return function(f){return this._is(g,f)}}(a[b]);c["exist"+d]=function(g){return function(f){return this._exist(g,f||"")}}(a[b]);c["get"+d]=function(g){return function(f){return this._get(g,f||"")}}(a[b])}})(e.Collection.fn.stack);e.Collection.fn.set=function(a,b,c){a=e.isExist(a)?a.toString():"";b=b===undefined?"":b;c=c||"";var d=this.getActiveParam("context").toString();if(!a&&!d)return c&&c!==this.ACTIVE?this._push("collection",c,b):this._update("collection",
b);nimble.byLink(this._get("collection",c),d+nimble.CHILDREN+a,b);return this};e.Collection.fn.get=function(a,b){a=e.isExist(a)?a.toString():"";return nimble.byLink(this._get("collection",b||""),this.getActiveParam("context").toString()+nimble.CHILDREN+a)};e.Collection.fn.add=function(a,b,c,d,g){a=a!==undefined?a:"";b=b||"push";g=g||false;var f,h,j;f=nimble.byLink(this._get("collection",c||""),this.getActiveParam("context").toString());if(typeof f==="object"){j=e.isPlainObject(f);if(d){a=e.isExist(a)?
a.toString():"";h=nimble.byLink(this._get("collection",d||""),a);if(j===true){b=b==="push"?this.length(f):b==="unshift"?this.length(f)+nimble.METHOD_SEPARATOR+"unshift":b;j=nimble.addElementToObject(f,b.toString(),h)}else{j=true;f[b](h)}g===true&&this.disable("context").deleteElementByLink(a,d).enable("context")}else if(j===true){b=b==="push"?this.length(f):b==="unshift"?this.length(f)+nimble.METHOD_SEPARATOR+"unshift":b;j=nimble.addElementToObject(f,b.toString(),a)}else{j=true;f[b](a)}if(j!==true)this.set("",
j,c||"")}else throw Error("unable to set property!");return this};e.Collection.fn.push=function(){for(var a=-1,b=arguments.length;++a<b;)this.add(arguments[a]);return this};e.Collection.fn.unshift=function(){for(var a=arguments.length;a--;)this.add(arguments[a],"unshift");return this};e.Collection.fn.deleteElementByLink=function(a,b){a=e.isExist(a)?a.toString():"";var c=this.getActiveParam("context").toString();!a&&!c?this.set("",null):nimble.byLink(this._get("collection",b||""),c+nimble.CHILDREN+
a,"",true);return this};e.Collection.fn.deleteElementsByLink=function(a,b){b=b||"";var c,d;if(e.isPlainObject(a))for(c in a){if(a.hasOwnProperty(c))if(e.isArray(a[c]))for(d=a[c].length;d--;)this.deleteElementByLink(a[c][d],c);else this.deleteElementByLink(a[c],c)}else if(e.isArray(a))for(d=a.length;d--;)this.deleteElementByLink(a[d],b);else this.deleteElementByLink(a,b);return this};e.Collection.fn.pop=function(){return this.deleteElementByLink("eq(-1)")};e.Collection.fn.shift=function(){return this.deleteElementByLink("eq(0)")};
e.Collection.fn.concat=function(a,b,c){b=e.isExist(b)?b.toString():"";c=c||"";var d=nimble.byLink(this._get("collection",c),this.getActiveParam("context").toString()+nimble.CHILDREN+b);if(typeof d==="object")if(e.isPlainObject(d))e.extend(true,d,a);else{if(e.isArray(d))if(e.isArray(a)){d=Array.prototype.concat(d,a);this.set(b,d,c)}else this.add(a,"push",c)}else throw Error("incorrect data type!");return this};e.Collection.fn.length=function(a,b){a=e.isExist(a)?a:false;var c=this.dObj,d,g,f;if(!e.isFunction(a))if(e.isString(a)&&
!e.isExist(b)||e.isArray(a)||e.isPlainObject(a)){b=a;a=false}if(!b||b===this.ACTIVE)c=c.active.collection;else if(e.isString(b))c=c.sys.tmpCollection[b];else{d=true;c=b}if(c===null)return 0;if(d!==true)c=nimble.byLink(c,this.getActiveParam("context").toString());d=c.length;if(e.isString(c))return d;if(typeof c==="object")if(a===false&&d!==undefined)f=d;else{f=0;for(g in c)if(c.hasOwnProperty(g))if(this.customFilter(a,c,g,d||null,this,b?b:this.ACTIVE)===true)f++}else throw Error("incorrect data type!");
return f};e.Collection.fn.each=function(a,b,c,d,g,f,h){a=e.isFunction(a)?{filter:a}:a;b=e.isExist(b)?b:this.ACTIVE;c=e.isExist(c)?c:this.ACTIVE;if(e.isBoolean(c)){h=f;f=g;g=d;d=c;c=this.ACTIVE}d=d===false?false:true;g=parseInt(g)>=0?parseInt(g):false;f=parseInt(f)||false;h=parseInt(h)||false;var j=this.dObj,k,m,l=0;j=nimble.byLink(c!==this.ACTIVE?j.sys.tmpCollection[c]:j.active.collection,this.getActiveParam("context").toString());k=this.length(j);if(e.isArray(j))for(m=h!==false?h-1:-1;++m<k;){if(g!==
false&&l===g)break;if(a.full&&a.full.call(a.full,j,m,k,this,c)===false)break;if(this.customFilter(b,j,m,k,this,c)===true)if(f!==false&&f!==0)f--;else{if(a.filter&&a.filter.call(a.filter,j,m,k,this,c)===false)break;if(d===false)break;l++}else if(a.denial&&a.denial.call(a.denial,j,m,k,this,c)===false)break}else for(m in j)if(j.hasOwnProperty(m)){if(g!==false&&l===g)break;if(h!==false&&h!==0)h--;else{if(a.full&&a.full.call(a.full,j,m,k,this,c)===false)break;if(this.customFilter(b,j,m,k,this,c)===true)if(f!==
false&&f!==0)f--;else{if(a.filter&&a.filter.call(a.filter,j,m,k,this,c)===false)break;if(d===false)break;l++}}}else if(a.denial&&a.denial.call(a.denial,j,m,k,this,c)===false)break;return this};e.Collection.fn.searchElements=function(a,b,c,d,g,f){a=e.isExist(a)?a:this.ACTIVE;b=e.isExist(b)?b:this.ACTIVE;if(e.isBoolean(b)){f=g;g=d;d=c;c=b;b=this.ACTIVE}c=c===false?false:true;d=parseInt(d)>=0?parseInt(d):false;g=parseInt(g)||false;f=parseInt(f)||false;var h=[];this.each(function(j,k){if(c===true)h.push(k);
else{h=k;return false}return true},a,b,c,d,g,f);return h};e.Collection.fn.searchElement=function(a,b){return this.searchElements(a||"",b||"",false)};e.Collection.fn.returnElements=function(a,b,c,d,g,f){a=e.isExist(a)?a:this.ACTIVE;b=e.isExist(b)?b:this.ACTIVE;if(e.isBoolean(b)){f=g;g=d;d=c;c=b;b=this.ACTIVE}c=c===false?false:true;d=parseInt(d)>=0?parseInt(d):false;g=parseInt(g)||false;f=parseInt(f)||false;var h=[];this.each(function(j,k){if(c===true)h.push(j[k]);else{h=j[k];return false}return true},
a,b,c,d,g,f);return h};e.Collection.fn.returnElement=function(a,b){return this.returnElements(a||"",b||"",false)};e.Collection.fn.replaceElements=function(a,b,c,d,g,f,h){a=e.isExist(a)?a:this.ACTIVE;c=e.isExist(c)?c:this.ACTIVE;if(e.isBoolean(c)){h=f;f=g;g=d;d=c;c=this.ACTIVE}d=d===false?false:true;g=parseInt(g)>=0?parseInt(g):false;f=parseInt(f)||false;h=parseInt(h)||false;var j=e.isFunction(b);this.each(function(k,m,l,o,p){if(j)b.call(b,k,m,l,o,p);else k[m]=nimble.expr(b,k[m]);return true},a,c,
d,g,f,h);return this};e.Collection.fn.replaceElement=function(a,b,c){return this.replaceElements(a||"",b,c||"",false)};e.Collection.fn.moveElements=function(a,b,c,d,g,f,h,j,k,m){a=e.isExist(a)?a:this.ACTIVE;m=m===false?false:true;b=e.isExist(b)?b.toString():"";c=c||"";d=d||"";g=g||"push";f=f===false?false:true;h=parseInt(h)>=0?parseInt(h):false;j=parseInt(j)||false;k=parseInt(k)||false;var l=[],o=e.isArray(nimble.byLink(this._get("collection",d),this.getActiveParam("context").toString())),p=-1;this.disable("context");
a=this.searchElements(a,c,f,h,j,k);this.enable("context");if(f===true)for(f=a.length;++p<f;){this.add(b+nimble.CHILDREN+a[p],o===true?g:a[p]+nimble.METHOD_SEPARATOR+g,d,c);m===true&&l.push(a[p])}else{this.add(b+nimble.CHILDREN+a,o===true?g:a+nimble.METHOD_SEPARATOR+g,d,c);m===true&&l.push(a)}m===true&&this.disable("context").deleteElementsByLink(l,c).enable("context");return this};e.Collection.fn.moveElement=function(a,b,c,d,g){return this.moveElements(a||"",e.isExist(b)?b.toString():"",c||"",d||
"",g||"",false)};e.Collection.fn.copyElements=function(a,b,c,d,g,f,h,j,k){f=f===false?false:true;h=parseInt(h)>=0?parseInt(h):false;j=parseInt(j)||false;k=parseInt(k)||false;return this.moveElements(a||"",e.isExist(b)?b.toString():"",c||"",d||"",g||"push",f,h,j,k,false)};e.Collection.fn.copyElement=function(a,b,c,d,g){return this.moveElements(a||"",e.isExist(b)?b.toString():"",c||"",d||"",g||"",false,"","","",false)};e.Collection.fn.deleteElements=function(a,b,c,d,g,f){a=e.isExist(a)?a:this.ACTIVE;
b=e.isExist(b)?b:this.ACTIVE;if(e.isBoolean(b)){f=g;g=d;d=c;c=b;b=this.ACTIVE}c=c===false?false:true;d=parseInt(d)>=0?parseInt(d):false;g=parseInt(g)||false;f=parseInt(f)||false;a=this.searchElements(a,b,c,d,g,f);if(c===false)this.deleteElementByLink(a,b);else for(c=a.length;c--;)this.deleteElementByLink(a[c],b);return this};e.Collection.fn.deleteElement=function(a,b){return this.deleteElements(a||"",b||"",false)};e.Collection.fn.customFilter=function(a,b,c,d,g,f){var h=this.dObj,j=h.active;h=h.sys;
var k,m,l,o=true,p,r,q,n=-1;if(a===false)return true;if(e.isFunction(a))return a.call(a,b,c,d,g,f);if(!a||e.isString(a)&&e.trim(a)===this.ACTIVE){if(j.filter)return j.filter.call(j.filter,b,c,d,g,f);return true}else{if(!e.isArray(a)){if(a.search(/\|\||&&|!|\(|\)/)===-1)return h.tmpFilter[a].call(h.tmpFilter[a],b,c,d,g,f);a=e.trim(a.toString().replace(/\s*(\(|\))\s*/g," $1 ").replace(/\s*(\|\||&&)\s*/g," $1 ").replace(/(!)\s*/g,"$1")).split(" ")}m=function(s,v){for(var t=-1,x=s.length-1,u=0,w=[];t++<
x;){v++;s[t]==="("&&u++;if(s[t]===")")if(u===0)return{result:w,iter:v};else u--;w.push(s[t])}};for(k=a.length-1;n++<k;)if(a[n]==="("||a[n]==="!("){if(a[n].substring(0,1)==="!"){q=true;a[n]=a[n].substring(1)}else q=false;l=m(a.slice(n+1),n);n=l.iter;l=this.customFilter(l.result,b,c,d,g,f);o=!p&&!r?q===true?!l:l:p?q===true?!l:l&&o:q===true?!l:l||o}else if(a[n]!==")"&&a[n]!=="||"&&a[n]!=="&&"){if(a[n].substring(0,1)==="!"){q=true;a[n]=a[n].substring(1)}else q=false;l=a[n]===this.ACTIVE?j.filter:h.tmpFilter[a[n]];
l=l.call(l,b,c,d,g,f);o=!p&&!r?q===true?!l:l:p?q===true?!l:l&&o:q===true?!l:l||o}else if(a[n]==="||"){p=false;r=true}else if(a[n]==="&&"){r=false;p=true}return o}};e.Collection.fn.customParser=function(a,b){var c=this.dObj,d=c.active;c=c.sys;var g,f;if(e.isFunction(a))return a.call(a,b,this);if(!a||e.isString(a)&&e.trim(a)===this.ACTIVE){if(d.parser)return d.parser.call(d.parser,b,this)}else{if(e.isString(a)){a=e.trim(a);if(a.search("&&")===-1)return c.tmpParser[a].call(c.tmpParser[a],b,this);a=a.split("&&")}for(f=
a.length;f--;){a[f]=e.trim(a[f]);g=a[f]===this.ACTIVE?d.parser:c.tmpParser[a[f]];b=g.call(g,b,this)}}return b};e.Collection.fn.parentContext=function(a,b){a=a||1;var c="",d;c=this._get("collection",b||"").split(" "+nimble.CHILDREN+" ");for(d=a;d--;)c.splice(-1,1);return c.join(" "+nimble.CHILDREN+" ")};e.Collection.fn.parent=function(a,b){var c=this.dObj,d=c.sys;c=c.active;var g=d.contextID,f=this.parentContext.apply(this,arguments);if(!b||b===this.ACTIVE){if(g)d.tmpContext[g]=f;c.context=f}else{d.tmpContext[b]=
f;if(g&&b===g)c.context=f}return this};e.Collection.fn.orderBy=function(a,b,c,d){a=a||null;b=b||false;c=c?c===false?null:c:function(j){if(isNaN(j))return j.toUpperCase();return j};d=d||"";var g,f=function(j){var k=[],m={},l;for(l in j)j.hasOwnProperty(l)&&k.push(l);k.sort(statObj.sort.sortBy(a,b,c));for(l in k)if(k.hasOwnProperty(l))m[k[l]]=j[k[l]];return m},h=function(j){var k=[],m={},l;for(l in j)j.hasOwnProperty(l)&&k.push({key:l,value:j[l]});k.sort(statObj.sort.sortBy(a===true?"value":"value"+
statObj.obj.contextSeparator+a,b,c));for(l in k)if(k.hasOwnProperty(l))m[k[l].key]=k[l].value;return m};g=nimble.byLink(this._get("collection",d),this.getActiveParam("context").toString());if(typeof g==="object")if(e.isArray(g))g.sort(e.Collection.sort.sortBy(a,b,c));else{g=a?h.call(this,g):f.call(this,g);this.set("",g,d||"")}else throw Error("incorrect data type!");return this};e.Collection.fn.toString=function(a,b,c){if(a&&(e.isArray(a)||e.isPlainObject(a))){if(JSON&&JSON.stringify)return JSON.stringify(a,
b||"",c||"");throw Error("object JSON is not defined!");}a=nimble.byLink(this._get("collection",a||""),this.getActiveParam("context").toString());if(JSON&&JSON.stringify)return JSON.stringify(a,b||"",c||"");throw Error("object JSON is not defined!");};e.Collection.fn.valueOf=function(a){return this.length(e.isExist(a)?a:this.ACTIVE)};e.Collection.fn.then=function(a,b){var c=this;arguments.length===1?e.when(c.active("defer")).always(function(){a.apply(c,arguments)}):e.when(c.active("defer")).then(function(){a().apply(c,
arguments)},function(){b().apply(c,arguments)});return this};e.Collection.fn.print=function(a){var b=this.dObj,c=b.active,d={},g,f,h=0,j,k=null,m="",l;if(e.isString(a)||e.isNumeric(a))a={page:a};e.extend(true,d,c,a);if(a)d.page=nimble.expr(d.page,c.page||"");j=c.page-d.page;c.page=d.page;l=function(o,p,r,q,n){d.callback&&d.callback.apply(this,arguments);m+=d.template.call(d.template,o,p,r,q,n);h=p;return true};a=nimble.byLink(d.collection,this.getActiveParam("context").toString());g=this.length();
d.numberBreak=d.numberBreak===false?g:d.numberBreak;if(e.isPlainObject(a)||d.cache.iteration===false||d.cache.firstIteration===false||d.cache.lastIteration===false){f=d.page===1?0:(d.page-1)*d.numberBreak;this.each(l,d.filter,this.ACTIVE,true,d.numberBreak,f)}else if(e.isArray(a)&&d.cache.iteration===true){f=d.filter===false?d.page===1?0:(d.page-1)*d.numberBreak:d.cache.iteration===true?j>0?d.cache.firstIteration:d.cache.lastIteration:i;if(j>0&&d.filter!==false){for(j*=d.numberBreak;f--;)if(this.customFilter(d.filter,
a,f,g,this,this.ACTIVE)===true)if(h===j)break;else h++;f++;d.cache.lastIteration=f;k=null}else if(j<0&&d.filter!==false)k=Math.abs(j)*d.numberBreak-d.numberBreak||null;this.each(l,d.filter,this.ACTIVE,true,d.numberBreak,k,f)}c.cache.firstIteration=d.cache.lastIteration;c.cache.lastIteration=h+1;if(d.cache.autoIteration===true)c.cache.iteration=true;m=!m?d.resultNull===false?'<div class="'+b.css.noResult+'">'+b.viewVal.noResult+"</div>":d.resultNull:m;m=d.parser!==false?this.customParser(d.parser,
m):m;d.target[d.appendType](m);e.extend(true,d,{nmbOfEntries:this.length(d.filter),nmbOfEntriesInPage:e(d.calculator,d.target).length});d.finNumber=d.numberBreak*d.page-(d.numberBreak-d.nmbOfEntriesInPage);if(d.page!==1&&d.nmbOfEntriesInPage===0){d.page="-=1";this.extPrint(d)}else this.easyPage(d);return this};e.Collection.fn.easyPage=function(){return this};e.Collection.fn.genTable=function(a,b,c){a=a||4;b=b||"td";c=c===false?false:true;var d=1,g,f=this.dObj.active.target,h=f.find(b).length,j="";
f.find(b).each(function(k){this.tagName!=="td"&&e(this).wrap("<td></td>");if(d===a){j="";for(g=-1;++g<a;){j+="td:eq("+(k-g)+")";if(g!==a-1)j+=","}f.find(j).wrapAll("<tr></tr>");d=0}else if(k===h-1&&d!==a){j="";for(g=-1;++g<d;){j+="td:eq("+(k-g)+")";if(g!==d-1)j+=","}d--;f.find(j).wrapAll("<tr></tr>");if(c===true){for(j="";++d<a;)j+="<td></td>";f.find("tr:last").append(j)}}d++});f[0].tagName!=="table"&&f.children("tr").wrapAll("<table></table>");return this}})(jQuery);
//