/**
 * $.Collection
 * 
 * autor: kobezzza (kobezzza@gmail.com | http://kobezzza.com)
 * version: 4.0
 * date: 25.10.2011 16:03:41
 */
 (function(h){h.Collection=function(a,b){a=a||null;b=b||null;if(this.fn&&this.fn.jquery)return new h.Collection(a,b);h.extend(true,this,h.Collection.storage);var c=this.dObj.prop;b&&h.extend(true,c,b);if(h.isString(a)){c.activeTarget=h(a);c.activeCollection=null}else c.activeCollection=a};h.Collection.stat={};h.Collection.stat.templateMode={};h.Collection.stat.obj={constants:h.Collection.prototype.config.constants,getByLink:function(a,b){b=b.toString().split(constants.contextSeparator);for(var c,d=
0,e,f=0,g=b.length;d<g;d++){b[d]=h.trim(b[d]);if(b[d]&&b[d]!==constants.subcontextSeparator)if(b[d].search(constants.subcontextSeparator)===-1)a=a[b[d]];else{e=+b[d].replace(constants.subcontextSeparator,"");if(h.isArray(a))a=e>=0?a[e]:a[a.length+e];else{if(e<0){f=0;for(c in a)a.hasOwnProperty(c)&&f++;e+=f}f=0;for(c in a)if(a.hasOwnProperty(c)){if(e===f){a=a[c];break}f++}}}}return a},setByLink:function(a,b,c){b=b.toString().split(constants.contextSeparator);var d,e=0,f,g=0,j=b.length;for(e=j;e--;){b[e]=
h.trim(b[e]);if(b[e]===""||b[e]===constants.subcontextSeparator)b.splice(e,1)}j=b.length-1;for(e=0;e<=j;e++)if(b[e].search(constants.subcontextSeparator)===-1)if(e===j)a[b[e]]=c;else a=a[b[e]];else{f=+b[e].replace(constants.subcontextSeparator,"");if(h.isArray(a))if(e===j)if(f>=0)a[f]=c;else a[a.length+f]=c;else a=f>=0?a[f]:a[a.length+f];else{if(f<0){g=0;for(d in a)a.hasOwnProperty(d)&&g++;f+=g}g=0;for(d in a)if(a.hasOwnProperty(d)){if(f===g){if(e===j)a[d]=c;else a=a[d];break}g++}}}return true},addElementToObject:function(a,
b,c){b=b.split(constants.methodSeparator);var d,e={};if(b[1]&&b[1]=="unshift"){e[b[0]]=c;for(d in a)if(a.hasOwnProperty(d))e[d]=a[d];return e}else if(!b[1]||b[1]=="push")a[b[0]]=c;return true}};h.Collection.stat.sort={field:null,rev:false,shuffle:false,fn:null,sortBy:function(a,b,c){this.field=a||null;this.rev=b?b!=="shuffle"?b:false:false;this.shuffle=b?b==="shuffle"?b:false:false;this.fn=c||null;return this.sortHelper},sortHelper:function(a,b){var c=h.Collection.stat,d=c.sort,e=d.shuffle?Math.round(Math.random()*
2-1):d.rev?d.rev===true?-1:1:1;if(d.field){a=c.obj.getByLink(a,d.field);b=c.obj.getByLink(b,d.field)}if(d.fn){a=d.fn(a);b=d.fn(b)}if(d.shuffle)return e;else{if(a<b)return e*-1;if(a>b)return e;return 0}}};h.Collection.fn=h.Collection.prototype={name:"$.Collection",version:"4.0",collection:function(){return this.name+" "+this.version},config:{constants:{active:"active",contextSeparator:"~",subcontextSeparator:"#",methodSeparator:"::"},flags:{use:{ac:true}}},stack:["Collection","Filter","Context","Cache",
"Index","Map","Var","Defer","Page","Parser","AppendType","Target","SelectorOut","Pager","Template","TemplateMode","CountBreak","PageBreak","ResultNull"],getActiveContext:function(){return this.flags.use.ac===true?this.dObj.prop.activeContext.toString():""},callee:function(a){return this.dObj.sys.callee[a||"filter"]}};h.Collection.stat.templateMode.simpleMode=function(a){a=a||{};var b=a.collection?a.collection.Count:"",c=this.dObj,d=c.sys,e=c.css,f=c.viewVal,g=c.prop;c=a.page||g.activePage;var j=a.selectorOut||
g.activeSelectorOut,k=h(a.pager||g.activePager);b=a.countRecords||d.countRecords||b||0;j=a.countRecordsInPage||d.countRecordsInPage||h(j,g.activeTarget).length;g=a.countBreak||g.activeCountBreak;a=a.countTotal||d.countTotal||g*c-(g-j);d=e.pageNumber;var m=e.pagePrev,l=e.pageDisablePrev,n=e.pageNext;e=e.pageDisableNext;var o=f.aPrev,s=f.aNext;f=f.from;var r;if(c===1&&j===b)h("."+m+",."+l+",."+n+",."+e,k).addClass(e);else{if(a===b)h("."+n,k).replaceWith('<div class="'+e+'">'+s+"</div>");else{r=h("."+
e,k);r.length===1?r.replaceWith('<a href="javascript:;" class="'+n+'" data-action="set/page/next">'+s+"</a>"):h("."+n,k).removeClass(e)}if(c===1)h("."+m,k).replaceWith('<div class="'+l+'">'+o+"</div>");else{l=h("."+l,k);l.length===1?l.replaceWith('<a href="javascript:;" class="'+m+'" data-action="set/page/prev">'+o+"</a>"):h("."+m,k).removeClass(e)}}j===0?h("."+d,k).html(0):h("."+d,k).html((c-1)*g+1+"-"+a+" "+f+" "+b);return true};h.Collection.stat.templateMode.controlMode=function(a){a=a||{};var b=
a.collection?a.collection.Count:"",c=this.dObj,d=c.sys,e=c.css,f=c.viewVal,g=c.prop;c=a.page||g.activePage;var j=a.selectorOut||g.activeSelectorOut,k=h(a.pager||g.activePager);b=a.countRecords||d.countRecords||b||0;var m=a.countRecordsInPage||d.countRecordsInPage||h(j,g.activeTarget).length;j=a.countBreak||g.activeCountBreak;d=a.countTotal||d.countTotal||j*c-(j-m);m=b%j!==0?~~(b/j)+1:b/j;var l="",n=e.pageActive,o=e.pagingLeft,s=e.pagingRight,r=e.pageDisablePrev;e=e.pageDisableNext;var q=f.aPrev,p=
f.aNext,t=f.show;f=f.total;if(m>(a.pageBreak||g.activePageBreak)){l+=c!==1?'<a href="javascript:;" data-action="set/page[1">'+q+"</a>":'<div class="'+r+'">'+q+"</div>";g=0;for(a=c-1;a++<m;g++){if(g===0&&c!==1)l+='<a href="javascript:;" data-action="set/page['+(a-1)+'">'+(a-1)+"</a>";if(g===j-1)break;l+=a===c?'<a href="javascript:;" class="'+n+'">'+a+"</a>":'<a href="javascript:;" data-action="set/page['+a+'">'+a+"</a>"}l+=a!==m+1?'\t\t\t\t\t<a href="javascript:;" data-action="set/page['+(a+1)+'">'+
(a+1)+'</a>\t\t\t\t\t<a href="javascript:;" data-action="set/page['+m+'">'+p+"</a>\t\t\t\t":'<div class="'+e+'">'+p+"</div>"}else for(a=0;a++<m;)l+=a===c?'<a href="javascript:;" class="'+n+'">'+a+"</a>":'<a href="javascript:;" data-action="set/page['+a+'">'+a+"</a>";if(b===0)h("."+o+",."+s,k).empty();else{h("."+s,k).html(l);h("."+o,k).html(f+": "+b+". "+t+": "+((c-1)*j+1)+"-"+d)}return true};h.Collection.storage={dObj:{prop:{activeCollection:null,activeFilter:false,activeContext:"",activeCache:{autoIteration:false,
iteration:false,firstIteration:-1,lastIteration:-1},activeIndex:null,activeMap:null,activeVar:null,activeDefer:"",activePage:1,activeParser:false,activeAppendType:"html",activeTarget:null,activeSelectorOut:".SelectorOut",activePager:"#PageControl",activeTemplate:null,activeTemplateMode:h.Collection.stat.templateMode.simpleMode,activeCountBreak:10,activePageBreak:10,activeResultNull:false}}};h.Collection.storage.dObj.sys={callee:{callback:null,filter:null,parser:null,template:null,templateMode:null}};
(function(a){var b,c,d=h.Collection.storage.dObj.sys;for(b=a.length;b--;){c=a[b].substring(0,1).toLowerCase()+a[b].substring(1);d["active"+a[b]+"ID"]=null;d["tmp"+a[b]]={};d[c+"ChangeControl"]=null;d[c+"Back"]=[]}})(h.Collection.fn.stack);h.Collection.storage.dObj.viewVal={aPrev:"&lt;&lt;",aNext:"&gt;&gt;",total:"total",show:"show",from:"from",noResultInSearch:"nothing was found"};h.Collection.storage.dObj.css={pageNumber:"pageNumber",pagePrev:"pagePrev",pageDisablePrev:"pageDisablePrev",pageNext:"pageNext",
pageDisableNext:"pageDisableNext",pageActive:"pageActive",pagingRight:"pagingRight",pagingLeft:"pagingLeft",noResult:"noResult"};h.Collection.fn._mod=function(a,b,c){var d=this.dObj,e=d.prop,f=d.sys;d="active"+a;a=f["tmp"+a];f=f[d+"ID"];var g=function(j,k){if(h.isNumeric(j)||h.isString(j))j+=k;else if(h.isArray(j))j.push(k);else if(h.isBoolean(j))j=k===true&&j===true?false:true;return j};if(c&&c!==this.active){a[c]=g(a[c],b);if(f&&c===f)e[d]=a[c]}else{e[d]=g(e[d],b);if(f)a[f]=e[d]}return this};h.Collection.fn._push=
function(a,b,c){var d=this.dObj.sys,e=d["tmp"+a];d=d["active"+a+"ID"];var f;if(h.isPlainObject(b))for(f in b){if(b.hasOwnProperty(f))if(f===this.active)throw Error("invalid property name!");else if(e[f]&&d&&d===f)this._update(a,b[f]);else e[f]=b[f]}else if(f===this.active)throw Error("invalid property name!");else if(e[b]&&d&&d===b)this._update(a,c);else e[b]=c;return this};h.Collection.fn._set=function(a,b){var c=this.dObj,d=c.prop;c=c.sys;var e=a.substring(0,1).toLowerCase()+a.substring(1),f=e+
"ChangeControl",g="active"+a,j=g+"ID";if(c[j]!==b){c[f]=true;c[j]=b}else c[f]=false;c[e+"Back"].push(b);d[g]=c["tmp"+a][b];return this};h.Collection.fn._back=function(a,b){var c=this.dObj,d=c.prop;c=c.sys;var e=a.substring(0,1).toLowerCase()+a.substring(1),f="active"+a,g=c[e+"Back"];c[e+"ChangeControl"]=false;e=g.length-(b||1)-1;if(e>=0&&g[e])if(c["tmp"+a][g[e]]){c[f+"ID"]=g[e];d[f]=c["tmp"+a][g[e]];g.splice(e+1,g.length)}return this};h.Collection.fn._backIf=function(a){if(this.dObj.sys[a.substring(0,
1).toLowerCase()+a.substring(1)+"ChangeControl"]===true)return this._back.apply(this,arguments);return this};h.Collection.fn._drop=function(a,b,c){c=c===undefined?false:c;var d=this.dObj,e=d.prop;d=d.sys;var f="active"+a,g=f+"ID";a="tmp"+a;var j=d[g];b=!b?j?[j]:[]:h.isArray(b)||h.isPlainObject(b)?b:[b];var k;if(b[0]&&b[0]!==this.active)for(k in b){if(b.hasOwnProperty(k))if(!b[k]||b[k]===this.active){j&&delete d[a][j];d[g]=null;e[f]=c}else{delete d[a][b[k]];if(j&&b[k]===j){d[g]=null;e[f]=c}}}else{j&&
delete d[a][j];d[g]=null;e[f]=c}return this};h.Collection.fn._reset=function(a,b,c){c=c===undefined?false:c;var d=this.dObj,e=d.prop;d=d.sys;var f="active"+a;a="tmp"+a;var g=d[f+"ID"];b=!b?g?[g]:[]:h.isArray(b)||h.isPlainObject(b)?b:[b];var j;if(b[0]&&b[0]!==this.active)for(j in b){if(b.hasOwnProperty(j))if(!b[j]||b[j]===this.active){if(g)d[a][g]=c;e[f]=c}else{d[a][b[j]]=c;if(g&&b[j]===g)e[f]=c}}else{if(g)d[a][g]=c;e[f]=c}return this};h.Collection.fn._resetTo=function(a,b,c){var d=this.dObj;return this._reset(a,
b||"",!c||c===this.active?d.prop["active"+a]:d.sys["tmp"+a][c])};h.Collection.fn._exist=function(a,b){var c=this.dObj;if((!b||b===this.active)&&c.sys["active"+a+"ID"])return true;if(c.sys["tmp"+a][b]!==undefined)return true;return false};h.Collection.fn._is=function(a,b){if(b===this.dObj.sys["active"+a+"ID"])return true;return false};h.Collection.fn.use=function(a){this._exist("Collection",a)&&this._set("Collection",a);this._exist("Filter",a)&&this._set("Filter",a);this._exist("Context",a)&&this._set("Context",
a);this._exist("Cache",a)&&this._set("Cache",a);this._exist("Index",a)&&this._set("Index",a);this._exist("Map",a)&&this._set("Map",a);this._exist("Var",a)&&this._set("Var",a);this._exist("Defer",a)&&this._set("Defer",a);this._exist("Page",a)&&this._set("Page",a);this._exist("Parser",a)&&this._set("Parser",a);this._exist("AppendType",a)&&this._set("AppendType",a);this._exist("Target",a)&&this._set("Target",a);this._exist("SelectorOut",a)&&this._set("SelectorOut",a);this._exist("Pager",a)&&this._set("Pager",
a);this._exist("Template",a)&&this._set("Template",a);this._exist("TemplateMode",a)&&this._set("TemplateMode",a);this._exist("CountBreak",a)&&this._set("CountBreak",a);this._exist("PageBreak",a)&&this._set("PageBreak",a);this._exist("ResultNull",a)&&this._set("ResultNull",a);return this};h.Collection.fn._$=function(a,b){var c=this.dObj,d="active"+a;c.prop[d]=b;c.sys[d+"ID"]=null;return this};h.Collection.fn._update=function(a,b){var c=this.dObj,d=c.prop;c=c.sys;var e="active"+a,f=c[e+"ID"];d[e]=b;
if(f)c["tmp"+a][f]=d[e];return this};h.Collection.fn._get=function(a,b){var c=this.dObj;if(b&&b!==this.active)return c.sys["tmp"+a][b];return c.prop["active"+a]};h.Collection.fn._prop=function(a,b,c){var d=this.dObj[a];if(arguments.length!==3)if(h.isPlainObject(b))h.extend(d,b);else return d[b];else d[b]=c;return this};h.Collection.fn.prop=function(){return this._prop.apply(this,h.unshiftArguments(arguments,"prop"))};h.Collection.fn.css=function(){return this._prop.apply(this,h.unshiftArguments(arguments,
"css"))};h.Collection.fn.viewVal=function(){return this._prop.apply(this,h.unshiftArguments(arguments,"viewVal"))};(function(a){var b,c=h.Collection.fn,d;for(b=a.length;b--;){d=a[b]!=="Collection"?a[b]:"";c["$"+d]=function(e){return function(f){return this._$(e,f)}}(a[b]);if(a[b]==="Context")c["mod"+d]=function(e){return function(){return this._mod.apply(this,h.unshiftArguments(arguments,e))}}(a[b]);c["update"+d]=function(e){return function(f){return this._update(e,f)}}(a[b]);c["reset"+d+"To"]=function(e){return function(f,
g){return this._resetTo(e,f,g)}}(a[b]);c["push"+d]=function(e){return function(){return this._push.apply(this,h.unshiftArguments(arguments,e))}}(a[b]);c["set"+d]=function(e){return function(f){return this._set(e,f)}}(a[b]);c["pushSet"+d]=function(e){return function(f,g){return this._push(e,f,g)._set(e,f)}}(a[b]);c["back"+d]=function(e){return function(f){return this._back(e,f||"")}}(a[b]);c["back"+d+"If"]=function(e){return function(f){return this._backIf(e,f||"")}}(a[b]);c["drop"+d]=a[b]==="Filter"||
a[b]==="Parser"?function(e){return function(){return this._drop(e,arguments)}}(a[b]):function(e){return function(){return this._drop(e,arguments,null)}}(a[b]);if(a[b]==="Filter"||a[b]==="Parser")c["reset"+d]=function(e){return function(){return this._reset(e,arguments)}}(a[b]);else if(a[b]==="Page")c["reset"+d]=function(e){return function(){return this._reset(e,arguments,1)}}(a[b]);else if(a[b]==="Context")c["reset"+d]=function(e){return function(){return this._reset(e,arguments,"")}}(a[b]);c["is"+
d]=function(e){return function(f){return this._is(e,f)}}(a[b]);c["exist"+d]=function(e){return function(f){return this._exist(e,f||"")}}(a[b]);c["get"+d]=function(e){return function(f){return this._get(e,f||"")}}(a[b])}})(h.Collection.fn.stack);h.Collection.fn.setElement=function(a,b,c){a=h.isExist(a)?a.toString():"";var d=h.Collection.stat.obj,e=this.dObj,f=e.prop,g=this.getActiveContext();if(!a&&!g)return c&&c!==this.active?this._push("Collection",c,b):this._update("Collection",b);d.setByLink(c&&
c!==this.active?e.sys.tmpCollection[c]:f.activeCollection,g+d.contextSeparator+a,b);return this};h.Collection.fn.getElement=function(a,b){a=h.isExist(a)?a.toString():"";var c=h.Collection.stat.obj,d=this.dObj,e=d.prop,f=this.getActiveContext();return c.getByLink(b&&b!==this.active?d.sys.tmpCollection[b]:e.activeCollection,f+c.contextSeparator+a)};h.Collection.fn.addElement=function(a,b,c,d,e){a=a!==undefined?a:"";b=b||"push";e=e===true?true:false;var f=h.Collection.stat.obj,g=this.dObj,j=g.prop;g=
g.sys;var k,m;k=f.getByLink(c&&c!==this.active?g.tmpCollection[c]:j.activeCollection,j.activeContext);if(typeof k==="object"){m=h.isPlainObject(k);if(d){a=h.isExist(a)?a.toString():"";j=f.getByLink(d===this.active?j.activeCollection:g.tmpCollection[d],a);if(m===true){b=b==="push"?this.length(k):b==="unshift"?this.length(k)+f.methodSeparator+"unshift":b;f=f.addElementToObject(k,b.toString(),j)}else{f=true;if(b==="push")k.push(j);else b==="unshift"&&k.unshift(j)}if(e===true){if(g.activeContextID){b=
g.activeContextID;e=true}else{b=this._get("Context");e=false}this._$("Context","");d===this.active?this.deleteElementByLink(a):this.deleteElementByLink(a,d);e===true?this._set("Context",b):this._$("Context",b)}}else if(m===true){b=b==="push"?this.length(k):b==="unshift"?this.length(k)+f.methodSeparator+"unshift":b;f=f.addElementToObject(k,b.toString(),a)}else{f=true;if(b==="push")k.push(a);else b==="unshift"&&k.unshift(a)}if(f!==true)this.setElement("",f,c||"")}else throw Error("Unable to set property!");
return this};h.Collection.fn.deleteElementByLink=function(a,b){a=h.isExist(a)?a.toString():"";var c=h.Collection.stat.obj,d=this.dObj,e=d.prop,f,g=0;g=0;e.activeContext=e.activeContext.toString();if(!a&&!e.activeContext)this.setElement("",null);else{a=(e.activeContext+c.contextSeparator+a).split(c.contextSeparator);for(g=a.length;g--;){a[g]=h.trim(a[g]);if(a[g]===""||a[g]===c.subcontextSeparator)a.splice(g,1)}a=a.join(c.contextSeparator);d=c.getByLink(b&&b!=="active"?d.sys.tmpCollection[b]:e.activeCollection,
a.replace(RegExp("[^"+c.contextSeparator+"]+$"),""));a=a.replace(RegExp(".*?([^"+c.contextSeparator+"]+$)"),"$1");if(h.isArray(d)){a=+a.replace(c.subcontextSeparator,"");a>=0?d.splice(a,1):d.splice(d.length+a,1)}else if(a.search(c.subcontextSeparator)===-1)delete d[a];else{c=+a.replace(c.subcontextSeparator,"");if(c<0){g=0;for(f in d)d.hasOwnProperty(f)&&g++;c+=g}g=0;for(f in d)if(d.hasOwnProperty(f)){if(c===g){delete d[f];break}g++}}}return this};h.Collection.fn.deleteElementsByLink=function(a,b){var c,
d;if(h.isPlainObject(a))for(c in a){if(a.hasOwnProperty(c))if(h.isArray(a[c]))for(d=a[c].length;d--;)this.deleteElementByLink(a[c][d],c);else this.deleteElementByLink(a[c],c)}else if(h.isArray(a))for(d=a.length;d--;)this.deleteElementByLink(a[d],b||"");else this.deleteElementByLink(a,b||"");return this};h.Collection.fn.concat=function(a,b,c){b=h.isExist(b)?b.toString():"";var d=h.Collection.stat.obj,e=this.dObj,f=e.prop;d=d.getByLink(c&&c!==this.active?e.sys.tmpCollection[c]:f.activeCollection,f.activeContext+
d.contextSeparator+b);if(typeof d==="object")if(h.isPlainObject(d))h.extend(true,d,a);else{if(h.isArray(d))if(h.isArray(a)){d=Array.prototype.concat(d,a);this.setElement(b,d,c||"")}else this.addElement(a,"push",c||"")}else throw Error("Incorrect data type!");return this};h.Collection.fn.length=function(a,b){a=h.isExist(a)?a:false;var c=this.dObj,d=c.prop,e,f,g;if(!h.isFunction(a))if(h.isString(a)&&!h.isExist(b)||h.isArray(a)||h.isPlainObject(a)){b=a;a=false}if(!b||b===this.active)c=d.activeCollection;
else if(h.isString(b))c=c.sys.tmpCollection[b];else{e=true;c=b}if(e!==true)c=h.Collection.stat.obj.getByLink(c,d.activeContext);if(c===null)return 0;d=c.length;if(h.isString(c))return d;if(typeof c==="object")if(a===false&&d!==undefined)g=d;else{g=0;for(f in c)if(c.hasOwnProperty(f)&&(a===false||this.customFilter(a,c,f,d||null,this,e===true?"array":b?b:this.active))===true)g++}else throw Error("Incorrect data type!");return g};h.Collection.fn.each=function(a,b,c,d,e,f,g){b=b||false;c=h.isExist(c)?
c:this.active;if(h.isBoolean(c)){g=f;f=e;e=d;d=c;c=this.active}d=d===false?false:true;e=parseInt(e)>=0?parseInt(e):false;f=parseInt(f)||false;g=parseInt(g)||false;var j=this.dObj,k=j.prop,m=j.sys,l,n=0;j.sys.callbackCallee=a;if(a.before)if(a.before.apply(this,arguments)===false)return this;j=h.Collection.stat.obj.getByLink(c!==this.active?m.tmpCollection[c]:k.activeCollection,k.activeContext);k=this.length(j);if(h.isArray(j)){m=k-1;for(l=g!==false?g-1:-1;l++<m;){if(e!==false&&n===e)break;if(a.beforeFilter)if(a.beforeFilter(j,
l,k,this,c)===false)return this;if(b===false||this.customFilter(b,j,l,k,this,c)===true){if(f!==false&&f!==0){f--;continue}if(a.call(this,j,l,k,this,c)===false)break;if(d===false)break;n++}if(a.afterFilter)if(a.afterFilter(j,l,k,this,c)===false)return this}}else for(l in j)if(j.hasOwnProperty(l)){if(e!==false&&n===e)break;if(g!==false&&g!==0)g--;else{if(a.beforeFilter)if(a.beforeFilter(j,l,k,this,c)===false)return this;if(b===false||this.customFilter(b,j,l,k,this,c)===true){if(f!==false&&f!==0){f--;
continue}if(a.call(this,j,l,k,this,c)===false)break;if(d===false)break;n++}if(a.afterFilter)if(a.afterFilter(j,l,k,this,c)===false)return this}}a.after&&a.after.apply(this,arguments);return this};h.Collection.fn.searchElements=function(a,b,c,d,e,f){a=a||false;b=h.isExist(b)?b:this.active;if(h.isBoolean(b)){f=e;e=d;d=c;c=b;b=this.active}c=c===false?false:true;d=parseInt(d)>=0?parseInt(d):false;e=parseInt(e)||false;f=parseInt(f)||false;var g=[];this.each(function(j,k){if(c===true)g.push(k);else{g=k;
return false}return true},a,b,c,d,e,f);return g};h.Collection.fn.searchElement=function(a,b){return this.searchElements(a||"",b||"",false)};h.Collection.fn.returnElements=function(a,b,c,d,e,f){a=a||false;b=h.isExist(b)?b:this.active;if(h.isBoolean(b)){f=e;e=d;d=c;c=b;b=this.active}c=c===false?false:true;d=parseInt(d)>=0?parseInt(d):false;e=parseInt(e)||false;f=parseInt(f)||false;var g=[];this.each(function(j,k){if(c===true)g.push(j[k]);else{g=j[k];return false}return true},a,b,c,d,e,f);return g};
h.Collection.fn.returnElement=function(a,b){return this.returnElements(a||"",b||"",false)};h.Collection.fn.replaceElements=function(a,b,c,d,e,f,g){a=a||false;c=h.isExist(c)?c:this.active;if(h.isBoolean(c)){g=f;f=e;e=d;d=c;c=this.active}d=d===false?false:true;e=parseInt(e)>=0?parseInt(e):false;f=parseInt(f)||false;g=parseInt(g)||false;var j=h.isFunction(b);this.each(function(k,m,l,n,o){if(j)b(k,m,l,n,o);else k[m]=b;return true},a,c,d,e,f,g);return this};h.Collection.fn.replaceElement=function(a,b,
c){return this.replaceElements(a||"",b,c||"",false)};h.Collection.fn.moveElements=function(a,b,c,d,e,f,g,j,k,m){a=a||false;m=m===false?false:true;b=h.isExist(b)?b.toString():"";c=c||"";d=d||"";e=e||"push";f=f===false?false:true;g=parseInt(g)>=0?parseInt(g):false;j=parseInt(j)||false;k=parseInt(k)||false;var l=h.Collection.stat.obj,n=this.dObj,o=n.sys,s,r=[];n=h.isArray(l.getByLink(this._get("Collection",d),n.prop.activeContext));if(o.activeContextID){o=o.activeContextID;s=true}else{o=this._get("Context");
s=false}this._$("Context",b);a=this.searchElements(a,c,f,g,j,k);s===true?this._set("Context",o):this._$("Context",o);if(f===true){f=a.length-1;for(g=-1;g++<f;){this.addElement(b+l.contextSeparator+a[g],n===true?e:a[g]+l.methodSeparator+e,d,c);m===true&&r.push(a[g])}}else{this.addElement(b+l.contextSeparator+a,n===true?e:a+l.methodSeparator+e,d,c);m===true&&r.push(a)}if(m===true){this._$("Context",b);this.deleteElementsByLink(r,c);s===true?this._set("Context",o):this._$("Context",o)}return this};h.Collection.fn.moveElement=
function(a,b,c,d,e){return this.moveElements(a||"",h.isExist(b)?b.toString():"",c||"",d||"",e||"",false)};h.Collection.fn.copyElements=function(a,b,c,d,e,f,g,j,k){a=a||false;b=h.isExist(b)?b.toString():"";c=c||"";d=d||"";e=e||"push";f=f===false?false:true;g=parseInt(g)>=0?parseInt(g):false;j=parseInt(j)||false;k=parseInt(k)||false;return this.moveElements(a,b,c,d,e,f,g,j,k,false)};h.Collection.fn.copyElement=function(a,b,c,d,e){return this.moveElements(a||"",h.isExist(b)?b.toString():"",c||"",d||
"",e||"",false,"","","",false)};h.Collection.fn.deleteElements=function(a,b,c,d,e,f){a=a||false;b=h.isExist(b)?b:this.active;if(h.isBoolean(b)){f=e;e=d;d=c;c=b;b=this.active}c=c===false?false:true;d=parseInt(d)>=0?parseInt(d):false;e=parseInt(e)||false;f=parseInt(f)||false;a=this.searchElements(a,b,c,d,e,f);if(c===false)this.deleteElementByLink(a,b);else for(c=a.length;c--;)this.deleteElementByLink(a[c],b);return this};h.Collection.fn.deleteElement=function(a,b){return this.deleteElements(a||"",b||
"",false)};h.Collection.fn.customFilter=function(a,b,c,d,e,f){var g,j=this.dObj,k=j.prop,m=j.sys,l,n,o=true,s,r,q,p=-1;if(h.isFunction(a)){j.sys.filterCallee=a;return a(b,c,d,e,f)}if(!a||h.isString(a)&&h.trim(a)===this.active){if(k.activeFilter){j.sys.filterCallee=k.activeFilter;return k.activeFilter(b,c,d,e,f)}return true}else{if(!h.isArray(a)){if(a.search(/\|\||&&|!|\(|\)/)===-1){j.sys.filterCallee=m.tmpFilter[a];return m.tmpFilter[a](b,c,d,e,f)}a=h.trim(a.toString().replace(/\s*(\(|\))\s*/g," $1 ").replace(/\s*(\|\||&&)\s*/g,
" $1 ").replace(/(!)\s*/g,"$1")).split(" ")}n=function(t,v){for(var u=-1,x=t.length-1,w=0,y=[];u++<x;){v++;t[u]==="("&&w++;if(t[u]===")")if(w===0)return{result:y,iter:v};else w--;y.push(t[u])}};for(l=a.length-1;p++<l;)if(a[p]==="("||a[p]==="!("){if(a[p].substring(0,1)==="!"){q=true;a[p]=a[p].substring(1)}else q=false;g=n(a.slice(p+1),p);p=g.iter;g=this.customFilter(g.result,b,c,d,e,f);o=!s&&!r?q===true?!g:g:s?q===true?!g:g&&o:q===true?!g:g||o}else if(a[p]!==")"&&a[p]!=="||"&&a[p]!=="&&"){if(a[p].substring(0,
1)==="!"){q=true;a[p]=a[p].substring(1)}else q=false;g=a[p]===this.active?k.activeFilter:m.tmpFilter[a[p]];j.sys.filterCallee=g;g=g(b,c,d,e,f);o=!s&&!r?q===true?!g:g:s?q===true?!g:g&&o:q===true?!g:g||o}else if(a[p]==="||"){s=false;r=true}else if(a[p]==="&&"){r=false;s=true}return o}};h.Collection.fn.customParser=function(a,b){var c=this.dObj,d=c.prop,e=c.sys,f,g;if(h.isFunction(a)){c.sys.parserCallee=a;return a(b,this)}if(!a||h.isString(a)&&h.trim(a)===this.active){if(d.activeParser){c.sys.parserCallee=
d.activeParser;return d.activeParser(b,this)}}else{if(h.isString(a)){a=h.trim(a);if(a.search("&&")===-1){c.sys.parserCallee=e.tmpParser[a];return e.tmpParser[a](b,this)}a=a.split("&&")}for(g=a.length;g--;){a[g]=h.trim(a[g]);f=a[g]===this.active?d.activeParser:e.tmpParser[a[g]];c.sys.parserCallee=f;b=f(b,this)}}return b};h.Collection.fn.parentContext=function(a,b){a=a||1;var c=this.dObj,d=c.sys,e=c.prop;c="";c=(b&&b!==this.active?d.tmpContext[b]:e.activeContext).split(h.Collection.stat.obj.contextSeparator);
for(d=a;d--;)c.splice(-1,1);return c.join(h.Collection.stat.obj.contextSeparator)};h.Collection.fn.parent=function(a,b){var c=this.dObj,d=c.sys,e=c.prop;c=c.sys.activeContextID;var f=this.parentContext.apply(this,arguments);if(!b||b===this.active){if(c)d.tmpContext[c]=f;e.activeContext=f}else{d.tmpContext[b]=f;if(c&&b===c)e.activeContext=f}return this};h.Collection.fn.orderBy=function(a,b,c,d){a=a||null;b=b||false;c=c?c===false?null:c:function(m){if(isNaN(m))return m.toUpperCase();return m};d=d||
"";var e=h.Collection.stat,f=this.dObj,g=f.prop,j=f.sys;f=function(m){var l=[],n={},o;for(o in m)m.hasOwnProperty(o)&&l.push(o);l.sort(e.sort.sortBy(a,b,c));for(o in l)if(l.hasOwnProperty(o))n[l[o]]=m[l[o]];return n};var k=function(m){var l=[],n={},o;for(o in m)m.hasOwnProperty(o)&&l.push({key:o,value:m[o]});l.sort(e.sort.sortBy(a===true?"value":"value"+e.obj.contextSeparator+a,b,c));for(o in l)if(l.hasOwnProperty(o))n[l[o].key]=l[o].value;return n};g=e.obj.getByLink(d?j.tmpCollection[d]:g.activeCollection,
g.activeContext);if(typeof g==="object")if(h.isArray(g))g.sort(e.sort.sortBy(a,b,c));else{g=a?k.call(this,g):f.call(this,g);this.setElement("",g,d||"")}else throw Error("Incorrect data type!");return this};h.Collection.fn.toString=function(a,b,c){var d=this.dObj,e=d.prop;a=a&&h.isString(a)&&a!==this.active?d.sys.tmpCollection[a]:typeof a==="object"?a:e.activeCollection;a=h.Collection.stat.obj.getByLink(a,e.activeContext);return JSON.stringify(a,b||"",c||"")};h.Collection.fn.valueOf=function(a){return this.length(h.isExist(a)?
a:this.active)};h.Collection.fn.then=function(a,b){var c=this;arguments.length===1?h.when(this.prop("activeDefer")).always(function(){a.apply(c,arguments)}):h.when(this.prop("activeDefer")).then(function(){a().apply(c,arguments)},function(){b().apply(c,arguments)});return this};h.Collection.fn.print=function(a,b,c,d,e){a=a||{};b=b===false?false:true;c=parseInt(c)>=0?parseInt(c):false;d=parseInt(d)||false;e=parseInt(e)||false;var f=this.dObj,g=f.prop,j=a.parser||g.activeParser,k=a.template||g.activeTemplate,
m=a.target||a.target===false?a.target:g.activeTarget,l=a.resultNull!==undefined?a.resultNull:g.activeResultNull,n="";f.sys.templateCallee=k;this.each(function(o,s,r,q,p){n+=k(o,s,r,q,p);if(b!==true)return false;return true},a.filter||g.activeFilter,"active",b,c,d,e);n=!n?l===false?'<div class="'+f.css.noResult+'">'+f.viewVal.noResultInSearch+"</div>":l:n;n=j!==false?this.customParser(j,n):n;if(m===false)a.variable?this.PushSetVar(a.variable,n):this.$Var(n);else m[a.appendType||g.activeAppendType](n);
return this};h.Collection.fn.extPrint=function(a){a=a||{};var b=this.dObj,c=b.sys,d=b.prop,e,f,g,j=0,k=a.filter?a.filter:d.activeFilter,m=a.parser?a.parser:d.activeParser,l=a.page||d.activePage,n=l===a.page+1,o=a.template||d.activeTemplate,s=a.target||d.activeTarget,r=+a.countBreak||+d.activeCountBreak,q=d.activeCache;g=h.isBoolean(a.cacheIteration)?a.cacheIteration:q.iteration;var p=a.resultNull!==undefined?a.resultNull:d.activeResultNull,t="",v=function(u,x,w,y,z){t+=o(u,x,w,y,z);j=x;return true};
e=h.Collection.stat.obj.getByLink(d.activeCollection,a.context||d.activeContext);f=this.length();r=r===false?f:r;b.sys.templateCallee=o;if(h.isPlainObject(e)||g===false)this.each(v,k,"active",true,r,l===1?r:(l-1)*r);else if(h.isArray(e)&&g===true){g=k===false?l===1?-1:(l-1)*r-1:g===true?n===true?q.firstIteration:q.lastIteration:i;if(n===true&&k!==false){for(;g--;)if(this.customFilter(k,e,g,f,this,"active")===true)if(j===r)break;else j++;g=g===-1?g:g+1;q.lastIteration=g}this.each(v,k,"active",true,
r,null,g);q.firstIteration=q.lastIteration;q.lastIteration=j-1;if(q.autoIteration===true)q.iteration=true}t=!t?p===false?'<div class="'+b.css.noResult+'">'+b.viewVal.noResultInSearch+"</div>":p:t;t=m!==false?this.customParser(m,t):t;s[a.appendType||d.activeAppendType](t);c.countRecords=this.length(k);c.countRecordsInPage=h(a.selectorOut||d.activeSelectorOut,s).length;c.countTotal=r*l-(r-c.countRecordsInPage);h.extend(a,{countRecords:c.countRecords,countRecordsInPage:c.countRecordsInPage,countTotal:c.countTotal});
if(l!==1&&c.countRecordsInPage===0){b.prop.activePage--;this.extPrint.apply(this,arguments)}else this.easyPage(a,b.prop);return this};h.Collection.fn.easyPage=function(){this.dObj.sys.templateModeCallee=this.dObj.prop.activeTemplateMode;this.dObj.prop.activeTemplateMode.apply(this,arguments);return this};h.Collection.fn.genTable=function(a){a=a||4;var b=1,c,d=this.dObj.prop.activeTarget,e=d.children("td").length-1,f=a-1,g="";d.children("td").each(function(j){if(b===a){g="";for(c=-1;c++<f;){g+="td:eq("+
(j-c)+")";if(c!==f)g+=","}h(g,d).wrapAll("<tr></tr>");b=0}else if(j===e&&b!==a){g="";for(c=0;c<b;c++){g+="td:eq("+c+")";if(c!==b-1)g+=","}d.children(g).wrapAll("<tr></tr>");for(g="";b<a;b++)g+="<td></td>";d.children("tr:last").append(g)}b++});d.children("tr").wrapAll("<table></table>");return this};h.Collection.fn.genIndex=function(){console.log({})};h.Collection.fn.genMap=function(a,b){var c=this.dObj.sys.activeCollectionID;if(!((!a||a===this.active||!b||b===this.active)&&c))if(!c)throw Error("Invalid ID collection");
console.log({})};h.fn.collection=function(a){var b=h.fn.collection.stat,c=function(e){var f=[];e.each(function(g){var j=h(this),k=j.data(),m=j.attr("class")?j.attr("class").split(" "):"",l=m?m.length:0,n;n=j[0];n=n.childNodes;for(var o=n.length-1,s=-1,r="";s++<o;)if(n[s].nodeType===3&&h.trim(n[s].textContent))r+=n[s].textContent;n=r?r:false;var q;f.push({});for(q in k)if(k.hasOwnProperty(q))f[g][q]=k[q];if(l){f[g][b.classes]={};for(q=0;q<l;q++)f[g][b.classes][m[q]]=m[q]}if(j.children().length!==0)f[g][b.childNodes]=
c(j.children());if(n!==false)f[g][b.val]=n.replace(/[\r\t\n]/g," ")});return f},d=c(this);if(a)return new h.Collection(d,a);return new h.Collection(d)};if(!h.fn.collection.stat)h.fn.collection.stat={val:"val",childNodes:"childNodes",classes:"classes"};h.fn.tplCompile=function(){if(this.length===0)throw Error("DOM element isn't exist!");for(var a=this.eq(0).html().split("?>").join("<?js").replace(/[\r\t\n]/g," ").split("<?js"),b=a.length-1,c="var result = ''",d="",e=-1,f,g;e++<b;)if(e===0||e%2===0)c+=
"+'"+a[e]+"'";else{f=-1;a[e]=a[e].split("`");for(g=a[e].length;f++<g;)if(f===0||f%2===0)a[e][f]&&(d+=a[e][f]);else a[e][f]&&(c+="+"+a[e][f])}c+=";";return new Function("$this","i","aLength","$obj","id",c+d+" return result;")};h.isString=function(a){return Object.prototype.toString.call(a)==="[object String]"};h.isBoolean=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"};h.isExist=function(a){return a!==undefined&&a!=="undefined"&&a!==null&&a!==""};h.unshiftArguments=function(a,
b){for(var c=[b],d=0,e=a.length;d<e;d++)c.push(a[d]);return c}})(jQuery);JSON||(JSON={});
(function(){function h(k){return k<10?"0"+k:k}function a(k){d.lastIndex=0;return d.test(k)?'"'+k.replace(d,function(m){var l=g[m];return typeof l==="string"?l:"\\u"+("0000"+m.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+k+'"'}function b(k,m){var l,n,o,s,r=e,q,p=m[k];p&&typeof p==="object"&&typeof p.toJSON==="function"&&(p=p.toJSON(k));typeof j==="function"&&(p=j.call(m,k,p));switch(typeof p){case "string":return a(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";e+=f;q=[];if(Object.prototype.toString.apply(p)==="[object Array]"){s=p.length;for(l=0;l<s;l+=1)q[l]=b(l,p)||"null";o=q.length===0?"[]":e?"[\n"+e+q.join(",\n"+e)+"\n"+r+"]":"["+q.join(",")+"]";e=r;return o}if(j&&typeof j==="object"){s=j.length;for(l=0;l<s;l+=1)typeof j[l]==="string"&&(n=j[l],(o=b(n,p))&&q.push(a(n)+(e?": ":":")+o))}else for(n in p)Object.prototype.hasOwnProperty.call(p,n)&&(o=b(n,p))&&q.push(a(n)+(e?": ":":")+o);o=q.length===0?"{}":e?"{\n"+e+q.join(",\n"+
e)+"\n"+r+"}":"{"+q.join(",")+"}";e=r;return o}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,f,g={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof JSON.stringify!=="function")JSON.stringify=function(k,m,l){var n;f=e="";if(typeof l==="number")for(n=0;n<l;n+=1)f+=" ";else typeof l==="string"&&(f=l);if((j=m)&&typeof m!=="function"&&(typeof m!=="object"||typeof m.length!=="number"))throw Error("JSON.stringify");return b("",
{"":k})};if(typeof JSON.parse!=="function")JSON.parse=function(k,m){function l(o,s){var r,q,p=o[s];if(p&&typeof p==="object")for(r in p)Object.prototype.hasOwnProperty.call(p,r)&&(q=l(p,r),q!==void 0?p[r]=q:delete p[r]);return m.call(o,s,p)}var n;k=String(k);c.lastIndex=0;c.test(k)&&(k=k.replace(c,function(o){return"\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(k.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return n=eval("("+k+")"),typeof m==="function"?l({"":n},""):n;throw new SyntaxError("JSON.parse");}})();
//