/**
 * $.Collection
 * 
 * autor: kobezzza (kobezzza@gmail.com | http://kobezzza.com)
 * version: 3.2.5
 * date: 22.12.2011 20:08:43
 */
 (function(e){e.Collection=function(a,b){a=a||null;b=b||null;if(this.fn&&(!this.fn.name||this.fn.name!=="$.Collection"))return new e.Collection(a,b);e.extend(true,this,e.Collection.storage);var d=this.dObj.active;b&&e.extend(true,d,b);if(e.isString(a)){d.target=e(a);d.collection=null}else d.collection=a};e.Collection.fn=e.Collection.prototype={name:"$.Collection",version:"3.3",collection:function(){return this.name+" "+this.version},ACTIVE:"active",stack:["collection","filter","context","cache","index",
"map","variable","defer","page","parser","appendType","target","calculator","pager","template","numberBreak","pageBreak","resultNull"],getActiveParam:function(a){return this.dObj.sys.flags.use[a]===undefined||this.dObj.sys.flags.use[a]===true?this.dObj.active[a]:""},enable:function(a){this.dObj.sys.flags.use[a]=true;return this},disable:function(a){this.dObj.sys.flags.use[a]=false;return this},toggle:function(a){if(this.dObj.sys.flags.use[a]===true)return this.disable(a);return this.enable(a)}};e.Collection.templateModels=
{};e.Collection.sort={SHUFFLE:"shuffle",field:null,rev:false,shuffle:false,fn:null,sortBy:function(a,b,d){this.field=a||null;this.rev=b?b!==this.SHUFFLE?b:false:false;this.shuffle=b?b===this.SHUFFLE?b:false:false;this.fn=d||null;return this.sortHelper},sortHelper:function(a,b){var d=e.Collection.sort,c=d.shuffle?Math.round(Math.random()*2-1):d.rev?d.rev===true?-1:1:1;if(d.field){a=nimble.byLink(a,d.field);b=nimble.byLink(b,d.field)}if(d.fn){a=d.fn(a);b=d.fn(b)}if(d.shuffle)return c;else{if(a<b)return c*
-1;if(a>b)return c;return 0}}};e.fn.collection=function(a){var b=e.fn.collection.stat,d=function(f){var g=[];f.each(function(j){var h=e(this),k=h.data(),l=h.attr("class")?h.attr("class").split(" "):"",m=l?l.length:0,n;n=h[0];n=n.childNodes;for(var p=n.length,r=-1,q="";++r<p;)if(n[r].nodeType===3&&e.trim(n[r].textContent))q+=n[r].textContent;n=q?q:false;var o;g.push({});for(o in k)if(k.hasOwnProperty(o))g[j][o]=k[o];if(m){m--;g[j][b.classes]={};for(o=-1;++o<=m;)g[j][b.classes][l[o]]=l[o]}if(h.children().length!==
0)g[j][b.childNodes]=d(h.children());if(n!==false)g[j][b.val]=n.replace(/[\r\t\n]/g," ")});return g},c=d(this);if(a)return new e.Collection(c,a);return new e.Collection(c)};if(!e.fn.collection.stat)e.fn.collection.stat={val:"val",childNodes:"childNodes",classes:"classes"};e.fn.ctplCompile=function(){if(this.length===0)throw Error("DOM element isn't exist!");for(var a=this.html().replace(/\/\*.*?\*\//g,"").split("?>").join("<?js").replace(/[\r\t\n]/g," ").split("<?js"),b=a.length,d="var key = i, result = ''; ",
c=-1;++c<b;)d+=c===0||c%2===0?"result +='"+a[c]+"';":a[c].split("echo").join("result +=");return new Function("data","i","cOLength","self","id",d+" return result;")};e.fn.ctplMake=function(a){this.find("[type='text/ctpl']").each(function(){var b=e(this),d=b.data(),c=d.prefix?d.prefix+"_":"";a.pushTemplate(c+d.name,b.ctplCompile());d.set&&d.set===true&&a.setTemplate(c+d.name)})};e.isString=function(a){return nimble.isString(a)};e.isBoolean=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"};
e.isExist=function(a){return nimble.isExist(a)};e.unshiftArguments=function(a,b){for(var d=[b],c=-1,f=a.length;++c<f;)d.push(a[c]);return d};e.toUpperCase=function(a,b,d){d=d||0;if(!b)return a.toUpperCase();return a.substring(d,b).toUpperCase()+a.substring(b)};e.toLowerCase=function(a,b,d){d=d||0;if(!b)return a.toLowerCase();return a.substring(d,b).toLowerCase()+a.substring(b)};e.Collection.storage={dObj:{active:{collection:null,filter:false,context:"",cache:{autoIteration:false,iteration:false,firstIteration:false,
lastIteration:false},index:null,map:null,variable:null,defer:"",page:1,parser:false,appendType:"html",target:null,calculator:".line",pager:"#pageControl",template:null,numberBreak:10,pageBreak:10,resultNull:""}}};e.Collection.storage.dObj.sys={flags:{use:{context:true,filter:true,parser:true}}};(function(a){var b,d,c=e.Collection.storage.dObj.sys;for(b=a.length;b--;){d=e.toUpperCase(a[b],1);c["active"+d+"ID"]=null;c["tmp"+d]={};c[a[b]+"ChangeControl"]=null;c[a[b]+"Back"]=[]}})(e.Collection.fn.stack);
e.Collection.fn._$=function(a,b){var d=this.dObj,c=d.active,f=e.toUpperCase(a,1);c[a]=nimble.expr(b,c[a]||"");d.sys["active"+f+"ID"]=null;return this};e.Collection.fn._update=function(a,b){var d=this.dObj,c=d.active;d=d.sys;var f=e.toUpperCase(a,1),g=d["active"+f+"ID"];c[a]=nimble.expr(b,c[a]||"");if(g)d["tmp"+f][g]=c[a];return this};e.Collection.fn._get=function(a,b){var d=this.dObj;if(b&&b!==this.ACTIVE)return d.sys["tmp"+e.toUpperCase(a,1)][b];return d.active[a]};e.Collection.fn._push=function(a,
b,d){var c=this.dObj.sys,f=e.toUpperCase(a,1),g=c["tmp"+f];c=c["active"+f+"ID"];var j;if(e.isPlainObject(b))for(j in b){if(b.hasOwnProperty(j))if(j===this.ACTIVE)throw Error("invalid property name!");else if(g[j]&&c&&c===j)this._update(a,b[j]);else g[j]=b[j]}else if(b===this.ACTIVE)throw Error("invalid property name!");else if(g[b]&&c&&c===b)this._update(a,d);else g[b]=d;return this};e.Collection.fn._set=function(a,b){var d=this.dObj,c=d.sys,f=e.toUpperCase(a,1),g=a+"ChangeControl",j="active"+f+"ID";
if(c[j]!==b){c[g]=true;c[j]=b}else c[g]=false;c[a+"Back"].push(b);d.active[a]=c["tmp"+f][b];return this};e.Collection.fn._back=function(a,b){var d=this.dObj,c=d.sys,f=e.toUpperCase(a,1),g=c[a+"Back"],j;c[a+"ChangeControl"]=false;j=g.length-(b||1)-1;if(j>=0&&g[j])if(c["tmp"+f][g[j]]){c["active"+f+"ID"]=g[j];d.active[a]=c["tmp"+f][g[j]];g.splice(j+1,g.length)}return this};e.Collection.fn._backIf=function(a){if(this.dObj.sys[a+"ChangeControl"]===true)return this._back.apply(this,arguments);return this};
e.Collection.fn._drop=function(a,b,d,c){d=d===undefined?false:d;var f=this.dObj,g=f.active;f=f.sys;var j=e.toUpperCase(a,1),h="active"+j+"ID";j="tmp"+j;var k=f[h];b=!b?k?[k]:[]:e.isArray(b)||e.isPlainObject(b)?b:[b];var l;if(b[0]&&b[0]!==this.ACTIVE)for(l in b){if(b.hasOwnProperty(l))if(!b[l]||b[l]===this.ACTIVE)if(c===undefined){k&&delete f[j][k];f[h]=null;g[a]=d}else{if(k)f[j][k]=c;g[a]=c}else if(c===undefined){delete f[j][b[l]];if(k&&b[l]===k){f[h]=null;g[a]=d}}else{f[j][b[l]]=c;if(k&&b[l]===k)g[a]=
c}}else if(c===undefined){k&&delete f[j][k];f[h]=null;g[a]=d}else{if(k)f[j][k]=c;g[a]=c}return this};e.Collection.fn._reset=function(a,b,d){return this._drop(a,b||"","",d===undefined?false:d)};e.Collection.fn._resetTo=function(a,b,d){var c=this.dObj;d=!d||d===this.ACTIVE?c.active[a]:c.sys["tmp"+e.toUpperCase(a,1)][d];return this._reset(a,b||"",d)};e.Collection.fn._exist=function(a,b){var d=this.dObj,c=e.toUpperCase(a,1);if((!b||b===this.ACTIVE)&&d.sys["active"+c+"ID"])return true;if(d.sys["tmp"+c][b]!==
undefined)return true;return false};e.Collection.fn._is=function(a,b){if(b===this.dObj.sys["active"+e.toUpperCase(a,1)+"ID"])return true;return false};e.Collection.fn.use=function(a){for(var b=this.stack.length;b--;)this._exist(this.stack[b],a)&&this._set(this.stack[b],a);return this};e.Collection.fn._prop=function(a,b,d){var c=this.dObj[a];if(arguments.length!==3)if(e.isPlainObject(b))e.extend(c,b);else return c[b];else c[b]=d;return this};e.Collection.fn.active=function(){return this._prop.apply(this,
e.unshiftArguments(arguments,"active"))};(function(a){var b,d=e.Collection.fn,c;for(b=a.length;b--;){c=e.toUpperCase(a[b],1);d["$"+c]=function(f){return function(g){return this._$(f,g)}}(a[b]);d["update"+c]=function(f){return function(g){return this._update(f,g)}}(a[b]);d["reset"+c+"To"]=function(f){return function(g,j){return this._resetTo(f,g,j)}}(a[b]);d["push"+c]=function(f){return function(){return this._push.apply(this,e.unshiftArguments(arguments,f))}}(a[b]);d["set"+c]=function(f){return function(g){return this._set(f,
g)}}(a[b]);d["pushSet"+c]=function(f){return function(g,j){return this._push(f,g,j)._set(f,g)}}(a[b]);d["back"+c]=function(f){return function(g){return this._back(f,g||"")}}(a[b]);d["back"+c+"If"]=function(f){return function(g){return this._backIf(f,g||"")}}(a[b]);d["drop"+c]=a[b]==="filter"||a[b]==="parser"?function(f){return function(){return this._drop(f,arguments)}}(a[b]):function(f){return function(){return this._drop(f,arguments,null)}}(a[b]);if(a[b]==="filter"||a[b]==="parser")d["reset"+c]=
function(f){return function(){return this._reset(f,arguments)}}(a[b]);else if(a[b]==="page")d["reset"+c]=function(f){return function(){return this._reset(f,arguments,1)}}(a[b]);else if(a[b]==="context")d["reset"+c]=function(f){return function(){return this._reset(f,arguments,"")}}(a[b]);d["is"+c]=function(f){return function(g){return this._is(f,g)}}(a[b]);d["exist"+c]=function(f){return function(g){return this._exist(f,g||"")}}(a[b]);d["get"+c]=function(f){return function(g){return this._get(f,g||
"")}}(a[b])}})(e.Collection.fn.stack);e.Collection.fn.set=function(a,b,d){a=e.isExist(a)?a.toString():"";b=b===undefined?"":b;d=d||"";var c=this.getActiveParam("context").toString();if(!a&&!c)return d&&d!==this.ACTIVE?this._push("collection",d,b):this._update("collection",b);nimble.byLink(this._get("collection",d),c+nimble.CHILDREN+a,b);return this};e.Collection.fn.get=function(a,b){a=e.isExist(a)?a.toString():"";return nimble.byLink(this._get("collection",b||""),this.getActiveParam("context").toString()+
nimble.CHILDREN+a)};e.Collection.fn.add=function(a,b,d,c,f){a=a!==undefined?a:"";b=b||"push";f=f||false;var g,j,h;g=nimble.byLink(this._get("collection",d||""),this.getActiveParam("context").toString());if(typeof g==="object"){h=e.isPlainObject(g);if(c){a=e.isExist(a)?a.toString():"";j=nimble.byLink(this._get("collection",c||""),a);if(h===true){b=b==="push"?this.length(g):b==="unshift"?this.length(g)+nimble.METHOD_SEPARATOR+"unshift":b;h=nimble.addElementToObject(g,b.toString(),j)}else{h=true;g[b](j)}f===
true&&this.disable("context").deleteElementByLink(a,c).enable("context")}else if(h===true){b=b==="push"?this.length(g):b==="unshift"?this.length(g)+nimble.METHOD_SEPARATOR+"unshift":b;h=nimble.addElementToObject(g,b.toString(),a)}else{h=true;g[b](a)}if(h!==true)this.set("",h,d||"")}else throw Error("unable to set property!");return this};e.Collection.fn.push=function(){for(var a=-1,b=arguments.length;++a<b;)this.add(arguments[a]);return this};e.Collection.fn.unshift=function(){for(var a=arguments.length;a--;)this.add(arguments[a],
"unshift");return this};e.Collection.fn.deleteElementByLink=function(a,b){a=e.isExist(a)?a.toString():"";var d=this.getActiveParam("context").toString();!a&&!d?this.set("",null):nimble.byLink(this._get("collection",b||""),d+nimble.CHILDREN+a,"",true);return this};e.Collection.fn.deleteElementsByLink=function(a,b){b=b||"";var d,c;if(e.isPlainObject(a))for(d in a){if(a.hasOwnProperty(d))if(e.isArray(a[d]))for(c=a[d].length;c--;)this.deleteElementByLink(a[d][c],d);else this.deleteElementByLink(a[d],
d)}else if(e.isArray(a))for(c=a.length;c--;)this.deleteElementByLink(a[c],b);else this.deleteElementByLink(a,b);return this};e.Collection.fn.pop=function(){return this.deleteElementByLink("eq(-1)")};e.Collection.fn.shift=function(){return this.deleteElementByLink("eq(0)")};e.Collection.fn.concat=function(a,b,d){b=e.isExist(b)?b.toString():"";d=d||"";var c=nimble.byLink(this._get("collection",d),this.getActiveParam("context").toString()+nimble.CHILDREN+b);if(typeof c==="object")if(e.isPlainObject(c))e.extend(true,
c,a);else{if(e.isArray(c))if(e.isArray(a)){c=Array.prototype.concat(c,a);this.set(b,c,d)}else this.add(a,"push",d)}else throw Error("incorrect data type!");return this};e.Collection.fn.length=function(a,b){a=e.isExist(a)?a:false;var d=this.dObj,c,f,g;if(!e.isFunction(a))if(e.isString(a)&&!e.isExist(b)||e.isArray(a)||e.isPlainObject(a)){b=a;a=false}if(!b||b===this.ACTIVE)d=d.active.collection;else if(e.isString(b))d=d.sys.tmpCollection[b];else{c=true;d=b}if(d===null)return 0;if(c!==true)d=nimble.byLink(d,
this.getActiveParam("context").toString());c=d.length;if(e.isString(d))return c;if(typeof d==="object")if(a===false&&c!==undefined)g=c;else{g=0;for(f in d)if(d.hasOwnProperty(f))if(this.customFilter(a,d,f,c||null,this,b?b:this.ACTIVE)===true)g++}else throw Error("incorrect data type!");return g};e.Collection.fn.each=function(a,b,d,c,f,g,j){a=e.isFunction(a)?{filter:a}:a;b=e.isExist(b)?b:this.ACTIVE;d=e.isExist(d)?d:this.ACTIVE;if(e.isBoolean(d)){j=g;g=f;f=c;c=d;d=this.ACTIVE}c=c===false?false:true;
f=parseInt(f)>=0?parseInt(f):false;g=parseInt(g)||false;j=parseInt(j)||false;var h=this.dObj,k,l,m=0;h=nimble.byLink(d!==this.ACTIVE?h.sys.tmpCollection[d]:h.active.collection,this.getActiveParam("context").toString());k=this.length(h);if(e.isArray(h))for(l=j!==false?j-1:-1;++l<k;){if(f!==false&&m===f)break;if(a.full&&a.full.call(a.full,h,l,k,this,d)===false)break;if(this.customFilter(b,h,l,k,this,d)===true)if(g!==false&&g!==0)g--;else{if(a.filter&&a.filter.call(a.filter,h,l,k,this,d)===false)break;
if(c===false)break;m++}else if(a.denial&&a.denial.call(a.denial,h,l,k,this,d)===false)break}else for(l in h)if(h.hasOwnProperty(l)){if(f!==false&&m===f)break;if(j!==false&&j!==0)j--;else{if(a.full&&a.full.call(a.full,h,l,k,this,d)===false)break;if(this.customFilter(b,h,l,k,this,d)===true)if(g!==false&&g!==0)g--;else{if(a.filter&&a.filter.call(a.filter,h,l,k,this,d)===false)break;if(c===false)break;m++}}}else if(a.denial&&a.denial.call(a.denial,h,l,k,this,d)===false)break;return this};e.Collection.fn.searchElements=
function(a,b,d,c,f,g){a=e.isExist(a)?a:this.ACTIVE;b=e.isExist(b)?b:this.ACTIVE;if(e.isBoolean(b)){g=f;f=c;c=d;d=b;b=this.ACTIVE}d=d===false?false:true;c=parseInt(c)>=0?parseInt(c):false;f=parseInt(f)||false;g=parseInt(g)||false;var j=[];this.each(function(h,k){if(d===true)j.push(k);else{j=k;return false}return true},a,b,d,c,f,g);return j};e.Collection.fn.searchElement=function(a,b){return this.searchElements(a||"",b||"",false)};e.Collection.fn.returnElements=function(a,b,d,c,f,g){a=e.isExist(a)?
a:this.ACTIVE;b=e.isExist(b)?b:this.ACTIVE;if(e.isBoolean(b)){g=f;f=c;c=d;d=b;b=this.ACTIVE}d=d===false?false:true;c=parseInt(c)>=0?parseInt(c):false;f=parseInt(f)||false;g=parseInt(g)||false;var j=[];this.each(function(h,k){if(d===true)j.push(h[k]);else{j=h[k];return false}return true},a,b,d,c,f,g);return j};e.Collection.fn.returnElement=function(a,b){return this.returnElements(a||"",b||"",false)};e.Collection.fn.replaceElements=function(a,b,d,c,f,g,j){a=e.isExist(a)?a:this.ACTIVE;d=e.isExist(d)?
d:this.ACTIVE;if(e.isBoolean(d)){j=g;g=f;f=c;c=d;d=this.ACTIVE}c=c===false?false:true;f=parseInt(f)>=0?parseInt(f):false;g=parseInt(g)||false;j=parseInt(j)||false;var h=e.isFunction(b);this.each(function(k,l,m,n,p){if(h)b.call(b,k,l,m,n,p);else k[l]=nimble.expr(b,k[l]);return true},a,d,c,f,g,j);return this};e.Collection.fn.replaceElement=function(a,b,d){return this.replaceElements(a||"",b,d||"",false)};e.Collection.fn.moveElements=function(a,b,d,c,f,g,j,h,k,l){a=e.isExist(a)?a:this.ACTIVE;l=l===false?
false:true;b=e.isExist(b)?b.toString():"";d=d||"";c=c||"";f=f||"push";g=g===false?false:true;j=parseInt(j)>=0?parseInt(j):false;h=parseInt(h)||false;k=parseInt(k)||false;var m=[],n=e.isArray(nimble.byLink(this._get("collection",c),this.getActiveParam("context").toString())),p=-1;this.disable("context");a=this.searchElements(a,d,g,j,h,k);this.enable("context");if(g===true)for(g=a.length;++p<g;){this.add(b+nimble.CHILDREN+a[p],n===true?f:a[p]+nimble.METHOD_SEPARATOR+f,c,d);l===true&&m.push(a[p])}else{this.add(b+
nimble.CHILDREN+a,n===true?f:a+nimble.METHOD_SEPARATOR+f,c,d);l===true&&m.push(a)}l===true&&this.disable("context").deleteElementsByLink(m,d).enable("context");return this};e.Collection.fn.moveElement=function(a,b,d,c,f){return this.moveElements(a||"",e.isExist(b)?b.toString():"",d||"",c||"",f||"",false)};e.Collection.fn.copyElements=function(a,b,d,c,f,g,j,h,k){g=g===false?false:true;j=parseInt(j)>=0?parseInt(j):false;h=parseInt(h)||false;k=parseInt(k)||false;return this.moveElements(a||"",e.isExist(b)?
b.toString():"",d||"",c||"",f||"push",g,j,h,k,false)};e.Collection.fn.copyElement=function(a,b,d,c,f){return this.moveElements(a||"",e.isExist(b)?b.toString():"",d||"",c||"",f||"",false,"","","",false)};e.Collection.fn.deleteElements=function(a,b,d,c,f,g){a=e.isExist(a)?a:this.ACTIVE;b=e.isExist(b)?b:this.ACTIVE;if(e.isBoolean(b)){g=f;f=c;c=d;d=b;b=this.ACTIVE}d=d===false?false:true;c=parseInt(c)>=0?parseInt(c):false;f=parseInt(f)||false;g=parseInt(g)||false;a=this.searchElements(a,b,d,c,f,g);if(d===
false)this.deleteElementByLink(a,b);else for(d=a.length;d--;)this.deleteElementByLink(a[d],b);return this};e.Collection.fn.deleteElement=function(a,b){return this.deleteElements(a||"",b||"",false)};e.Collection.fn.customFilter=function(a,b,d,c,f,g){var j=this.dObj,h=j.active;j=j.sys;var k,l,m,n=true,p,r,q,o=-1;if(a===false)return true;if(e.isFunction(a))return a.call(a,b,d,c,f,g);if(!a||e.isString(a)&&e.trim(a)===this.ACTIVE){if(h.filter)return h.filter.call(h.filter,b,d,c,f,g);return true}else{if(!e.isArray(a)){if(a.search(/\|\||&&|!|\(|\)/)===
-1)return j.tmpFilter[a].call(j.tmpFilter[a],b,d,c,f,g);a=e.trim(a.toString().replace(/\s*(\(|\))\s*/g," $1 ").replace(/\s*(\|\||&&)\s*/g," $1 ").replace(/(!)\s*/g,"$1")).split(" ")}l=function(s,v){for(var t=-1,x=s.length,u=0,w=[];++t<x;){v++;s[t]==="("&&u++;if(s[t]===")")if(u===0)return{result:w,iter:v};else u--;w.push(s[t])}};for(k=a.length;++o<k;)if(a[o]==="("||a[o]==="!("){if(a[o].substring(0,1)==="!"){q=true;a[o]=a[o].substring(1)}else q=false;m=l(a.slice(o+1),o);o=m.iter;m=this.customFilter(m.result,
b,d,c,f,g);n=!p&&!r?q===true?!m:m:p?q===true?!m:m&&n:q===true?!m:m||n}else if(a[o]!==")"&&a[o]!=="||"&&a[o]!=="&&"){if(a[o].substring(0,1)==="!"){q=true;a[o]=a[o].substring(1)}else q=false;m=a[o]===this.ACTIVE?h.filter:j.tmpFilter[a[o]];m=m.call(m,b,d,c,f,g);n=!p&&!r?q===true?!m:m:p?q===true?!m:m&&n:q===true?!m:m||n}else if(a[o]==="||"){p=false;r=true}else if(a[o]==="&&"){r=false;p=true}return n}};e.Collection.fn.customParser=function(a,b){var d=this.dObj,c=d.active;d=d.sys;var f,g;if(a===false)return b;
if(e.isFunction(a))return a.call(a,b,this);if(!a||e.isString(a)&&e.trim(a)===this.ACTIVE){if(c.parser)return c.parser.call(c.parser,b,this)}else{if(e.isString(a)){a=e.trim(a);if(a.search("&&")===-1)return d.tmpParser[a].call(d.tmpParser[a],b,this);a=a.split("&&")}for(g=a.length;g--;){a[g]=e.trim(a[g]);f=a[g]===this.ACTIVE?c.parser:d.tmpParser[a[g]];b=f.call(f,b,this)}}return b};e.Collection.fn.parentContext=function(a,b){a=a||1;var d="",c;d=this._get("collection",b||"").split(nimble.CHILDREN);for(c=
a;c--;)d.splice(-1,1);return d.join(nimble.CHILDREN)};e.Collection.fn.parent=function(a,b){var d=this.dObj,c=d.sys;d=d.active;var f=c.contextID,g=this.parentContext.apply(this,arguments);if(!b||b===this.ACTIVE){if(f)c.tmpContext[f]=g;d.context=g}else{c.tmpContext[b]=g;if(f&&b===f)d.context=g}return this};e.Collection.fn.orderBy=function(a,b,d,c){a=a||null;b=b||false;d=d?d===false?null:d:function(h){if(isNaN(h))return h.toUpperCase();return h};c=c||"";var f,g=function(h){var k=[],l={},m;for(m in h)h.hasOwnProperty(m)&&
k.push(m);k.sort(statObj.sort.sortBy(a,b,d));for(m in k)if(k.hasOwnProperty(m))l[k[m]]=h[k[m]];return l},j=function(h){var k=[],l={},m;for(m in h)h.hasOwnProperty(m)&&k.push({key:m,value:h[m]});k.sort(statObj.sort.sortBy(a===true?"value":"value"+statObj.obj.contextSeparator+a,b,d));for(m in k)if(k.hasOwnProperty(m))l[k[m].key]=k[m].value;return l};f=nimble.byLink(this._get("collection",c),this.getActiveParam("context").toString());if(typeof f==="object")if(e.isArray(f))f.sort(e.Collection.sort.sortBy(a,
b,d));else{f=a?j.call(this,f):g.call(this,f);this.set("",f,c||"")}else throw Error("incorrect data type!");return this};e.Collection.fn.toString=function(a,b,d){if(a&&(e.isArray(a)||e.isPlainObject(a))){if(JSON&&JSON.stringify)return JSON.stringify(a,b||"",d||"");throw Error("object JSON is not defined!");}a=nimble.byLink(this._get("collection",a||""),this.getActiveParam("context").toString());if(JSON&&JSON.stringify)return JSON.stringify(a,b||"",d||"");throw Error("object JSON is not defined!");
};e.Collection.fn.valueOf=function(a){return this.length(e.isExist(a)?a:this.ACTIVE)};e.Collection.fn.then=function(a,b){var d=this;arguments.length===1?e.when(d.active("defer")).always(function(){a.apply(d,arguments)}):e.when(d.active("defer")).then(function(){a().apply(d,arguments)},function(){b().apply(d,arguments)});return this};e.Collection.fn.print=function(a,b){b=b||false;var d=this.dObj.active,c={},f,g,j,h=0,k,l=null,m="",n;if(e.isString(a)||e.isNumeric(a))a={page:a};else if(e.isBoolean(a))b=
a;e.extend(true,c,d,a);if(a)c.page=nimble.expr(c.page,d.page||"");c.collection=e.isString(c.collection)?this._get("collection",c.collection):c.collection;c.template=e.isString(c.template)?this._get("template",c.template):c.template;k=d.page-c.page;d.page=c.page;n=function(p,r,q,o,s){c.callback&&c.callback.apply(this,arguments);m+=c.template.call(c.template,p,r,q,o,s);h=r;return true};f=nimble.byLink(c.collection,this.getActiveParam("context").toString()+nimble.CHILDREN+(a&&a.context||""));g=this.length();
c.numberBreak=!b||c.numberBreak===false?g:c.numberBreak;if(e.isPlainObject(f)||c.cache.iteration===false||c.cache.firstIteration===false||c.cache.lastIteration===false){j=!b||c.page===1?0:(c.page-1)*c.numberBreak;this.each(n,c.filter,this.ACTIVE,true,c.numberBreak,j)}else if(e.isArray(f)&&c.cache.iteration===true){j=!b||c.filter===false?c.page===1?0:(c.page-1)*c.numberBreak:c.cache.iteration===true?k>0?c.cache.firstIteration:c.cache.lastIteration:i;if(k>0&&b===true&&c.filter!==false){for(k*=c.numberBreak;j--;)if(this.customFilter(c.filter,
f,j,g,this,this.ACTIVE)===true)if(h===k)break;else h++;j++;c.cache.lastIteration=j;l=null}else if(k<0&&b===true&&c.filter!==false)l=Math.abs(k)*c.numberBreak-c.numberBreak||null;this.each(n,c.filter,this.ACTIVE,true,c.numberBreak,l,j)}d.cache.firstIteration=c.cache.lastIteration;d.cache.lastIteration=h+1;if(c.cache.autoIteration===true)d.cache.iteration=true;m=!m?c.resultNull:this.customParser(c.parser,m);if(c.target===false){c.variable?this._push("variable",c.variable,m):this._$("variable",m);return this}else c.target[c.appendType](m);
if(!b)return this;c.nmbOfEntries=c.filter!==false?this.length(c.filter):g;c.nmbOfEntriesInPage=c.target.find(c.calculator).length;c.finNumber=c.numberBreak*c.page-(c.numberBreak-c.nmbOfEntriesInPage);if(c.page!==1&&c.nmbOfEntriesInPage===0){c.page="-=1";this.extPrint(c)}else this.easyPage(c);return this};e.Collection.fn.easyPage=function(a){var b="",d=a.nmbOfEntries%a.numberBreak!==0?~~(a.nmbOfEntries/a.numberBreak)+1:a.nmbOfEntries/a.numberBreak,c=function(h,k,l){var m,n="<"+(h.tag||"span")+' data-page="'+
l+'"';if(h.attr)for(m in h.attr)if(h.attr.hasOwnProperty(m))n+=" "+m+'="'+h.attr[m]+'"';if(l===a.page)n+=' class="'+(k&&k.active||"active")+'"';return n+(">"+l+"</"+(h.tag||"span")+">")},f,g=0,j;a.pager.find("[data-ctm]").each(function(){var h=e(this),k=h.data("ctm"),l=k.classes;if(k.nav){if(k.nav==="prev"&&a.page===1||k.nav==="next"&&a.finNumber===a.nmbOfEntries)h.addClass(l&&l.disabled||"disabled");else if(k.nav==="prev"||k.nav==="next")h.removeClass(l&&l.disabled||"disabled");if(k.nav==="pageList"){if(d>
a.pageBreak){for(f=a.page;++f<d;)g++;j=g<a.pageBreak?a.pageBreak-g+1:1;g=0;for(f=a.page-j;++f<d;g++){if(g===a.pageBreak-1&&f!==a.page)break;if(f===a.page)if(g===0&&a.page!==1)b+=c(k,l||"",f-1);else g--;b+=c(k,l||"",f)}}else for(f=0;++f<=d;)b+=c(k,l||"",f);h.html(b)}}else if(k.info){a.nmbOfEntriesInPage===0?h.addClass(l&&l.noData||"noData"):h.removeClass(l&&l.noData||"noData");switch(k.info){case "page":h.html(a.page);break;case "total":h.html(a.nmbOfEntries);break;case "from":h.html((a.page-1)*a.numberBreak+
1);break;case "to":h.html(a.finNumber);break;case "inPage":h.html(a.nmbOfEntriesInPage)}}});return this};e.Collection.fn.genTable=function(a,b,d){a=a||4;b=b||"div";d=d===false?false:true;var c=1,f,g=this.dObj.active.target,j=g.find(b).length,h="";g.find(b).each(function(k){this.tagName!=="td"&&e(this).wrap("<td></td>");if(c===a){h="";for(f=-1;++f<a;){h+="td:eq("+(k-f)+")";if(f!==a-1)h+=","}g.find(h).wrapAll("<tr></tr>");c=0}else if(k===j-1&&c!==a){h="";for(f=-1;++f<c;){h+="td:eq("+(k-f)+")";if(f!==
c-1)h+=","}c--;g.find(h).wrapAll("<tr></tr>");if(d===true){for(h="";++c<a;)h+="<td></td>";g.find("tr:last").append(h)}}c++});g[0].tagName!=="table"&&g.children("tr").wrapAll("<table></table>");return this}})(jQuery);
//