/**
 * $.Collection
 * 
 * autor: kobezzza (kobezzza@gmail.com | http://kobezzza.com)
 * version: 3.2.5
 * date: 22.12.2011 20:08:43
 */
 (function(f){f.Collection=function(a,b){a=a||null;b=b||null;if(this.fn&&(!this.fn.name||this.fn.name!=="$.Collection"))return new f.Collection(a,b);f.extend(true,this,f.Collection.storage);var d=this.dObj.active;b&&f.extend(true,d,b);if(f.isString(a)){d.target=f(a);d.collection=null}else d.collection=a};f.Collection.fn=f.Collection.prototype={name:"$.Collection",version:"3.2.5",collection:function(){return this.name+" "+this.version},config:{constants:{active:"active",contextSeparator:"~",subcontextSeparator:"#",
methodSeparator:"::",querySeparator:"/",subquerySeparator:"{"}},stack:["collection","filter","context","cache","index","map","variable","defer","page","parser","appendType","target","calculator","pager","template","templateModel","numberBreak","pageBreak","resultNull"],getActiveContext:function(){return this.dObj.sys.flags.use.ac===true?this.dObj.active.context.toString():""},enable:function(a){this.dObj.sys.flags.use[a]=true;return this},disable:function(a){this.dObj.sys.flags.use[a]=false;return this},
toggle:function(a){if(this.dObj.sys.flags.use[a]===true)return this.disable(a);return this.enable(a)}};f.Collection.templateModels={};f.Collection.obj={constants:f.Collection.fn.config.constants,expr:function(a,b){b=b!==undefined||b!==null?b:"";if(f.isString(a)&&a.search(/^[+-\\*/]{1}=/)!==-1){a=a.split("=");isNaN(a[1])||(a[1]=+a[1]);switch(a[0]){case "+":a=b+a[1];break;case "-":a=b-a[1];break;case "*":a=b*a[1];break;case "/":a=b/a[1]}}return a},getByLink:function(a,b){b=b.toString().split(this.constants.contextSeparator);
for(var d,c=-1,g,e,h=b.length-1;c++<h;){b[c]=f.trim(b[c]);if(b[c]&&b[c]!==this.constants.subcontextSeparator)if(b[c].search(this.constants.subcontextSeparator)===-1)a=a[b[c]];else{g=+b[c].replace(this.constants.subcontextSeparator,"");if(f.isArray(a))a=g>=0?a[g]:a[a.length+g];else{if(g<0){e=0;for(d in a)a.hasOwnProperty(d)&&e++;g+=e}e=0;for(d in a)if(a.hasOwnProperty(d)){if(g===e){a=a[d];break}e++}}}}return a},setByLink:function(a,b,d){b=b.toString().split(this.constants.contextSeparator);var c,g,
e,h,j=b.length;for(g=j;g--;){b[g]=f.trim(b[g]);if(b[g]===""||b[g]===this.constants.subcontextSeparator)b.splice(g,1)}j=b.length-1;for(g=-1;g++<j;)if(b[g].search(this.constants.subcontextSeparator)===-1)if(g===j)a[b[g]]=this.expr(d,a[b[g]]);else a=a[b[g]];else{e=+b[g].replace(this.constants.subcontextSeparator,"");if(f.isArray(a))if(g===j)if(e>=0)a[e]=this.expr(d,a[e]);else a[a.length+e]=d;else a=e>=0?a[e]:this.expr(d,a[a.length+e]);else{if(e<0){h=0;for(c in a)a.hasOwnProperty(c)&&h++;e+=h}h=0;for(c in a)if(a.hasOwnProperty(c)){if(e===
h){if(g===j)a[c]=this.expr(d,a[c]);else a=a[c];break}h++}}}return this},execEvent:function(a,b,d,c){d=f.isExist(d)?d:[];d=f.isArray(d)?d:[d];a=a.split(this.constants.querySeparator);for(var g=-1,e=a.length-2;g++<e;)b=b[a[g]];if(a[g].search(this.constants.subquerySeparator)!==-1){a=a[g].split(this.constants.subquerySeparator);b=b[a[0]];a.splice(0,1);d=d.concat(a);b.apply(c||b,d)}else b[a[g]].apply(c||b,d);return this},addElementToObject:function(a,b,d){b=b.split(this.constants.methodSeparator);var c,
g={};if(b[1]&&b[1]=="unshift"){g[b[0]]=d;for(c in a)if(a.hasOwnProperty(c))g[c]=a[c];return g}else if(!b[1]||b[1]=="push")a[b[0]]=d;return true}};f.Collection.sort={field:null,rev:false,shuffle:false,fn:null,sortBy:function(a,b,d){this.field=a||null;this.rev=b?b!=="shuffle"?b:false:false;this.shuffle=b?b==="shuffle"?b:false:false;this.fn=d||null;return this.sortHelper},sortHelper:function(a,b){var d=f.Collection,c=d.sort,g=c.shuffle?Math.round(Math.random()*2-1):c.rev?c.rev===true?-1:1:1;if(c.field){a=
d.obj.getByLink(a,c.field);b=d.obj.getByLink(b,c.field)}if(c.fn){a=c.fn(a);b=c.fn(b)}if(c.shuffle)return g;else{if(a<b)return g*-1;if(a>b)return g;return 0}}};f.fn.collection=function(a){var b=f.fn.collection.stat,d=function(g){var e=[];g.each(function(h){var j=f(this),k=j.data(),l=j.attr("class")?j.attr("class").split(" "):"",m=l?l.length:0,n;n=j[0];n=n.childNodes;for(var o=n.length-1,r=-1,s="";r++<o;)if(n[r].nodeType===3&&f.trim(n[r].textContent))s+=n[r].textContent;n=s?s:false;var p;e.push({});
for(p in k)if(k.hasOwnProperty(p))e[h][p]=k[p];if(m){m--;e[h][b.classes]={};for(p=-1;p++<m;)e[h][b.classes][l[p]]=l[p]}if(j.children().length!==0)e[h][b.childNodes]=d(j.children());if(n!==false)e[h][b.val]=n.replace(/[\r\t\n]/g," ")});return e},c=d(this);if(a)return new f.Collection(c,a);return new f.Collection(c)};if(!f.fn.collection.stat)f.fn.collection.stat={val:"val",childNodes:"childNodes",classes:"classes"};f.fn.tplCompile=function(){if(this.length===0)throw Error("DOM element isn't exist!");
for(var a=this.html().replace(/\/\*.*?\*\//g,"").split("?>").join("<?js").replace(/[\r\t\n]/g," ").split("<?js"),b=a.length-1,d="var key = i, result = ''; ",c=-1;c++<b;)d+=c===0||c%2===0?"result +='"+a[c]+"';":a[c].split("echo").join("result +=");return new Function("data","i","cOLength","self","id",d+" return result;")};f.isString=function(a){return Object.prototype.toString.call(a)==="[object String]"};f.isBoolean=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"};f.isExist=
function(a){return a!==undefined&&a!=="undefined"&&a!==null&&a!==""};f.unshiftArguments=function(a,b){for(var d=[b],c=0,g=a.length;c<g;c++)d.push(a[c]);return d};f.toUpperCase=function(a,b,d){d=d||0;if(!b)return a.toUpperCase();return a.substring(d,b).toUpperCase()+a.substring(b)};f.toLowerCase=function(a,b,d){d=d||0;if(!b)return a.toLowerCase();return a.substring(d,b).toLowerCase()+a.substring(b)};f.Collection.templateModels.simple=function(a){var b=this.dObj,d=b.viewVal;b=b.css;a.finNumber===a.nmbOfEntries?
f("."+b.next,a.pager).addClass(b.disabled):f("."+b.next+"."+b.disabled,a.pager).removeClass(b.disabled);a.page===1?f("."+b.prev,a.pager).addClass(b.disabled):f("."+b.prev+"."+b.disabled,a.pager).removeClass(b.disabled);a.nmbOfEntriesInPage===0?f("."+b.info,a.pager).empty():f("."+b.info,a.pager).text((a.page-1)*a.numberBreak+1+"-"+a.finNumber+" "+d.from+" "+a.nmbOfEntries);return true};f.Collection.templateModels.control=function(a){var b=this.dObj,d=b.viewVal;b=b.css;var c=a.nmbOfEntries%a.numberBreak!==
0?~~(a.nmbOfEntries/a.numberBreak)+1:a.nmbOfEntries/a.numberBreak,g="",e,h=0;if(c>a.pageBreak){g+=a.page!==1?'<a href="javascript:;" class="'+b.prev+'" data-page="1">'+d.prev+"</a>":'<a href="javascript:;" class="'+b.prev+" "+b.disabled+'" data-page="1">'+d.prev+"</a>";for(e=a.page-1;e++<c;)h++;e=h<a.pageBreak?a.pageBreak-h+1:1;h=0;for(e=a.page-e;e++<c;h++){if(h===a.pageBreak-1&&e!==a.page)break;if(e===a.page){if(h===0&&a.page!==1)g+='<a href="javascript:;" data-page="'+(e-1)+'">'+(e-1)+"</a>";else h--;
g+='<a href="javascript:;" class="'+b.active+'" data-page="'+e+'">'+e+"</a>"}else g+='<a href="javascript:;" data-page="'+e+'">'+e+"</a>"}g+=e!==c+1?'<a href="javascript:;" data-page="'+c+'">'+d.next+"</a>":'<a href="javascript:;" class="'+b.next+" "+b.disabled+'" data-page="'+c+'">'+d.next+"</a>"}else for(e=0;e++<c;)g+=e===a.page?'<a href="javascript:;" class="'+b.active+'" data-page="'+e+'">'+e+"</a>":'<a href="javascript:;" data-page="'+e+'">'+e+"</a>";if(a.nmbOfEntries===0)f("."+b.nav+",."+b.info,
a.pager).empty();else{f("."+b.nav,a.pager).html(g);f("."+b.info,a.pager).text(d.total+": "+a.nmbOfEntries+". "+d.show+": "+((a.page-1)*a.numberBreak+1)+"-"+a.finNumber)}return true};f.Collection.storage={dObj:{active:{collection:null,filter:false,context:"",cache:{autoIteration:false,iteration:false,firstIteration:false,lastIteration:false},index:null,map:null,variable:null,defer:"",page:1,parser:false,appendType:"html",target:null,calculator:".line",pager:"#pageControl",template:null,templateModel:f.Collection.templateModels.simple,
numberBreak:10,pageBreak:10,resultNull:false}}};f.Collection.storage.dObj.sys={flags:{use:{ac:true}}};(function(a){var b,d,c=f.Collection.storage.dObj.sys;for(b=a.length;b--;){d=f.toUpperCase(a[b],1);c["active"+d+"ID"]=null;c["tmp"+d]={};c[a[b]+"ChangeControl"]=null;c[a[b]+"Back"]=[]}})(f.Collection.fn.stack);f.Collection.storage.dObj.viewVal={prev:"&lt;&lt;",next:"&gt;&gt;",total:"total",show:"show",from:"from",noResult:"nothing was found"};f.Collection.storage.dObj.css={prev:"prev",next:"next",
disabled:"disabled",active:"active",nav:"nav",info:"info",noResult:"noResult"};f.Collection.fn._$=function(a,b){var d=this.dObj,c=d.active,g=f.toUpperCase(a,1);c[a]=f.Collection.obj.expr(b,c[a]||"");d.sys["active"+g+"ID"]=null;return this};f.Collection.fn._update=function(a,b){var d=this.dObj,c=d.active;d=d.sys;var g=f.toUpperCase(a,1),e=d["active"+g+"ID"];c[a]=f.Collection.obj.expr(b,c[a]||"");if(e)d["tmp"+g][e]=c[a];return this};f.Collection.fn._get=function(a,b){var d=this.dObj;if(b&&b!==this.config.constants.active)return d.sys["tmp"+
f.toUpperCase(a,1)][b];return d.active[a]};f.Collection.fn._push=function(a,b,d){var c=this.dObj.sys,g=f.toUpperCase(a,1),e=c["tmp"+g];c=c["active"+g+"ID"];var h;if(f.isPlainObject(b))for(h in b){if(b.hasOwnProperty(h))if(h===this.config.constants.active)throw Error("invalid property name!");else if(e[h]&&c&&c===h)this._update(a,b[h]);else e[h]=b[h]}else if(b===this.config.constants.active)throw Error("invalid property name!");else if(e[b]&&c&&c===b)this._update(a,d);else e[b]=d;return this};f.Collection.fn._set=
function(a,b){var d=this.dObj,c=d.sys,g=f.toUpperCase(a,1),e=a+"ChangeControl",h="active"+g+"ID";if(c[h]!==b){c[e]=true;c[h]=b}else c[e]=false;c[a+"Back"].push(b);d.active[a]=c["tmp"+g][b];return this};f.Collection.fn._back=function(a,b){var d=this.dObj,c=d.sys,g=f.toUpperCase(a,1),e=c[a+"Back"],h;c[a+"ChangeControl"]=false;h=e.length-(b||1)-1;if(h>=0&&e[h])if(c["tmp"+g][e[h]]){c["active"+g+"ID"]=e[h];d.active[a]=c["tmp"+g][e[h]];e.splice(h+1,e.length)}return this};f.Collection.fn._backIf=function(a){if(this.dObj.sys[a+
"ChangeControl"]===true)return this._back.apply(this,arguments);return this};f.Collection.fn._drop=function(a,b,d){d=d===undefined?false:d;var c=this.dObj,g=c.active;c=c.sys;var e=f.toUpperCase(a,1),h="active"+e+"ID";e="tmp"+e;var j=c[h];b=!b?j?[j]:[]:f.isArray(b)||f.isPlainObject(b)?b:[b];var k;if(b[0]&&b[0]!==this.config.constants.active)for(k in b){if(b.hasOwnProperty(k))if(!b[k]||b[k]===this.config.constants.active){j&&delete c[e][j];c[h]=null;g[a]=d}else{delete c[e][b[k]];if(j&&b[k]===j){c[h]=
null;g[a]=d}}}else{j&&delete c[e][j];c[h]=null;g[a]=d}return this};f.Collection.fn._reset=function(a,b,d){d=d===undefined?false:d;var c=this.dObj,g=c.active;c=c.sys;var e=f.toUpperCase(a,1),h="tmp"+e;e=c["active"+e+"ID"];b=!b?e?[e]:[]:f.isArray(b)||f.isPlainObject(b)?b:[b];var j;if(b[0]&&b[0]!==this.config.constants.active)for(j in b){if(b.hasOwnProperty(j))if(!b[j]||b[j]===this.config.constants.active){if(e)c[h][e]=d;g[a]=d}else{c[h][b[j]]=d;if(e&&b[j]===e)g[a]=d}}else{if(e)c[h][e]=d;g[a]=d}return this};
f.Collection.fn._resetTo=function(a,b,d){var c=this.dObj;d=!d||d===this.config.constants.active?c.active[a]:c.sys["tmp"+f.toUpperCase(a,1)][d];return this._reset(a,b||"",d)};f.Collection.fn._exist=function(a,b){var d=this.dObj,c=f.toUpperCase(a,1);if((!b||b===this.config.constants.active)&&d.sys["active"+c+"ID"])return true;if(d.sys["tmp"+c][b]!==undefined)return true;return false};f.Collection.fn._is=function(a,b){if(b===this.dObj.sys["active"+f.toUpperCase(a,1)+"ID"])return true;return false};f.Collection.fn.use=
function(a){for(var b=this.stack.length;b--;)this._exist(this.stack[b],a)&&this._set(this.stack[b],a);return this};f.Collection.fn._prop=function(a,b,d){var c=this.dObj[a];if(arguments.length!==3)if(f.isPlainObject(b))f.extend(c,b);else return c[b];else c[b]=d;return this};f.Collection.fn.active=function(){return this._prop.apply(this,f.unshiftArguments(arguments,"active"))};f.Collection.fn.css=function(){return this._prop.apply(this,f.unshiftArguments(arguments,"css"))};f.Collection.fn.viewVal=function(){return this._prop.apply(this,
f.unshiftArguments(arguments,"viewVal"))};(function(a){var b,d=f.Collection.fn,c;for(b=a.length;b--;){c=a[b]!=="collection"?f.toUpperCase(a[b],1):"";d["$"+c]=function(g){return function(e){return this._$(g,e)}}(a[b]);d["update"+c]=function(g){return function(e){return this._update(g,e)}}(a[b]);d["reset"+c+"To"]=function(g){return function(e,h){return this._resetTo(g,e,h)}}(a[b]);d["push"+c]=function(g){return function(){return this._push.apply(this,f.unshiftArguments(arguments,g))}}(a[b]);d["set"+
c]=function(g){return function(e){return this._set(g,e)}}(a[b]);d["pushSet"+c]=function(g){return function(e,h){return this._push(g,e,h)._set(g,e)}}(a[b]);d["back"+c]=function(g){return function(e){return this._back(g,e||"")}}(a[b]);d["back"+c+"If"]=function(g){return function(e){return this._backIf(g,e||"")}}(a[b]);d["drop"+c]=a[b]==="filter"||a[b]==="parser"?function(g){return function(){return this._drop(g,arguments)}}(a[b]):function(g){return function(){return this._drop(g,arguments,null)}}(a[b]);
if(a[b]==="filter"||a[b]==="parser")d["reset"+c]=function(g){return function(){return this._reset(g,arguments)}}(a[b]);else if(a[b]==="page")d["reset"+c]=function(g){return function(){return this._reset(g,arguments,1)}}(a[b]);else if(a[b]==="context")d["reset"+c]=function(g){return function(){return this._reset(g,arguments,"")}}(a[b]);d["is"+c]=function(g){return function(e){return this._is(g,e)}}(a[b]);d["exist"+c]=function(g){return function(e){return this._exist(g,e||"")}}(a[b]);d["get"+c]=function(g){return function(e){return this._get(g,
e||"")}}(a[b])}})(f.Collection.fn.stack);f.Collection.fn.setElement=function(a,b,d){a=f.isExist(a)?a.toString():"";b=b===undefined?"":b;var c=this.config.constants,g=this.dObj,e=this.getActiveContext();if(!a&&!e)return d&&d!==c.active?this._push("collection",d,b):this._update("collection",b);f.Collection.obj.setByLink(d&&d!==c.active?g.sys.tmpCollection[d]:g.active.collection,e+c.contextSeparator+a,b);return this};f.Collection.fn.getElement=function(a,b){a=f.isExist(a)?a.toString():"";var d=this.config.constants,
c=this.dObj;return f.Collection.obj.getByLink(b&&b!==d.active?c.sys.tmpCollection[b]:c.active.collection,this.getActiveContext()+d.contextSeparator+a)};f.Collection.fn.addElement=function(a,b,d,c,g){a=a!==undefined?a:"";b=b||"push";g=g===true?true:false;var e=this.config.constants,h=f.Collection.obj,j=this.dObj,k=j.active,l=j.sys,m;j=h.getByLink(d&&d!==e.active?l.tmpCollection[d]:k.collection,this.getActiveContext());if(typeof j==="object"){m=f.isPlainObject(j);if(c){a=f.isExist(a)?a.toString():"";
k=h.getByLink(c===e.active?k.collection:l.tmpCollection[c],a);if(m===true){b=b==="push"?this.length(j):b==="unshift"?this.length(j)+e.methodSeparator+"unshift":b;e=h.addElementToObject(j,b.toString(),k)}else{e=true;if(b==="push")j.push(k);else b==="unshift"&&j.unshift(k)}if(g===true){this.config.flags.use.ac=false;this.deleteElementByLink(a,c);this.config.flags.use.ac=true}}else if(m===true){b=b==="push"?this.length(j):b==="unshift"?this.length(j)+e.methodSeparator+"unshift":b;e=h.addElementToObject(j,
b.toString(),a)}else{e=true;if(b==="push")j.push(a);else b==="unshift"&&j.unshift(a)}if(e!==true)this.setElement("",e,d||"")}else throw Error("unable to set property!");return this};f.Collection.fn.deleteElementByLink=function(a,b){a=f.isExist(a)?a.toString():"";var d=this.config.constants,c=this.dObj,g,e=0;e=0;e=this.getActiveContext();if(!a&&!e)this.setElement("",null);else{a=(e+d.contextSeparator+a).split(d.contextSeparator);for(e=a.length;e--;){a[e]=f.trim(a[e]);if(a[e]===""||a[e]===d.subcontextSeparator)a.splice(e,
1)}a=a.join(d.contextSeparator);c=f.Collection.obj.getByLink(b&&b!==d.active?c.sys.tmpCollection[b]:c.active.collection,a.replace(RegExp("[^"+d.contextSeparator+"]+$"),""));a=a.replace(RegExp(".*?([^"+d.contextSeparator+"]+$)"),"$1");if(f.isArray(c)){a=+a.replace(d.subcontextSeparator,"");a>=0?c.splice(a,1):c.splice(c.length+a,1)}else if(a.search(d.subcontextSeparator)===-1)delete c[a];else{d=+a.replace(d.subcontextSeparator,"");if(d<0){e=0;for(g in c)c.hasOwnProperty(g)&&e++;d+=e}e=0;for(g in c)if(c.hasOwnProperty(g)){if(d===
e){delete c[g];break}e++}}}return this};f.Collection.fn.deleteElementsByLink=function(a,b){var d,c;if(f.isPlainObject(a))for(d in a){if(a.hasOwnProperty(d))if(f.isArray(a[d]))for(c=a[d].length;c--;)this.deleteElementByLink(a[d][c],d);else this.deleteElementByLink(a[d],d)}else if(f.isArray(a))for(c=a.length;c--;)this.deleteElementByLink(a[c],b||"");else this.deleteElementByLink(a,b||"");return this};f.Collection.fn.concat=function(a,b,d){b=f.isExist(b)?b.toString():"";var c=this.config.constants,g=
this.dObj;c=f.Collection.obj.getByLink(d&&d!==c.active?g.sys.tmpCollection[d]:g.active.collection,this.getActiveContext()+c.contextSeparator+b);if(typeof c==="object")if(f.isPlainObject(c))f.extend(true,c,a);else{if(f.isArray(c))if(f.isArray(a)){c=Array.prototype.concat(c,a);this.setElement(b,c,d||"")}else this.addElement(a,"push",d||"")}else throw Error("incorrect data type!");return this};f.Collection.fn.length=function(a,b){a=f.isExist(a)?a:false;var d=this.dObj,c,g,e;if(!f.isFunction(a))if(f.isString(a)&&
!f.isExist(b)||f.isArray(a)||f.isPlainObject(a)){b=a;a=false}if(!b||b===this.config.constants.active)d=d.active.collection;else if(f.isString(b))d=d.sys.tmpCollection[b];else{c=true;d=b}if(c!==true)d=f.Collection.obj.getByLink(d,this.getActiveContext());if(d===null)return 0;c=d.length;if(f.isString(d))return c;if(typeof d==="object")if(a===false&&c!==undefined)e=c;else{e=0;for(g in d)if(d.hasOwnProperty(g))if(a===false||this.customFilter(a,d,g,c||null,this,b?b:this.config.constants.active)===true)e++}else throw Error("incorrect data type!");
return e};f.Collection.fn.each=function(a,b,d,c,g,e,h){b=b||false;d=f.isExist(d)?d:this.config.constants.active;if(f.isBoolean(d)){h=e;e=g;g=c;c=d;d=this.config.constants.active}c=c===false?false:true;g=parseInt(g)>=0?parseInt(g):false;e=parseInt(e)||false;h=parseInt(h)||false;var j=this.dObj,k=j.active,l=j.sys,m,n;j=0;k=f.Collection.obj.getByLink(d!==this.config.constants.active?l.tmpCollection[d]:k.collection,this.getActiveContext());l=this.length(k);if(f.isArray(k)){m=l-1;for(n=h!==false?h-1:-1;n++<
m;){if(g!==false&&j===g)break;if(b===false||this.customFilter(b,k,n,l,this,d)===true)if(e!==false&&e!==0)e--;else{if(a.call(a,k,n,l,this,d)===false)break;if(c===false)break;j++}}}else for(n in k)if(k.hasOwnProperty(n)){if(g!==false&&j===g)break;if(h!==false&&h!==0)h--;else if(b===false||this.customFilter(b,k,n,l,this,d)===true)if(e!==false&&e!==0)e--;else{if(a.call(a,k,n,l,this,d)===false)break;if(c===false)break;j++}}return this};f.Collection.fn.searchElements=function(a,b,d,c,g,e){a=a||false;b=
f.isExist(b)?b:this.config.constants.active;if(f.isBoolean(b)){e=g;g=c;c=d;d=b;b=this.config.constants.active}d=d===false?false:true;c=parseInt(c)>=0?parseInt(c):false;g=parseInt(g)||false;e=parseInt(e)||false;var h=[];this.each(function(j,k){if(d===true)h.push(k);else{h=k;return false}return true},a,b,d,c,g,e);return h};f.Collection.fn.searchElement=function(a,b){return this.searchElements(a||"",b||"",false)};f.Collection.fn.returnElements=function(a,b,d,c,g,e){a=a||false;b=f.isExist(b)?b:this.config.constants.active;
if(f.isBoolean(b)){e=g;g=c;c=d;d=b;b=this.config.constants.active}d=d===false?false:true;c=parseInt(c)>=0?parseInt(c):false;g=parseInt(g)||false;e=parseInt(e)||false;var h=[];this.each(function(j,k){if(d===true)h.push(j[k]);else{h=j[k];return false}return true},a,b,d,c,g,e);return h};f.Collection.fn.returnElement=function(a,b){return this.returnElements(a||"",b||"",false)};f.Collection.fn.replaceElements=function(a,b,d,c,g,e,h){a=a||false;d=f.isExist(d)?d:this.config.constants.active;if(f.isBoolean(d)){h=
e;e=g;g=c;c=d;d=this.config.constants.active}c=c===false?false:true;g=parseInt(g)>=0?parseInt(g):false;e=parseInt(e)||false;h=parseInt(h)||false;var j=f.isFunction(b);this.each(function(k,l,m,n,o){if(j)b.call(b,k,l,m,n,o);else k[l]=b;return true},a,d,c,g,e,h);return this};f.Collection.fn.replaceElement=function(a,b,d){return this.replaceElements(a||"",b,d||"",false)};f.Collection.fn.moveElements=function(a,b,d,c,g,e,h,j,k,l){a=a||false;l=l===false?false:true;b=f.isExist(b)?b.toString():"";d=d||"";
c=c||"";g=g||"push";e=e===false?false:true;h=parseInt(h)>=0?parseInt(h):false;j=parseInt(j)||false;k=parseInt(k)||false;var m=this.config.constants,n=[],o=f.isArray(f.Collection.obj.getByLink(this._get("collection",c),this.getActiveContext())),r=-1;this.disable("ac");a=this.searchElements(a,d,e,h,j,k);this.enable("ac");if(e===true)for(e=a.length-1;r++<e;){this.addElement(b+m.contextSeparator+a[r],o===true?g:a[r]+m.methodSeparator+g,c,d);l===true&&n.push(a[r])}else{this.addElement(b+m.contextSeparator+
a,o===true?g:a+m.methodSeparator+g,c,d);l===true&&n.push(a)}l===true&&this.disable("ac").deleteElementsByLink(n,d).enable("ac");return this};f.Collection.fn.moveElement=function(a,b,d,c,g){return this.moveElements(a||"",f.isExist(b)?b.toString():"",d||"",c||"",g||"",false)};f.Collection.fn.copyElements=function(a,b,d,c,g,e,h,j,k){e=e===false?false:true;h=parseInt(h)>=0?parseInt(h):false;j=parseInt(j)||false;k=parseInt(k)||false;return this.moveElements(a||"",f.isExist(b)?b.toString():"",d||"",c||
"",g||"push",e,h,j,k,false)};f.Collection.fn.copyElement=function(a,b,d,c,g){return this.moveElements(a||"",f.isExist(b)?b.toString():"",d||"",c||"",g||"",false,"","","",false)};f.Collection.fn.deleteElements=function(a,b,d,c,g,e){a=a||false;b=f.isExist(b)?b:this.config.constants.active;if(f.isBoolean(b)){e=g;g=c;c=d;d=b;b=this.config.constants.active}d=d===false?false:true;c=parseInt(c)>=0?parseInt(c):false;g=parseInt(g)||false;e=parseInt(e)||false;a=this.searchElements(a,b,d,c,g,e);if(d===false)this.deleteElementByLink(a,
b);else for(d=a.length;d--;)this.deleteElementByLink(a[d],b);return this};f.Collection.fn.deleteElement=function(a,b){return this.deleteElements(a||"",b||"",false)};f.Collection.fn.customFilter=function(a,b,d,c,g,e){var h,j=this.config.constants,k=this.dObj,l=k.active;k=k.sys;var m,n,o=true,r,s,p,q=-1;if(f.isFunction(a))return a.call(a,b,d,c,g,e);if(!a||f.isString(a)&&f.trim(a)===j.active){if(l.filter)return l.filter.call(l.filter,b,d,c,g,e);return true}else{if(!f.isArray(a)){if(a.search(/\|\||&&|!|\(|\)/)===
-1)return k.tmpFilter[a].call(k.tmpFilter[a],b,d,c,g,e);a=f.trim(a.toString().replace(/\s*(\(|\))\s*/g," $1 ").replace(/\s*(\|\||&&)\s*/g," $1 ").replace(/(!)\s*/g,"$1")).split(" ")}n=function(t,w){for(var u=-1,y=t.length-1,v=0,x=[];u++<y;){w++;t[u]==="("&&v++;if(t[u]===")")if(v===0)return{result:x,iter:w};else v--;x.push(t[u])}};for(m=a.length-1;q++<m;)if(a[q]==="("||a[q]==="!("){if(a[q].substring(0,1)==="!"){p=true;a[q]=a[q].substring(1)}else p=false;h=n(a.slice(q+1),q);q=h.iter;h=this.customFilter(h.result,
b,d,c,g,e);o=!r&&!s?p===true?!h:h:r?p===true?!h:h&&o:p===true?!h:h||o}else if(a[q]!==")"&&a[q]!=="||"&&a[q]!=="&&"){if(a[q].substring(0,1)==="!"){p=true;a[q]=a[q].substring(1)}else p=false;h=a[q]===j.active?l.filter:k.tmpFilter[a[q]];h=h.call(h,b,d,c,g,e);o=!r&&!s?p===true?!h:h:r?p===true?!h:h&&o:p===true?!h:h||o}else if(a[q]==="||"){r=false;s=true}else if(a[q]==="&&"){s=false;r=true}return o}};f.Collection.fn.customParser=function(a,b){var d=this.dObj,c=d.active;d=d.sys;var g,e;if(f.isFunction(a))return a.call(a,
b,this);if(!a||f.isString(a)&&f.trim(a)===this.config.constants.active){if(c.parser)return c.parser.call(c.parser,b,this)}else{if(f.isString(a)){a=f.trim(a);if(a.search("&&")===-1)return d.tmpParser[a].call(d.tmpParser[a],b,this);a=a.split("&&")}for(e=a.length;e--;){a[e]=f.trim(a[e]);g=a[e]===this.config.constants.active?c.parser:d.tmpParser[a[e]];b=g.call(g,b,this)}}return b};f.Collection.fn.parentContext=function(a,b){a=a||1;var d=this.dObj,c="";c=(b&&b!==this.config.constants.active?d.sys.tmpContext[b]:
d.active.context).split(this.config.constants.contextSeparator);for(d=a;d--;)c.splice(-1,1);return c.join(this.config.constants.contextSeparator)};f.Collection.fn.parent=function(a,b){var d=this.dObj,c=d.sys;d=d.active;var g=c.contextID,e=this.parentContext.apply(this,arguments);if(!b||b===this.config.constants.active){if(g)c.tmpContext[g]=e;d.context=e}else{c.tmpContext[b]=e;if(g&&b===g)d.context=e}return this};f.Collection.fn.orderBy=function(a,b,d,c){a=a||null;b=b||false;d=d?d===false?null:d:function(l){if(isNaN(l))return l.toUpperCase();
return l};c=c||"";var g=f.Collection,e=this.dObj,h=e.sys,j=function(l){var m=[],n={},o;for(o in l)l.hasOwnProperty(o)&&m.push(o);m.sort(g.sort.sortBy(a,b,d));for(o in m)if(m.hasOwnProperty(o))n[m[o]]=l[m[o]];return n},k=function(l){var m=[],n={},o;for(o in l)l.hasOwnProperty(o)&&m.push({key:o,value:l[o]});m.sort(g.sort.sortBy(a===true?"value":"value"+g.obj.contextSeparator+a,b,d));for(o in m)if(m.hasOwnProperty(o))n[m[o].key]=m[o].value;return n};e=g.obj.getByLink(c?h.tmpCollection[c]:e.active.collection,
this.getActiveContext());if(typeof e==="object")if(f.isArray(e))e.sort(g.sort.sortBy(a,b,d));else{e=a?k.call(this,e):j.call(this,e);this.setElement("",e,c||"")}else throw Error("incorrect data type!");return this};f.Collection.fn.toString=function(a,b,d){var c=this.dObj;if(a&&(f.isArray(a)||f.isPlainObject(a))){if(JSON&&JSON.stringify)return JSON.stringify(a,b||"",d||"");throw Error("object JSON is not defined!");}a=a&&a!==this.config.constants.active?c.sys.tmpCollection[a]:c.active.collection;a=
f.Collection.obj.getByLink(a,this.getActiveContext());if(JSON&&JSON.stringify)return JSON.stringify(a,b||"",d||"");throw Error("object JSON is not defined!");};f.Collection.fn.valueOf=function(a){return this.length(f.isExist(a)?a:this.config.constants.active)};f.Collection.fn.then=function(a,b){var d=this;arguments.length===1?f.when(d.active("defer")).always(function(){a.apply(d,arguments)}):f.when(d.active("defer")).then(function(){a().apply(d,arguments)},function(){b().apply(d,arguments)});return this};
f.Collection.fn.print=function(a,b,d,c,g){b=b===false?false:true;d=parseInt(d)>=0?parseInt(d):false;c=parseInt(c)||false;g=parseInt(g)||false;var e=this.dObj,h={},j="";f.extend(true,h,e.active,a);this.each(function(k,l,m,n,o){h.callback&&h.callback.apply(this,arguments);j+=h.template.call(h.template,k,l,m,n,o);if(b!==true)return false;return true},h.filter,this.config.constants.active,b,d,c,g);j=!j?h.resultNull===false?'<div class="'+e.css.noResult+'">'+e.viewVal.noResult+"</div>":h.resultNull:j;
j=h.parser!==false?this.customParser(h.parser,j):j;if(h.target===false)h.variable?this._push("variable",h.variable,j):this.$_("variable",j);else h.target[h.appendType](j);return this};f.Collection.fn.extPrint=function(a){var b=this.dObj,d=b.active,c={},g,e,h=0,j,k=null,l="",m;if(f.isString(a)||f.isNumeric(a))a={page:a};f.extend(true,c,d,a);if(a)c.page=f.Collection.obj.expr(c.page,d.page||"");j=d.page-c.page;d.page=c.page;m=function(n,o,r,s,p){c.callback&&c.callback.apply(this,arguments);l+=c.template.call(c.template,
n,o,r,s,p);h=o;return true};a=f.Collection.obj.getByLink(c.collection,this.getActiveContext());g=this.length();c.numberBreak=c.numberBreak===false?g:c.numberBreak;if(f.isPlainObject(a)||c.cache.iteration===false||c.cache.firstIteration===false||c.cache.lastIteration===false){e=c.page===1?0:(c.page-1)*c.numberBreak;this.each(m,c.filter,this.config.constants.active,true,c.numberBreak,e)}else if(f.isArray(a)&&c.cache.iteration===true){e=c.filter===false?c.page===1?0:(c.page-1)*c.numberBreak:c.cache.iteration===
true?j>0?c.cache.firstIteration:c.cache.lastIteration:i;if(j>0&&c.filter!==false){for(j*=c.numberBreak;e--;)if(this.customFilter(c.filter,a,e,g,this,this.config.constants.active)===true)if(h===j)break;else h++;e++;c.cache.lastIteration=e;k=null}else if(j<0&&c.filter!==false)k=Math.abs(j)*c.numberBreak-c.numberBreak||null;this.each(m,c.filter,this.config.constants.active,true,c.numberBreak,k,e)}d.cache.firstIteration=c.cache.lastIteration;d.cache.lastIteration=h+1;if(c.cache.autoIteration===true)d.cache.iteration=
true;l=!l?c.resultNull===false?'<div class="'+b.css.noResult+'">'+b.viewVal.noResult+"</div>":c.resultNull:l;l=c.parser!==false?this.customParser(c.parser,l):l;c.target[c.appendType](l);f.extend(true,c,{nmbOfEntries:this.length(c.filter),nmbOfEntriesInPage:f(c.calculator,c.target).length});c.finNumber=c.numberBreak*c.page-(c.numberBreak-c.nmbOfEntriesInPage);if(c.page!==1&&c.nmbOfEntriesInPage===0){c.page="-=1";this.extPrint(c)}else this.easyPage(c);return this};f.Collection.fn.easyPage=function(a){this.dObj.active.templateModel.call(this.dObj.active.templateModel,
a,this);return this};f.Collection.fn.genTable=function(a){a=a||4;var b=1,d,c=this.dObj.active.target,g=c.children("td").length-1,e=a-1,h="";c.children("td").each(function(j){if(b===a){h="";for(d=-1;d++<e;){h+="td:eq("+(j-d)+")";if(d!==e)h+=","}c.children(h).wrapAll("<tr></tr>");b=0}else if(j===g&&b!==a){h="";for(d=0;d<b;d++){h+="td:eq("+d+")";if(d!==b-1)h+=","}c.children(h).wrapAll("<tr></tr>");for(h="";b<a;b++)h+="<td></td>";c.children("tr:last").append(h)}b++});c.children("tr").wrapAll("<table></table>");
return this}})(jQuery);
//