/**
 * Collection
 * 
 * autor: kobezzza (kobezzza@gmail.com | http://kobezzza.com)
 * version: 3.6
 * date: 04.03.2012 11:34:56
 */
 var Collection=function(){var d;d=function(a,b){a=a||null;b=b||"";if(!this||this.fn&&(!this.fn.name||this.fn.name!=="Collection"))return new d(a,b);d.extend(true,this,d.fields);var c=this.dObj.active;b&&d.extend(true,c,b);if(this._exprTest(c.filter))c.filter=this._compileFilter(c.filter);if(this._exprTest(c.parser))c.parser=this._compileParser(c.parser);c.collection=a};d.byLink=function(a,b,c,f){b=b.toString().replace(RegExp("\\s*"+d.CHILDREN+"\\s*","g"),d.CONTEXT_SEPARATOR+d.CHILDREN+d.CONTEXT_SEPARATOR).split(d.CONTEXT_SEPARATOR);
f=f||false;for(var e=d.CHILDREN,g=0,i=0,j,h=b.length,k,l;(h-=1)>-1;){b[h]=d.trim(b[h]);if(b[h]===""){b.splice(h,1);g-=1}else if(b[h]!==d.CHILDREN){if(h>g)g=h;i+=1}}l=b.length;if(a===false)return b.join("");else if(d.isNumber(a)){if((a=+a)<0)a+=i;if(typeof c==="undefined"){h=-1;for(k=0;(h+=1)<l;)if(b[h]!==d.CHILDREN)if((k+=1)===a){b.splice(h+1,l);return b.join("")}}else{h=l;for(k=0;(h-=1)>-1;)if(b[h]!==d.CHILDREN)if((k+=1)===a){b.splice(0,h);return b.join("")}}}for(h=-1;(h+=1)<l;)switch(b[h]){case d.CHILDREN:e=
b[h];break;default:if(e===d.CHILDREN&&b[h].substring(0,d.ORDER[0].length)!==d.ORDER[0])if(h===g&&typeof c!=="undefined")if(f===false)a[b[h]]=d.expr(c,a[b[h]]);else if(d.isArray(a))a.splice(b[h],1);else delete a[b[h]];else a=a[b[h]];else{i=b[h].substring(d.ORDER[0].length);i=i.substring(0,i.length-1);i=+i;if(d.isArray(a))if(h===g&&typeof c!=="undefined")if(i>=0)if(f===false)a[i]=d.expr(c,a[i]);else a.splice(i,1);else if(f===false)a[a.length+i]=d.expr(c,a[a.length+i]);else a.splice(a.length+i,1);else a=
i>=0?a[i]:a[a.length+i];else{if(i<0){k=0;for(j in a)if(a.hasOwnProperty(j))k+=1;i+=k}k=0;for(j in a)if(a.hasOwnProperty(j)){if(i===k){if(h===g&&typeof c!=="undefined")if(f===false)a[j]=d.expr(c,a[j]);else delete a[j];else a=a[j];break}k+=1}}}}if(typeof c!=="undefined")return d;return a};d.execEvent=function(a,b,c,f){a=a.split(d.QUERY_SEPARATOR);c=d.isExists(c)?c:[];c=d.isArray(c)?c:[c];for(var e=-1,g=a.length-1;(e+=1)<g;)b=b[a[e]];f=f||b;if(a[e].search(d.SUBQUERY_SEPARATOR)!==-1){a=a[e].split(d.SUBQUERY_SEPARATOR);
b=b[a[0]];a.splice(0,1);c=c.concat(a);return b.apply(f,c)}else return b[a[e]].apply(f,c)};d.CONTEXT_SEPARATOR="__context__";d.QUERY_SEPARATOR="/";d.SUBQUERY_SEPARATOR="{";d.METHOD_SEPARATOR="->";d.CHILDREN=">";d.ORDER=["eq(",")"];d.toString=function(a){if(typeof a==="undefined")return d.prototype.collection();return Object.prototype.toString.call(a)};d.isString=function(a){return d.toString(a)==="[object String]"};d.isNumber=function(a){return d.toString(a)==="[object Number]"};d.isBoolean=function(a){return d.toString(a)===
"[object Boolean]"};d.isFunction=function(a){return d.toString(a)==="[object Function]"};d.isArray=function(a){return d.toString(a)==="[object Array]"};d.isPlainObject=function(a){return d.toString(a)==="[object Object]"};d.isCollection=function(a){return d.isArray(a)||d.isPlainObject(a)};d.isExists=function(a){return typeof a!=="undefined"&&a!==null&&a!==""};d.trim=function(a){a=a.replace(/^\s\s*/,"");for(var b=/\s/,c=a.length;b.test(a.charAt(c-=1)););return a.substring(0,c+1)};d.toUpperCase=function(a,
b,c){c=c||0;b=d.isExists(b)?c+b:a.length;return a.substring(0,c)+a.substring(c,b).toUpperCase()+a.substring(b)};d.toLowerCase=function(a,b,c){c=c||0;b=d.isExists(b)?c+b:a.length;return a.substring(0,c)+a.substring(c,b).toLowerCase()+a.substring(b)};d.expr=function(a,b){b=d.isExists(b)?b:"";if(d.isString(a)&&a.search(/^[+-\\*\/]{1}=/)!==-1){a=a.split("=");isNaN(a[1])||(a[1]=+a[1]);switch(a[0]){case "+":a=b+a[1];break;case "-":a=b-a[1];break;case "*":a=b*a[1];break;case "/":a=b/a[1]}}return a};d.getRandomInt=
function(a,b){a=a||0;return Math.floor(Math.random()*((b||10)-a+1))+a};d.find=function(a,b){var c,f;if(d.isArray(b)){b.some(function(e,g){if(a===g)return f=true});if(f)return f}else for(c in b)if(b.hasOwnProperty(c))if(a===b[c])return c;return false};d.extend=function(){var a,b,c,f,e,g=arguments[0]||{},i=0,j=arguments.length,h=false;if(d.isBoolean(g)){h=g;g=arguments[1]||{};i=1}if(typeof g!=="object"&&!d.isFunction(g))g={};if(j===i){g=d;i-=1}for(;(i+=1)<j;)if(d.isExists(a=arguments[i]))for(b in a){c=
g[b];f=a[b];if(g!==f)if(h&&f&&(d.isPlainObject(f)||(e=d.isArray(f)))){if(e){e=false;c=c&&d.isArray(c)?c:[]}else c=c&&d.isPlainObject(c)?c:{};g[b]=d.extend(h,c,f)}else if(typeof f!=="undefined")g[b]=f}return g};d.addElementToObject=function(a,b,c){b=b.split(d.METHOD_SEPARATOR);var f,e={};if(b[1]&&b[1]==="unshift"){e[!isNaN(Number(b[0]))?0:b[0]]=c;for(f in a)if(a.hasOwnProperty(f))e[!isNaN(Number(f))?+f+1:f]=a[f];return e}else if(!b[1]||b[1]==="push")a[b[0]]=c;return true};d.unshiftArguments=function(a,
b){for(var c=[b],f=-1,e=a.length;(f+=1)<e;)c.push(a[f]);return c};d.prototype={name:"Collection",version:"3.6",collection:function(){return this.name+" "+this.version},ACTIVE:"active",SHUFFLE:"shuffle",NAMESPACE_SEPARATOR:".",stack:["namespace","collection","filter","context","cache","variable","defer","page","parser","appendType","target","calculator","pager","template","numberBreak","pageBreak","resultNull"],drivers:{dom:{find:function(a,b){for(var c in this.engines)if(this.engines.hasOwnProperty(c))if(this.engines[c].is())return this.engines[c].find(a||
"",b||"");throw Error("is not set exploratory framework for DOM");},engines:{qsa:{is:function(){if(typeof qsa!=="undefined")return true},find:function(a,b){return qsa.querySelectorAll(a,b)}},sizzle:{is:function(){if(typeof jQuery!=="undefined"||typeof Sizzle!=="undefined")return true},find:function(a,b){return jQuery?jQuery(a,b):Sizzle(a,b)}}}}}};d._dataAttr=function(a){a=a.attributes;var b={};a&&a.length>0&&Array.prototype.forEach.call(a,function(c){if(c.name.substring(0,5)==="data-")b[c.name.replace("data-",
"")]=d.isString(c.value)&&c.value.search(/^\{|\[/)!==-1?JSON.parse(c.value):c.value});return b};d._nodeText=function(a){a=a.childNodes;for(var b=a.length,c=-1,f="";(c+=1)<b;)if(a[c].nodeType===3&&d.trim(a[c].textContent))f+=a[c].textContent;if(f)return f;return false};d._inObj=function(a){var b=[],c=d.fromNodes.stat;Array.prototype.forEach.call(a,function(f){if(f.nodeType===1){var e=d._dataAttr(f),g=f.hasAttribute("class")?f.getAttribute("class").split(" "):"",i=d._nodeText(f),j,h=b.length;b.push({});
for(j in e)if(e.hasOwnProperty(j))b[h][j]=e[j];if(g){b[h][c.classes]={};g.forEach(function(k){b[h][c.classes][k]=k})}if(f.childNodes.length!==0)b[h][c.childNodes]=d._inObj(f.childNodes);if(i!==false)b[h][c.val]=i.replace(/[\r\t\n]/g," ")}});return b};d.fromNodes=function(a,b){if(!JSON||!JSON.parse)throw Error("object JSON is not defined!");var c=d._inObj(d.prototype.drivers.dom.find(a));if(b)return new d(c,b);return new d(c)};if(!d.fromNodes.stat)d.fromNodes.stat={val:"val",childNodes:"childNodes",
classes:"classes"};d.ctplCompile=function(a){d.isString(a)&&(a=qsa.querySelectorAll(a));if(a.length===0)throw Error("DOM element does't exist!");var b='var key = i, result = ""; ';(d.isArray(a)?a[0].innerHTML:a.innerHTML).replace(/\/\*.*?\*\//g,"").split("?>").join("<?js").replace(/[\r\t\n]/g," ").split("<?js").forEach(function(c,f){b+=f===0||f%2===0?'result +="'+c+'";':c.split("echo").join("result +=")});return new Function("el","i","data","cOLength","cObj","id",b+" return result;")};d.prototype.ctplMake=
function(a){(a=qsa.querySelectorAll(a)).forEach(function(b){var c=d._dataAttr(b).ctpl,f,e=c.prefix?c.prefix+"_":"";cObj._push("template",e+c.name,d.ctplCompile(b));c.set&&c.set===true&&cObj._set("template",e+c.name);for(f in c)if(c.hasOwnProperty(f))if(!d.find(f,["prefix","set","print","name","collection"])){if(d.find(f,["target","pager"]))c[f]=qsa.querySelectorAll(c[f]);cObj._push(f,e+c.name,c[f]);c.set&&c.set===true&&cObj._set(f,e+c.name);if(d.find(f,["filter","parser"]))c[f]=e+c.name}if(c.print&&
c.print===true){c.template=c.name;if(!c.target){cObj._push("target",e+c.name,b.parentNode);c.set&&c.set===true&&cObj._set("target",e+c.name)}cObj.print(c)}});return this};d.fields={dObj:{active:{namespace:"nm",collection:null,filter:false,context:"",cache:{autoIteration:true,iteration:true,firstIteration:false,lastIteration:false},variable:null,defer:"",page:1,parser:false,appendType:"html",target:null,calculator:null,pager:null,template:null,numberBreak:null,pageBreak:5,resultNull:""}}};d.fields.dObj.sys=
{flags:{use:{context:true,filter:true,parser:true,cache:false}}};(function(a){var b,c=d.fields.dObj.sys;a.forEach(function(f){b=d.toUpperCase(f,1);c["active"+b+"ID"]=null;c["tmp"+b]={};c[f+"ChangeControl"]=null;c[f+"Back"]=[]})})(d.prototype.stack);d.prototype._new=function(a,b){var c=this.dObj.active,f=d.toUpperCase(a,1);c[a]=d.find(a,["filter","parser"])&&this._exprTest(b)?this["_compile"+d.toUpperCase(a,1)](b):d.find(a,["target","pager"])&&d.isString(b)?this.drivers.dom.find.apply(this.drivers.dom,
d.isArray(b)?b:[b]):d.expr(b,c[a]||"");this.dObj.sys["active"+f+"ID"]=null;return this};d.prototype._update=function(a,b){var c=this.dObj.active,f=this.dObj.sys,e=this._getActiveID(a);c[a]=d.find(a,["filter","parser"])&&this._exprTest(b)?this["_compile"+d.toUpperCase(a,1)](b):d.find(a,["target","pager"])&&d.isString(b)?this.drivers.dom.find.apply(this.drivers.dom,d.isArray(b)?b:[b]):d.expr(b,c[a]||"");if(e)f["tmp"+d.toUpperCase(a,1)][e]=c[a];return this};d.prototype._get=function(a,b){if(b&&b!==this.ACTIVE){if(!this._exists(a,
b))throw Error('the object "'+b+'" -> "'+a+"\" doesn't exist in the stack!");return this.dObj.sys["tmp"+d.toUpperCase(a,1)][b]}return this.dObj.active[a]};d.prototype._push=function(a,b,c){var f=this.dObj.sys["tmp"+d.toUpperCase(a,1)],e=this._getActiveID(a),g;if(d.isPlainObject(b))for(g in b){if(b.hasOwnProperty(g))if(g===this.ACTIVE)this._update(a,b[g]);else if(f[g]&&e&&e===g)this._update(a,b[g]);else f[g]=d.find(a,["filter","parser"])&&this._exprTest(b[g])?this["_compile"+d.toUpperCase(a,1)](b[g]):
d.find(a,["target","pager"])&&d.isString(b[g])?this.drivers.dom.find.apply(this.drivers.dom,d.isArray(b[g])?b[g]:[b[g]]):b[g]}else if(b===this.ACTIVE)this._update(a,c);else if(f[b]&&e&&e===b)this._update(a,c);else f[b]=d.find(a,["filter","parser"])&&this._exprTest(c)?this["_compile"+d.toUpperCase(a,1)](c):d.find(a,["target","pager"])&&d.isString(c)?this.drivers.dom.find.apply(this.drivers.dom,d.isArray(c)?c:[c]):c;return this};d.prototype._set=function(a,b){var c=this.dObj.sys,f=d.toUpperCase(a,1),
e=a+"ChangeControl",g="active"+f+"ID";if(!this._exists(a,b))throw Error('the object "'+b+'" -> "'+a+"\" doesn't exist in the stack!");if(c[g]!==b){c[e]=true;c[g]=b}else c[e]=false;c[a+"Back"].push(b);this.dObj.active[a]=c["tmp"+f][b];return this};d.prototype._back=function(a,b){var c=this.dObj.sys,f=d.toUpperCase(a,1),e=c[a+"Back"],g=e.length-(b||1)-1;if(g>=0&&e[g])if(c["tmp"+f][e[g]]){this._set(a,e[g]);c[a+"ChangeControl"]=false;e.splice(g+1,e.length)}return this};d.prototype._backIf=function(a){if(this.dObj.sys[a+
"ChangeControl"]===true)return this._back.apply(this,arguments);return this};d.prototype._drop=function(a,b,c,f){c=typeof c==="undefined"?false:c;var e=this.dObj.active,g=this.dObj.sys,i=d.toUpperCase(a,1),j="active"+i+"ID";i="tmp"+i;var h=this._getActiveID(a);b=!b?h?[h]:[]:d.isArray(b)||d.isPlainObject(b)?b:[b];var k;if(b[0]&&b[0]!==this.ACTIVE)for(k in b){if(b.hasOwnProperty(k))if(!b[k]||b[k]===this.ACTIVE)if(typeof f==="undefined"){h&&delete g[i][h];g[j]=null;e[a]=c}else{if(h)g[i][h]=f;e[a]=f}else if(typeof f===
"undefined"){delete g[i][b[k]];if(h&&b[k]===h){g[j]=null;e[a]=c}}else{g[i][b[k]]=f;if(h&&b[k]===h)e[a]=f}}else if(typeof f==="undefined"){h&&delete g[i][h];g[j]=null;e[a]=c}else{if(h)g[i][h]=f;e[a]=f}return this};d.prototype._reset=function(a,b,c){return this._drop(a,b||"","",typeof c==="undefined"?false:c)};d.prototype._resetTo=function(a,b,c){c=!c||c===this.ACTIVE?this.dObj.active[a]:this.dObj.sys["tmp"+d.toUpperCase(a,1)][c];return this._reset(a,b||"",c)};d.prototype._exists=function(a,b){var c=
d.toUpperCase(a,1);if((!b||b===this.ACTIVE)&&this._getActiveID(a))return true;if(typeof this.dObj.sys["tmp"+c][b]!=="undefined")return true;return false};d.prototype._getActiveID=function(a){return this.dObj.sys["active"+d.toUpperCase(a,1)+"ID"]};d.prototype._active=function(a,b){if(!b)return this._getActiveID(a);if(b===this._getActiveID(a))return true;return false};d.prototype.use=function(a){this.stack.forEach(function(b){var c,f,e;if(this._exists(b,a))this._set(b,a);else{c=a.split(this.NAMESPACE_SEPARATOR);
for(e=c.length;(e-=1)>-1;){c.splice(e,1);f=c.join(this.NAMESPACE_SEPARATOR);if(this._exists(b,f)){this._set(b,f);break}}}},this);return this};(function(a){var b=d.prototype,c;a.forEach(function(f){c=d.toUpperCase(f,1);b["new"+c]=function(e){return function(g){return this._new(e,g)}}(f);b["update"+c]=function(e){return function(g){return this._update(e,g)}}(f);b["reset"+c+"To"]=function(e){return function(g,i){return this._resetTo(e,g,i)}}(f);b["push"+c]=function(e){return function(){return this._push.apply(this,
d.unshiftArguments(arguments,e))}}(f);b["set"+c]=function(e){return function(g){return this._set(e,g)}}(f);b["pushSet"+c]=function(e){return function(g,i){return this._push(e,g,i)._set(e,g)}}(f);b["back"+c]=function(e){return function(g){return this._back(e,g||"")}}(f);b["back"+c+"If"]=function(e){return function(g){return this._backIf(e,g||"")}}(f);b["drop"+c]=f==="filter"||f==="parser"?function(e){return function(){return this._drop(e,arguments)}}(f):function(e){return function(){return this._drop(e,
arguments,null)}}(f);if(f==="filter"||f==="parser")b["reset"+c]=function(e){return function(){return this._reset(e,arguments)}}(f);else if(f==="page")b["reset"+c]=function(e){return function(){return this._reset(e,arguments,1)}}(f);else if(f==="context")b["reset"+c]=function(e){return function(){return this._reset(e,arguments,"")}}(f);b["active"+c]=function(e){return function(g){return this._active(e,g)}}(f);b["exists"+c]=function(e){return function(g){return this._exists(e,g||"")}}(f);b["get"+c+
"ActiveID"]=function(e){return function(){return this._getActiveID(e)}}(f);b["get"+c]=function(e){return function(g){return this._get(e,g||"")}}(f)})})(d.prototype.stack);d.prototype._setOne=function(a,b,c){a=d.isExists(a)?a.toString():"";b=typeof b==="undefined"?"":b;c=c||"";var f=this._getActiveParam("context"),e;this.onSet&&(e=this.onSet.apply(this,arguments));if(e===false)return this;if(!a&&!f)return c&&c!==this.ACTIVE?this._push("collection",c,b):this._update("collection",b);d.byLink(this._get("collection",
c),f+d.CHILDREN+a,b);return this};d.prototype._getOne=function(a,b){a=d.isExists(a)?a.toString():"";return d.byLink(this._get("collection",b||""),this._getActiveParam("context")+d.CHILDREN+a)};d.prototype.add=function(a,b,c,f,e){a=typeof a!=="undefined"?a:"";b=b||"push";c=c||"";e=e||false;var g,i,j;this.onAdd&&(g=this.onAdd.apply(this,arguments));if(g===false)return this;g=d.byLink(this._get("collection",c),this._getActiveParam("context"));if(typeof g!=="object")throw Error("unable to set property!");
if(f){a=d.isExists(a)?a.toString():"";i=d.byLink(this._get("collection",f||""),a);if(d.isPlainObject(g)){b=b==="push"?this.length(g):b==="unshift"?this.length(g)+d.METHOD_SEPARATOR+"unshift":b;j=d.addElementToObject(g,b.toString(),i)}else{j=true;g[b](i)}e===true&&this.disable("context")._removeOne(a,f).enable("context")}else if(d.isPlainObject(g)){b=b==="push"?this.length(g):b==="unshift"?this.length(g)+d.METHOD_SEPARATOR+"unshift":b;j=d.addElementToObject(g,b.toString(),a)}else{j=true;g[b](a)}j!==
true&&this._setOne("",j,c);return this};d.prototype.push=function(a,b){return this.add(a,"",b||"")};d.prototype.unshift=function(a,b){return this.add(a,"unshift",b||"")};d.prototype._removeOne=function(a,b){a=d.isExists(a)?a.toString():"";var c=this._getActiveParam("context"),f;this.onRemove&&(f=this.onRemove.apply(this,arguments));if(f===false)return this;!a&&!c?this._setOne("",null):d.byLink(this._get("collection",b||""),c+d.CHILDREN+a,"",true);return this};d.prototype._remove=function(a,b){b=b||
"";var c,f;if(d.isPlainObject(a))for(c in a){if(a.hasOwnProperty(c))if(d.isArray(a[c]))for(f=a[c].length;(f-=1)>-1;)this._removeOne(a[c][f],c);else this._removeOne(a[c],c)}else if(d.isArray(a))for(f=a.length;(f-=1)>-1;)this._removeOne(a[f],b);else this._removeOne(a,b);return this};d.prototype.pop=function(a){return this._removeOne("eq(-1)",a||"")};d.prototype.shift=function(a){return this._removeOne("eq(0)",a||"")};d.prototype.concat=function(a,b,c){b=d.isExists(b)?b.toString():"";c=c||"";var f;this.onConcat&&
(f=this.onConcat.apply(this,arguments));if(f===false)return this;f=d.byLink(this._get("collection",c),this._getActiveParam("context")+d.CHILDREN+b);if(typeof f!=="object")throw Error("incorrect data type!");if(d.isPlainObject(f))d.extend(true,f,a);else if(d.isArray(f))if(d.isArray(a)){f=Array.prototype.concat(f,a);this._setOne(b,f,c)}else this.add(a,"push",c);return this};d.prototype.length=function(a,b){a=a||"";var c={},f,e,g,i;if(!d.isFunction(a))if(d.isString(a)&&!this._filterTest(a)&&!d.isExists(b)||
d.isCollection(a)){b=a;a=false}if(b)if(d.isString(b))f=this._get("collection",b);else{e=true;f=b}else f=this._get("collection");if(f===null)return 0;if(e!==true)f=d.byLink(f,this._getActiveParam("context"));if(d.isString(f))return f.length;if(typeof f!=="object")throw Error("incorrect data type!");if(a===false&&typeof f.length!=="undefined")i=f.length;else{i=0;if(typeof f.length!=="undefined")f.forEach(function(j,h){if(this._customFilter(a,j,h,f,i||null,this,b?b:this.ACTIVE,c)===true)i+=1},this);
else for(g in f)if(f.hasOwnProperty(g))if(this._customFilter(a,f[g],g,f,i||null,this,b?b:this.ACTIVE,c)===true)i+=1}c.name&&this._drop("filter","__tmp:"+c.name);return i};d.prototype.forEach=function(a,b,c,f,e,g,i){b=b||"";if(d.isBoolean(c)){i=g;g=e;e=f;f=c;c=this.ACTIVE}else c=c||"";f=f===false?false:true;e=parseInt(e)>=0?parseInt(e):false;g=parseInt(g)||false;i=parseInt(i)||false;var j=this,h={},k,l,n,o=0,m=false;k=d.byLink(this._get("collection",c),this._getActiveParam("context"));if(typeof k!==
"object")throw Error("incorrect data type!");l=function(){if(!l.val)l.val=j.length(b,c);return l.val};if(d.isArray(k)){n=i!==false?k.slice(i):k;n.some(function(p,q){q+=i;if(e!==false&&o===e)return true;if(this._customFilter(b,p,q,k,l,this,c,h)===true)if(g!==false&&g!==0)g-=1;else{m=a.call(a,p,q,k,l,this,c)===false;if(f===false)m=true;o+=1}if(m===true)return true},this)}else for(n in k)if(k.hasOwnProperty(n)){if(e!==false&&o===e)break;if(i!==false&&i!==0)i-=1;else{if(this._customFilter(b,k[n],n,k,
l,this,c,h)===true)if(g!==false&&g!==0)g-=1;else{m=a.call(a,k[n],n,k,l,this,c)===false;if(f===false)m=true;o+=1}if(m===true)break}}h.name&&this._drop("filter","__tmp:"+h.name);l=null;return this};d.prototype.some=function(a,b,c){return this.forEach(a,b||"",c||"",false)};d.prototype.search=function(a,b,c,f,e,g){if(d.isBoolean(b)){g=e;e=f;f=c;c=b;b=this.ACTIVE}else b=b||"";c=c===false?false:true;f=parseInt(f)>=0?parseInt(f):false;e=parseInt(e)||false;g=parseInt(g)||false;var i=c===true?[]:-1;this.forEach(function(j,
h){if(c===true)i.push(h);else i=h;return true},a||"",b,c,f,e,g);return i};d.prototype.searchOne=function(a,b){return this.search(a||"",b||"",false)};d.prototype.indexOf=function(a,b,c){c=c||"";b=b||"";var f=d.byLink(this._get("collection",c),this._getActiveParam("context"));if(d.isArray(f)&&f.indexOf){if(b)return f.indexOf(a,b);return f.indexOf(a)}else return this.search(function(e){return e===a},c,false,"","",b)};d.prototype.lastIndexOf=function(a,b,c){c=c||"";b=b||"";var f=d.byLink(this._get("collection",
c),this._getActiveParam("context"));if(d.isArray(f)&&f.lastIndexOf){if(b)return f.lastIndexOf(a,b);return f.lastIndexOf(a)}else{b=this.search(function(e){return e===a},c,"","","",b);return typeof b[b.length-1]!=="undefined"?b[b.length-1]:-1}};d.prototype.get=function(a,b,c,f,e,g){if(d.isNumber(a)||arguments.length<2&&d.isString(a)&&!this._filterTest(a)||arguments.length===0||arguments.length<2&&a===false)return this._getOne(a,b||"");if(d.isBoolean(b)){g=e;e=f;f=c;c=b;b=this.ACTIVE}else b=b||"";c=
c===false?false:true;f=parseInt(f)>=0?parseInt(f):false;e=parseInt(e)||false;g=parseInt(g)||false;var i=c===true?[]:-1;this.forEach(function(j,h,k){if(c===true)i.push(k[h]);else i=k[h];return true},a||"",b,c,f,e,g);return i};d.prototype.getOne=function(a,b){return this.get(a||"",b||"",false)};d.prototype.set=function(a,b,c){if(d.isNumber(a)||arguments.length<3&&d.isString(a)&&!this._filterTest(a)||arguments.length===0||arguments.length<3&&a===false)return this._setOne(a,b,c||"");var f,e,g=d.isFunction(b);
e=d.unshiftArguments(arguments,function(i,j,h,k,l,n){h[j]=g?b.call(b,i,j,h,k,l,n):d.expr(b,h[j]);return true});e.splice(2,1);this.onSet&&(f=this.onSet.apply(this,arguments));if(f===false)return this;return this.forEach.apply(this,e)};d.prototype.setOne=function(a,b,c){return this.set(a||"",b,c||"",false)};d.prototype.map=function(a,b,c){return this.set(b||"",a,c||"")};d.prototype.move=function(a,b,c,f,e,g,i,j,h,k){a=a||"";k=k===false?false:true;b=d.isExists(b)?b.toString():"";c=c||"";f=f||"";e=e||
"push";g=g===false?false:true;i=parseInt(i)>=0?parseInt(i):false;j=parseInt(j)||false;h=parseInt(h)||false;var l=[],n=d.isArray(d.byLink(this._get("collection",f),this._getActiveParam("context"))),o;o=null;k&&this.onMove&&(o=this.onMove.apply(this,arguments));!k&&this.onCopy&&(o=this.onCopy.apply(this,arguments));if(o===false)return this;this.disable("context");o=d.isNumber(a)||d.isString(a)&&!this._filterTest(a)?a:this.search(a,c,g,i,j,h);this.enable("context");if(g===true&&d.isArray(o))o.forEach(function(m){this.add(b+
d.CHILDREN+m,n===true?e:m+d.METHOD_SEPARATOR+e,f,c);k===true&&l.push(m)},this);else{this.add(b+d.CHILDREN+o,n===true?e:o+d.METHOD_SEPARATOR+e,f,c);k===true&&l.push(o)}k===true&&this.disable("context")._remove(l,c).enable("context");return this};d.prototype.moveOne=function(a,b,c,f,e){return this.move(a||"",d.isExists(b)?b.toString():"",c||"",f||"",e||"",false)};d.prototype.copy=function(a,b,c,f,e,g,i,j,h){g=g===false?false:true;i=parseInt(i)>=0?parseInt(i):false;j=parseInt(j)||false;h=parseInt(h)||
false;return this.move(a||"",d.isExists(b)?b.toString():"",c||"",f||"",e||"push",g,i,j,h,false)};d.prototype.copyOne=function(a,b,c,f,e){return this.move(a||"",d.isExists(b)?b.toString():"",c||"",f||"",e||"",false,"","","",false)};d.prototype.remove=function(a,b){if(d.isNumber(a)||arguments.length<2&&d.isString(a)&&!this._filterTest(a)||arguments.length===0||arguments.length<2&&a===false)return this._removeOne(a,b||"");else if(d.isArray(a)||d.isPlainObject(a))return this._remove(a,b||"");var c=this.search.apply(this,
arguments),f=c.length;if(d.isArray(c))for(;(f-=1)>-1;)this._removeOne(c[f],b);else this._removeOne(c,b);return this};d.prototype.removeOne=function(a,b){return this.remove(a||"",b||"",false)};d.prototype.group=function(a,b,c,f,e,g,i){a=this._exprTest(a=a||"")?this._compileFilter(a):a;c=c||"";i=i||false;f=parseInt(f)>=0?parseInt(f):false;e=parseInt(e)||false;g=parseInt(g)||false;var j=d.isString(a),h={};this.forEach(function(k,l){var n=j?d.byLink(k,a):a.apply(a,arguments);if(h[n])h[n].push(!i?k:l);
else h[n]=[!i?k:l];return true},b,c,"",f,e,g);return h};d.prototype.groupLinks=function(a,b,c,f,e,g){return this.group(a||"",b||"",c||"",f||"",e||"",g||"",true)};d.prototype.stat=function(a,b,c,f,e,g,i){a=a||"count";f=f||"";e=parseInt(e)>=0?parseInt(e):false;g=parseInt(g)||false;i=parseInt(i)||false;var j=d.isString(a),h=0,k=0,l=function(n){n=d.byLink(n,b||"");switch(a){case "count":h+=1;break;case "summ":h+=n;break;case "avg":k+=1;h+=n;break;case "max":if(n>h)h=n;break;case "min":if(k===0){h=n;k=
1}else if(n<h)h=n;break;default:if(j)if(k===0){h=n;k=1}else h=d.expr(a+"="+n,h);else h=a(n,h)}return true};if(a!=="first"&&a!=="last"){this.forEach(l,c||"",f,"",e,g,i);if(a==="avg")h/=k}else h=a==="first"?this._getOne(d.ORDER[0]+"0"+d.ORDER[1]):this._getOne(d.ORDER[0]+"-1"+d.ORDER[1]);return h};d.prototype.groupStat=function(a,b,c,f,e,g,i){a=a||"count";f=f||"";e=parseInt(e)>=0?parseInt(e):false;g=parseInt(g)||false;i=parseInt(i)||false;var j=d.isString(a),h={},k={},l,n=function(o){o=d.byLink(o,b||
"");switch(a){case "count":h[this.i]+=1;break;case "summ":h[this.i]+=o;break;case "avg":k[this.i]+=1;h[this.i]+=o;break;case "max":if(o>h[this.i])h[this.i]=o;break;case "min":if(k[this.i]===0){h[this.i]=o;k[this.i]=1}else if(o<h[this.i])h[this.i]=o;break;default:if(j)if(k[this.i]===0){h[this.i]=o;k[this.i]=1}else h[this.i]=d.expr(a+"="+o,h[this.i]);else h[this.i]=a(o,h[this.i])}return true};this.forEach(function(o,m,p,q,r,s){h[m]||(h[m]=k[m]=0);if(a!=="first"&&a!=="last")r._update("context","+="+
d.CHILDREN+(n.i=m)).forEach(n,c||"",s,"",e,g,i).parent();else h[m]=a==="first"?d.byLink(o,d.ORDER[0]+"0"+d.ORDER[1]):d.byLink(o,d.ORDER[0]+"-1"+d.ORDER[1]);return true},"",f);if(a==="avg")for(l in h)if(h.hasOwnProperty(l))h[l]/=k[l];return h};d._sortObject=function(a,b,c){b=[];var f={},e;for(e in a)a.hasOwnProperty(e)&&b.push({key:e,value:a[e]});b.sort(c);for(e in b)if(b.hasOwnProperty(e))f[b[e].key]=b[e].value;return f};d._sortObjectByKey=function(a,b){var c=[],f={},e;for(e in a)a.hasOwnProperty(e)&&
c.push(e);c.sort(b);for(e in c)if(c.hasOwnProperty(e))f[c[e]]=a[c[e]];return f};d.prototype.sort=function(a,b,c,f){a=a||"";b=b||false;c=c&&c!==true?c===false?"":c:function(j){if(d.isString(j))return j.toUpperCase();return j};f=f||"";var e=this,g,i=function(j,h){var k=b?-1:1;if(a){j=d.byLink(j,a);h=d.byLink(h,a)}if(c){j=c(j);h=c(h)}if(b!==e.SHUFFLE){if(j<h)return k*-1;if(j>h)return k;return 0}else return Math.round(Math.random()*2-1)};this.onSort&&(g=this.onSort.apply(this,arguments));if(g===false)return this;
g=d.byLink(this._get("collection",f),this._getActiveParam("context"));if(typeof g!=="object")throw Error("incorrect data type!");if(d.isArray(g))g.sort(i);else{if(a){a=a===true?"value":"value"+d.CHILDREN+a;g=d._sortObject(g,a,i)}else g=d._sortObjectByKey(g,i);this._setOne("",g,f)}return this};d._reverseObject=function(a){var b=[],c={},f;for(f in a)a.hasOwnProperty(f)&&b.push(f);b.reverse();for(f in b)if(b.hasOwnProperty(f))c[b[f]]=a[b[f]];return c};d.prototype.reverse=function(a){a=a||"";var b;this.onReverse&&
(b=this.onReverse.apply(this,arguments));if(b===false)return this;b=d.byLink(this._get("collection",a),this._getActiveParam("context"));if(typeof b!=="object")throw Error("incorrect data type!");d.isArray(b)?b.reverse():this._setOne("",d._reverseObject(b),a);return this};d.prototype.save=function(a,b){if(!localStorage)throw Error("your browser doesn't support web storage!");a=a||this.ACTIVE;var c="__"+this.name+"__"+this._get("namespace"),f=a===this.ACTIVE?this._exists("collection")?this._getActiveID("collection"):
"":this._active("collection",a)?"active":"",e=b===false?sessionStorage:localStorage,g=null;this.onSave&&(g=this.onSave.apply(this,arguments));if(g===false)return this;e.setItem(c+":"+a,this.toString(a));e.setItem(c+"__date:"+a,(new Date).toString());e.setItem(c+"__active:"+a,f);e.setItem(c+"__date",(new Date).toString());return this};d.prototype.saveAll=function(a){if(!localStorage)throw Error("your browser doesn't support web storage!");a=a===false?a:true;var b,c=this.dObj.sys.tmpCollection,f=false;
for(b in c){this._active("C",b)&&(f=true);c.hasOwnProperty(b)&&this.save(b,a)}f===false&&this.save("",a);return this};d.prototype.load=function(a,b){if(!localStorage)throw Error("your browser doesn't support web storage!");a=a||this.ACTIVE;var c="__"+this.name+"__"+this._get("namespace"),f=b===false?sessionStorage:localStorage,e=null;this.onLoad&&(e=this.onLoad.apply(this,arguments));if(e===false)return this;a===this.ACTIVE?this._new("collection",JSON.parse(f.getItem(c+":"+a))):this._push("collection",
a,JSON.parse(f.getItem(c+":"+a)));c=f.getItem(c+"__active:"+a);if(c===this.ACTIVE)this._set("collection",a);else c&&this._push("collection",c,this._get("collection"))._set("collection",c);return this};d.prototype.loadAll=function(a,b){b=b?"drop":"load";if(!localStorage)throw Error("your browser doesn't support web storage!");a=a===false?a:true;var c="__"+this.name+"__"+this._get("namespace"),f=a===false?sessionStorage:localStorage,e=f.length,g,i;try{for(g in f)if(f.hasOwnProperty(g))if((i=g.split(":"))[0]===
c)this[b](i[1],a)}catch(j){for(;(e-=1)>-1;)if((i=f[e].split(":"))[0]===c)this[b](i[1],a)}return this};d.prototype.loadDate=function(a,b){if(!localStorage)throw Error("your browser doesn't support web storage!");return new Date((b===false?sessionStorage:localStorage).getItem("__"+this.name+"__"+this._get("namespace")+"__date"+(a?":"+a:"")))};d.prototype.isExpired=function(a,b,c){if(!localStorage)throw Error("your browser doesn't support web storage!");return new Date(new Date-new Date(this.loadDate(b||
"",c||"")))>a};d.prototype.drop=function(a,b){if(!localStorage)throw Error("your browser doesn't support web storage!");a=a||this.ACTIVE;var c="__"+this.name+"__"+this._get("namespace"),f=b===false?sessionStorage:localStorage,e=null;this.onDrop&&(e=this.onDrop.apply(this,arguments));if(e===false)return this;f.removeItem(c+":"+a);f.removeItem(c+"__date:"+a);f.removeItem(c+"__active:"+a);return this};d.prototype.dropAll=function(a){(a===false?sessionStorage:localStorage).removeItem("__"+this.name+"__"+
this._get("namespace")+"__date");return this.loadAll(a||"",true)};d.prototype._customFilter=function(a,b,c,f,e,g,i,j){var h,k=true,l,n,o,m;if(!a||a===true){if(!this._getActiveParam("filter"))return true;if(this._get("filter"))return this._customFilter(this._get("filter"),b,c,f,e,g,i,j);return true}if(d.isFunction(a))if(!this._getActiveParam("filter")||!j)return a.call(a,b,c,f,e,g,i);else{if(!j.name){for(;this._exists("filter","__tmp:"+(j.name=d.getRandomInt(0,1E4)));)j.name=d.getRandomInt(0,1E4);
this._push("filter","__tmp:"+j.name,a)}return this._customFilter(this.ACTIVE+" && __tmp:"+j.name,b,c,f,e,g,i,j)}if(!d.isArray(a)){if(this._getActiveParam("filter")&&j)a=this.ACTIVE+" && ("+a+")";if(a.search(/\|\||&&|!/)===-1){if((a=d.trim(a)).search(/^(?:\(|)*:/)!==-1){this._exists("filter","__tmp:"+a)||this._push("filter","__tmp:"+a,this._compileFilter(a));return(a=this._get("filter","__tmp:"+a)).call(a,b,c,f,e,g,i)}return this._customFilter(this._get("filter",a),b,c,f,e,g,i,j)}a=d.trim(a.toString().replace(/\s*(\(|\))\s*/g,
" $1 ").replace(/\s*(\|\||&&)\s*/g," $1 ").replace(/(!)\s*/g,"$1")).split(" ");for(c=a.length;(c-=1)>-1;)a[c]===""&&a.splice(c,1)}h=function(p,q){for(var r=-1,s=p.length,t=0,u=[];(r+=1)<s;){q+=1;if(p[r]==="("||p[r]==="!(")t+=1;if(p[r]===")")if(t===0)return{result:u,iter:q};else t-=1;u.push(p[r])}};j=a.length;for(c=-1;(c+=1)<j;)if(a[c]==="("||a[c]==="!("){if(a[c].substring(0,1)==="!"){m=true;a[c]=a[c].substring(1)}else m=false;c=(l=h(a.slice(c+1),c)).iter;l=l.result.join(" ");l=this._customFilter(l,
b,c,f,e,g,i);k=!n&&!o?m===true?!l:l:n?m===true?!l:l&&k:m===true?!l:l||k}else if(a[c]!==")"&&a[c]!=="||"&&a[c]!=="&&"){if(a[c].substring(0,1)==="!"){m=true;a[c]=a[c].substring(1)}else m=false;l=this._customFilter(this._get("filter",a[c]),b,c,f,e,g,i);k=!n&&!o?m===true?!l:l:n?m===true?!l:l&&k:m===true?!l:l||k}else if(a[c]==="||"){n=false;o=true}else if(a[c]==="&&"){o=false;n=true}return k};d.prototype._compileFilter=function(a){var b=/^\s*\(*\s*/.exec(a);if(b.length!==0)a=a.substring(b[0].length+1,
a.length-b[0].length);a=a.split("<:").join('self.getVariable("').split(":>").join('")');return new Function("el","i","data","cOLength","cObj","id","var key = i; return "+a.replace(/^\s*:/,"")+";")};d.prototype._customParser=function(a,b,c){if(!a||a===true){if(!this._getActiveParam("parser"))return b;if(this._get("parser"))return this._customParser(this._get("parser"),b,c);return b}if(d.isFunction(a))if(!this._getActiveParam("parser")||!c)return a.call(a,b,this);else{if(!c.name){for(;this._exists("parser",
"__tmp:"+(c.name=d.getRandomInt(0,1E4)));)c.name=d.getRandomInt(0,1E4);this._push("parser","__tmp:"+c.name,a)}return this._customParser(this.ACTIVE+" && __tmp:"+c.name,b,c)}if(d.isString(a)){if(this._getActiveParam("parser")&&c)a=this.ACTIVE+" && "+a;if((a=d.trim(a)).search("&&")===-1){if(a.search(/^(?:\(|)*:/)!==-1){this._exists("parser","__tmp:"+a)||this._push("parser","__tmp:"+a,this._compileParser(a));return(a=this._get("parser","__tmp:"+a)).call(a,b,this)}return this._customParser(this._get("parser",
a),b)}a=a.split("&&")}a.forEach(function(f){b=this._customParser(d.trim(f),b)},this);return b};d.prototype._compileParser=function(a){var b=/^\s*\(*\s*/.exec(a);if(b.length!==0)a=a.substring(b[0].length+1,a.length-b[0].length);a=a.split("<:").join('self.getVariable("').split(":>").join('")');return new Function("str","cObj","return "+a.replace(/^\s*:/,"")+";")};d.prototype.parentContext=function(a,b){for(var c=this._get("context",b||"").split(d.CHILDREN),f=a||1;(f-=1)>-1;)c.splice(-1,1);return c.join(d.CHILDREN)};
d.prototype.parent=function(a,b){if(!b)return this._update("context",this.parentContext(a));return this._push("context",b,this.parentContext(a,b))};d.prototype._getActiveParam=function(a){var b=typeof this.dObj.sys.flags.use[a]==="undefined"||this.dObj.sys.flags.use[a]===true?this.dObj.active[a]:false;if(a==="context")return b?b.toString():"";return b};d.prototype._filterTest=function(a){return a===this.ACTIVE||this._exists("filter",a)||a.search(/&&|\|\||:/)!==-1};d.prototype._exprTest=function(a){return d.isString(a)&&
a.search(/^:/)!==-1};d.prototype.enable=function(){for(var a in arguments)if(arguments.hasOwnProperty(a))this.dObj.sys.flags.use[arguments[a]]=true;return this};d.prototype.disable=function(){for(var a in arguments)if(arguments.hasOwnProperty(a))this.dObj.sys.flags.use[arguments[a]]=false;return this};d.prototype.toggle=function(){for(var a in arguments)if(arguments.hasOwnProperty(a)){if(this.dObj.sys.flags.use[arguments[a]]===true)return this.disable(arguments[a]);return this.enable(arguments[a])}};
d.prototype.toString=function(a,b,c){if(!JSON||!JSON.stringify)throw Error("object JSON is not defined!");b=b||"";c=c||"";if(a&&d.isCollection(a))return JSON.stringify(a,b,c);return JSON.stringify(d.byLink(this._get("collection",a||""),this._getActiveParam("context")),b,c)};d.prototype.valueOf=function(){return this.length(this.ACTIVE)};d.prototype.then=function(a,b){var c=this;arguments.length===1?$.when(this.active("defer")).always(function(){a.apply(c,arguments)}):$.when(this.active("defer")).then(function(){a().apply(c,
arguments)},function(){b().apply(c,arguments)});return this};d.prototype.print=function(a,b){b=b||false;var c={},f={},e={},g,i,j,h=0,k,l=null,n=false,o,m="",p,q=null;if(d.isExists(a)&&(d.isString(a)||d.isNumber(a)))a={page:a};else d.isExists(a)||(a={page:this._get("page")});d.extend(true,e,this.dObj.active,a);if(a)e.page=d.expr(e.page,this._get("page"));if(e.page<1)e.page=1;e.collection=d.isString(e.collection)?this._get("collection",e.collection):e.collection;e.template=d.isString(e.template)?this._get("template",
e.template):e.template;e.cache=d.isExists(a.cache)?a.cache:this._getActiveParam("cache");if(b===true)e.cache.iteration=false;k=this._get("page")-e.page;this._update("page",e.page);p=function(r,s){e.callback&&e.callback.apply(e.callback,arguments);m+=e.template.apply(e.template,arguments);h=s;if(n===false)n=s;return true};g=d.byLink(e.collection,this._getActiveParam("context")+d.CHILDREN+(a&&a.context||""));i=this.length();o=Boolean(e.numberBreak&&(e.filter||this._getActiveParam("filter")));e.numberBreak=
e.numberBreak||i;if(d.isPlainObject(g)||!e.cache||e.cache.iteration===false||e.cache.firstIteration===false||e.cache.lastIteration===false){j=!e.numberBreak||e.page===1?0:(e.page-1)*e.numberBreak;this.forEach(p,e.filter,this.ACTIVE,true,e.numberBreak,j);if(e.cache&&e.cache.iteration===false)e.cache.lastIteration=false}else if(d.isArray(g)&&e.cache.iteration===true){j=!o?e.page===1?0:(e.page-1)*e.numberBreak:k>=0?e.cache.firstIteration:e.cache.lastIteration;if(o)if(k>0){for(k*=e.numberBreak;(j-=1)>
-1;)if(this._customFilter(e.filter,g[j],g,j,i,this,this.ACTIVE,f)===true)if(h===k)break;else h+=1;e.cache.lastIteration=j+=1;l=null}else if(k<0)l=-k*e.numberBreak-e.numberBreak;f.name&&this._drop("filter","__tmp:"+f.name);this.forEach(p,e.filter,this.ACTIVE,true,e.numberBreak,l,j)}if(e.cache){if(k!==0&&e.cache.iteration!==false){this._get("cache").firstIteration=n;this._get("cache").lastIteration=h+1}if(e.cache.autoIteration===true)this._get("cache").iteration=true}m=!m?e.resultNull:this._customParser(e.parser,
m,c);c.name&&this._drop("parser","__tmp:"+c.name);if(e.target===false){e.variable?this._push("variable",e.variable,m):this._new("variable",m);return this}else e.target[e.appendType](m);if(!e.pager)return this;e.nmbOfEntries=e.filter!==false?this.length(e.filter):i;e.nmbOfEntriesInPage=e.calculator?e.target.find(e.calculator).length:e.target.children().length;e.finNumber=e.numberBreak*e.page-(e.numberBreak-e.nmbOfEntriesInPage);if(e.page!==1&&e.nmbOfEntriesInPage===0){this.onIPage&&(q=this.onIPage.apply(this,
arguments));if(q===false)return this;this._update("page",e.page-=1).print(e,true,true)}else this.easyPage(e);return this};d.prototype.easyPage=function(a){var b=this,c="",f=a.nmbOfPages||(a.nmbOfEntries%a.numberBreak!==0?~~(a.nmbOfEntries/a.numberBreak)+1:a.nmbOfEntries/a.numberBreak),e=function(l,n,o,m){m=m||false;var p,q="<"+(l.tag||"span")+" "+(!m?'data-page="':'data-number-break="')+o+'"';if(l.attr)for(p in l.attr)if(l.attr.hasOwnProperty(p))q+=" "+p+'="'+l.attr[p]+'"';if(!m&&o===a.page||m&&o===
a.numberBreak)q+=' class="'+(n&&n.active||"active")+'"';return q+(">"+o+"</"+(l.tag||"span")+">")},g=function(l,n){if(n==="select")return'<option value="'+l+'">'+l+"</option>";return l},i,j=0,h,k;a.pager.find(".ctm").each(function(){if(a.pageBreak<=2)throw Error('parameter "pageBreak" must be more than 2');c="";var l=$(this),n=this.tagName.toLowerCase(),o=n==="input"?"val":"html",m=l.data("ctm"),p=m.classes;if(m.nav){d.find(m.nav,["first","prev","next","last"])&&!l.data("ctm-delegated")&&l.click(function(){if(!$(this).hasClass(m.classes&&
m.classes.disabled||"disabled")){m.nav==="first"&&(a.page=1);m.nav==="prev"&&(a.page="-=1");m.nav==="next"&&(a.page="+=1");m.nav==="last"&&(a.page=f);b.print(a)}}).data("ctm-delegated",true);if(d.find(m.nav,["first","prev"])&&a.page===1||d.find(m.nav,["next","last"])&&a.finNumber===a.nmbOfEntries)l.addClass(p&&p.disabled||"disabled");else if(d.find(m.nav,["first","prev","next","last"]))l.removeClass(p&&p.disabled||"disabled");m.nav==="numberSwitch"&&m.val.forEach(function(q){c+=n==="select"?'<option vale="'+
q+'" '+(q===a.numberBreak?'selected="selected"':"")+">"+q+"</option>":e(m,p||"",q,true)});if(m.nav==="pageList")if(n==="select")for(i=0;(i+=1)<=f;)c+='<option vale="'+i+'" '+(i===a.page?'selected="selected"':"")+">"+i+"</option>";else if(f>a.pageBreak){j=a.pageBreak%2!==0?1:0;k=h=(a.pageBreak-j)/2;if(a.page-j<h)h=0;else{h=a.page-h-j;if(a.page+k>f)h-=a.page+k-f}i=h;for(j=-1;(i+=1)<=f&&(j+=1)!==null;){if(j===a.pageBreak&&i!==a.page)break;c+=e(m,p||"",i)}}else for(i=0;(i+=1)<=f;)c+=e(m,p||"",i);if(m.nav===
"numberSwitch"||m.nav==="pageList"){l.html(c);if(!l.data("ctm-delegated")){if(n!=="select")l.on("click",m.tag||"span",function(){var q=$(this);if(a.page!==q.data("page")){if(m.nav==="pageList")a.page=+q.data("page");else{b._push("numberBreak",a.name||"",+q.data("number-break"));delete a.numberBreak}b.print(a)}});else l.on("change",function(){var q=$(this).children(":selected");if(a.page!==q.val()){if(m.nav==="pageList")a.page=+q.val();else{b._push("numberBreak",a.name||"",+q.val());delete a.numberBreak}b.print(a)}});
l.data("ctm-delegated",true)}}}else if(m.info){a.nmbOfEntriesInPage===0?l.addClass(p&&p.noData||"no-data"):l.removeClass(p&&p.noData||"no-data");switch(m.info){case "page":l[o](g(a.page,n));break;case "total":l[o](g(a.nmbOfEntries,n));break;case "from":l[o](g((a.page-1)*a.numberBreak+1,n));break;case "to":l[o](g(a.finNumber,n));break;case "inPage":l[o](g(a.nmbOfEntriesInPage,n));break;case "nmbOfPages":l[o](g(f,n))}}});return this};d.prototype.genTable=function(a,b,c,f){if(d.isNumber(a)){f=c;c=b;
b=a;a=""}b=b||4;c=c||"div";f=f===false?false:true;a=a||this._get("target");c=qsa.querySelectorAll(c,a);var e=0,g=document.createElement("table"),i,j;c.forEach(function(h){if(e===0){i=document.createElement("tr");g.appendChild(i)}j=document.createElement("td");j.appendChild(h);i.appendChild(j);e+=1;if(e===b)e=0});if(f===true)for(e=b-i.childNodes.length;(e-=1)>-1;)i.appendChild(document.createElement("td"));a[0]&&a.length?Array.prototype.forEach.call(a,function(h){h.appendChild(g)}):a.appendChild(g);
return this};return d}();if(typeof $C==="undefined")var $C=Collection;
//